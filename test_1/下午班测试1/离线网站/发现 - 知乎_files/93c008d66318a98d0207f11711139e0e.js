(function(a){with(a){
a.Ps=function(b,c){this.ba=b;this.offset=c},a.Qs=function(b){return b.length||b.childNodes.length},a.Rs=function(b,c,d){for(;1==b.nodeType;){var e=b.childNodes[c];if(!e&&!b.lastChild)break;e?(b=e.previousSibling,d&&b?c=Qs(b):(b=e,c=0)):(b=b.lastChild,c=Qs(b))}return new Ps(b,c)},a.Ss=function(b,c){b!=k&&this.append.apply(this,arguments)};t=Ss.prototype;t.kh="";t.set=function(b){this.kh=""+b};t.append=function(b,c,d){this.kh+=b;if(c!=k)for(var e=1;e<arguments.length;e++)this.kh+=arguments[e];return this};
t.clear=function(){this.kh=""};t.ir=u(47);t.toString=p("kh");a.Ts=function(b){this.type="anon_change";this.ib=b};y(Ts,gd);a.Us=function(b){if("outerHTML"in b)return b.outerHTML;var c=Rb(b).createElement("div");c.appendChild(b.cloneNode(j));return c.innerHTML},a.Z=function(b,c){return da[b]=c};Pf.prototype.expand=Z(59,function(b,c,d,e){ra(b)?(this.top-=b.top,this.right+=b.right,this.bottom+=b.bottom,this.left-=b.left):(this.top-=b,this.right+=c,this.bottom+=d,this.left-=e);return this});
Bp.prototype.expand=Z(58,function(){this.Ja(j)});Rh.prototype.Io=Z(57,function(b){Sh(this);this.Bk=b});yi.prototype.Io=Z(56,function(b){this.Bk=b;this.ya&&zi(this)});ip.prototype.fm=Z(52,function(b){this.Ea(b)});Xd.prototype.ei=Z(51,ca("wF"));Rh.prototype.xx=Z(50,function(){return this.tj||150>za()-this.Fx});$p.prototype.Bb=Z(49,function(){var b=this.qc();return 1==b.nodeType?b:b.parentNode});Gr.prototype.Ce=Z(48,function(b){this.Y.nt(b)});Ss.prototype.ir=Z(47,function(){return this.kh.length});
Cn.prototype.fireEvent=Z(36,function(b){this.dispatchEvent(b)});co.prototype.Gc=Z(31,function(){return Fc(this.m())});lq.prototype.Gc=Z(30,function(){return this.P.toString()});qq.prototype.Gc=Z(29,function(){return this.P.text});Aq.prototype.Gc=Z(28,function(){return Eq(this).Gc()});Gq.prototype.Gc=Z(27,s(""));Mq.prototype.Gc=Z(26,function(){return z.map(bq(this),function(b){return b.Gc()}).join("")});
Qb.prototype.iv=Z(21,function(b,c,d){for(var e=this.Ga,g=!!d,d=["<tr>"],h=0;h<c;h++)d.push(g?"<td>&nbsp;</td>":"<td></td>");d.push("</tr>");d=d.join("");c=["<table>"];for(h=0;h<b;h++)c.push(d);c.push("</table>");b=e.createElement("DIV");b.innerHTML=c.join("");return b.removeChild(b.firstChild)});Wh.prototype.Oo=Z(18,ca("Mj"));ip.prototype.Oo=Z(17,ca("Mj"));
gf.prototype.Op=Z(14,function(b,c,d){var e=za(),g=d?d:e,h=this.al.vg.length?this.al.vg.pop():this.al.Kk();h.Vq=2;h.Uq=g;h.type=c;h.PB=b;b=(b=this.YW)&&b.isTracing()?b.totalVarAlloc:-1;h.DH=b;this.cv++;if(d){d=this.Df.length;for(b=0;b<d;b++)if(this.Df[b].Uq>g){z.In(this.Df,h,b);break}b==d&&this.Df.push(h)}else this.Df.push(h);if(g=h.type)h=this.$j.get(g),h||(h=this.$o.vg.length?this.$o.vg.pop():this.$o.Kk(),h.type=g,this.$j.set(g,h)),h.count++;this.Nt+=za()-e});
Zd.prototype.config=Z(13,function(b,c){this.log(ee,b,c)});Gp.prototype.kw=Z(12,function(){return Jp});Qr.prototype.gr=Z(0,p("Ia"));
a.Vs=function(b){return b.Jd?b.Ia:b.Ia.m()},a.Ws=function(b){b.ux=j;b.dC=vg(b.m()).height;vr+=b.dC;z.forEach(tr,function(b){b&&(!b.ux&&b.fl)&&b.zo()})},a.Xs=function(b,c){var d=b.parentNode,e=z.indexOf(d.childNodes,b)+(c?0:1),d=Rs(d,e,c);A&&(D("9")&&1==d.ba.nodeType&&"HR"==d.ba.tagName)&&(e=d.ba,d.ba=e.parentNode,d.offset=z.indexOf(d.ba.childNodes,e)+(c?0:1));Tq(d.ba,d.offset).select()},a.Ys=function(b,c){b.Tx=c==k||c instanceof Pf?c:new Pf(c,i,i,i);b.R()&&b.ha()},a.Zs=function(b,c){if(zm(b))b.selectionStart=
c,b.selectionEnd=c;else if(A){var c=Cm(b,c),d=b.createTextRange();d.collapse(j);d.move("character",c);d.select()}},a.$s=function(b){var c={};z.forEach(b.data.Cb(),function(b){c[b]=this.data.get(b)},b);return c},a.at=function(b){b.Wb()&&b.fire()},a.bt=function(b,c){return b.xd.get(c)},a.ct=function(b,c,d){var e=Li,g={title:"确认使用匿名身份？",content:'<p>使用匿名身份后，你将</p><ul style="margin: 5px 0 0 5px;list-style-position: inside;"><li>不能在该问题下评论（你之前的评论将被隐藏）</li><li>不能邀请别人回答该问题</li></ul>'},h={title:"确认放弃匿名身份？",
content:"你对该问题的回答、赞同和关注行为将以实名显示。"};Ci(b?g:h,function(g){if(g){var h=new V(j),q="/question/"+(b?"set_anonymous":"set_public"),r="qid="+(d||fh.ia);h.on("success",function(){var c=Ie(h);c&&!c.r&&e.dispatchEvent(new Ts(b))});h.ajax(q,r)}c&&c(g)})},a.dt=function(b,c){return b.Rb&&c?z.indexOf(b.Rb,c):-1},a.et=function(b){return b!=k},a.ft=function(b){return!/[^\t\n\r ]/.test(b)},a.gt=function(b,c,d){this.CF=b;this.HR=!!d;b&&!c&&this.next()};y(gt,Md);
gt.prototype.next=function(){var b=this.CF;b||f(P.Ya);this.CF=this.HR?b.previousSibling:b.nextSibling;return b};a.ht=function(b){return 1==b.nodeType||3==b.nodeType&&!ft(b.nodeValue)},a.it=function(b){try{return b.next()}catch(c){return k}},a.jt=function(b,c,d){la(d)||(d=c&&b.childNodes.length?b.childNodes.length-1:0);gt.call(this,b.childNodes[d],j,c)};y(jt,gt);
a.kt=function(b){return 1==b.length?"0"+b:b},a.lt=/^#(?:[0-9a-f]{3}){1,2}$/i,a.mt=function(b,c){var d=$.extend({all:m},mt.defaults,c||{}),e=$(b).get(0).getBoundingClientRect();return!d.all&&(e.bottom<d.paddingTop||e.bottom>$(window).height())||d.all&&(e.top<d.paddingTop||e.bottom>$(window).height())?m:j};mt.defaults={paddingTop:0};
a.nt=/^(?:rgb)?\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2})\)$/i,a.ot=/#(.)(.)(.)/,a.pt=function(b){var c=b.body,b=b.documentElement;return new Mb(c.scrollLeft||b.scrollLeft,c.scrollTop||b.scrollTop)},a.qt=function(b){for(var c;c=!b||1!=b.nodeType?k:it(P.filter(new jt(b,m),ht));)b=c;return b},a.rt=function(b,c,d){Rp.call(this,b,0,d?"添加父话题":"添加子话题");this.yx=d;this.pf=c;this.Or="";this.GG="/topic/parent/remove";this.fW=j};y(rt,Rp);t=rt.prototype;
t.o=function(b){if(this.isEnabled=!b.getAttribute("data-disabled"))rt.n.o.call(this,b),this.ze(j),R(this.VC,m)};t.Cg=function(b){var c;this.yx&&(c="/topic/autocomplete?no_create=true");rt.n.Cg.call(this,b,c);this.T.df.SC=m};t.am=function(){return v(function(b,c){return z.filter(b,function(b){return 3>=b.length?m:z.every(this.data,function(e){return e[1]===b[2]?c===b[1]?(b[0]="plain_text",b[1]='"'+c+'"已在现有列表中',j):m:j})},this)},this)};
t.Je=function(b,c){this.Kg||(this.Kg=j,this.xhr=new V(j),oe(this.h(),this.xhr,"complete",this.su),b||(b=-1),this.yx?this.xhr.ajax("/topic/add","tid="+this.pf+"&pid="+b+"&topic_text="+encodeURIComponent(c)):this.xhr.ajax("/topic/add","tid="+this.pf+"&cid="+b+"&topic_text="+encodeURIComponent(c)))};t.cD=function(b){return'<a class="nor" href="/topic/'+b[1]+'/organize">'+b[0]+"</a>"};
t.so=function(b){if(!this.ga||!this.ga.Wb()){var c=new V(j);this.h().e(c,"success",function(){var d=Ie(c);d.r?U(d.msg):(Tp(this),this.De(),this.dispatchEvent({type:"remove_tag",data:{id:b}}))});this.yx?c.ajax(this.GG,"cid="+this.pf+"&pid="+b):c.ajax(this.GG,"pid="+this.pf+"&cid="+b);this.ga=c}};a.st=function(b,c){this.qh=b instanceof Mb?b:new Mb(b,c)};y(st,Zn);st.prototype.ha=function(b,c,d,e){var g=pt(Rb(b)),h=this.qh.x+g.x,g=this.qh.y+g.y,l=Nm(b),h=h-l.x,g=g-l.y;Om(new Mb(h,g),b,c,d,k,k,e)};
a.tt=function(b,c){if(b){"number"===$.type(c)&&(c={offsetTop:c});var d=$.extend({aI:mt},Uk,c||{});if(!d.aI(b,d)){var e=$(b).offset().top-d.paddingTop-d.offsetTop||0;d.iB?$(document.documentElement).add(document.body).animate({scrollTop:e}):$(window).scrollTop(e)}}},a.ut=function(b,c){c.all=j;return mt(b,c)},a.vt=function(b){var c=b.match(nt);if(c){var b=Number(c[1]),d=Number(c[2]),c=Number(c[3]);if(0<=b&&255>=b&&0<=d&&255>=d&&0<=c&&255>=c)return[b,d,c]}return[]},a.wt=function(b){lt.test(b)||f(Error("'"+
b+"' is not a valid hex color"));4==b.length&&(b=b.replace(ot,"#$1$1$2$2$3$3"));return b.toLowerCase()},a.xt={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",
darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",
firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",
lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",
mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",
rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},
a.yt=/[^\d]+$/,a.zt=function(b){Tq(qt(b),0).select()},a.At=function(b,c){var d=Gc(b);if(b.getElementsByTagName)for(var e in rr)if(b.tagName==e||0<b.getElementsByTagName(e).length)return m;return!c&&" "==d||ft(d)},a.Bt=j,a.Ct=function(b){if(b=aq(b||window))if(b.empty)try{b.empty()}catch(c){}else try{b.removeAllRanges()}catch(d){}},a.Dt=function(b){Rp.call(this);this.eC=k;this.ue="例如：互联网、医学、法律、数学...";this.data=b||[]};y(Dt,Rp);t=Dt.prototype;
t.o=function(b){this.g=b;this.ag=K("zm-tag-editor-labels",this.g);this.ze(j);this.he();this.fb();this.Ef=J("zh-expert-topics");this.Am=J("zh-active-topics");if(this.Ef)$(this.Ef).on("click",".del",$.proxy(function(b){var d=$(b.target).parents(".item");d.data("active")?(lc(this.Am,d[0],0),Fk(d[0])):M(d[0]);z.forEach(this.data,function(b,c){b+""===d.data("url-token")+""&&this.data.splice(c,1)},this);Et(this);this.dispatchEvent("remove")},this));if(this.Am)$(this.Am).on("click",".add",$.proxy(function(b){b=
$(b.target).parents(".item");lc(this.Ef,b[0],0);Fk(b[0]);Et(this);this.dispatchEvent("add")},this));this.data=$("#zh-expert-topics .item").map(function(){return $(this).data("url-token")}).get();this.Zl()};t.hn=function(){this.Dc||(this.Dc=L("div","zm-tag-editor-editor",[this.Se=L("div","zg-section zm-tag-editor-command-buttons-wrap",[this.eb=J("profile-expert-edit-input")])]),this.ue&&(this.Dx=new Fo(this.ue),this.Dx.o(this.eb),this.eb.title=this.ue),kc(this.Dc,this.ag),this.Cg(this.Se))};
t.Cg=function(b){this.T=new Oo("/topic/autocomplete",this.eb,k,k,b,j);this.T.hi(j);this.T.El=this.Ae;this.T.Po(this.am());this.T.Nv=[this.ue];this.h().e(this.T,"select",this.ho);this.h().e(this.T,tm.gh.wi,this.ru);this.h().e(this.T,tm.gh.wi,this.ou);this.h().e(this.T,tm.gh.yI,function(){$(this.T.M.g).hide()})};t.ou=function(){if(0===this.T.cb.length){var b=L("div",{className:"zu-autocomplete-empty"},"没有名字为 "+$(this.eb).val()+" 的话题");$(this.T.M.g).html(b).show()}};
t.ho=function(){var b=this.T.$i().slice(1);b&&3<b.length&&(this.iC=b,this.Je(b))};t.Je=function(b){this.data.push(b[1]);var c=$(this.Ef).find("[data-url-token='"+b[1]+"']")[0];c?Fk(c):($j("TopicMediumV2",{member_url_token:S[1],topic_url_token:b[1]},this.Bq,this),$(this.Am).find("[data-url-token='"+b[1]+"']").remove(),this.dispatchEvent("add"))};t.Bq=function(b){b=$(b)[0];lc(this.Ef,b,0);Fk(b);Et(this)};t.De=ba();
t.Zl=function(){if(!dh.sc){var b=this;this.Bf&&this.Bf.G();var c=new dm;c.Pq="expert-item-moving";em(c,this.Ef,4);c.z();this.Bf=c;this.h().e(this.Bf,"dragend",function(){this.dispatchEvent("sort")});$("a, input, .del, .add",this.Ef).each(function(){b.h().e(this,"mousedown",function(b){b.stopPropagation()})});this.h().e(this.Bf,"beforedragstart",function(){return K("editing",this.Ef)?m:j})}};
a.Et=function(b){var c=$(b.Ef).children().length;6<c&&M($(b.Ef).children()[6]);R(J("zh-profile-expert-empty"),0>=c);0<c&&R(J("zh-profile-expert-warning"),m);R(J("active-topics-wrap"),$(b.Am).children().length);b.Zl()};t.am=function(){return v(function(b){return z.filter(b,function(b){return z.every(this.data,function(d){return d+""!==b[2]+""&&3<b.length})},this)},this)};a.Ft=function(b){Rp.call(this,b,0);this.Or="";this.xB="/topic/ignore"};y(Ft,rt);
Ft.prototype.Je=function(b){this.Kg||(this.Kg=j,this.xhr=new V(j),oe(this.h(),this.xhr,"complete",this.su),this.xhr.ajax(this.xB,"tid="+b+"&method=add"))};Ft.prototype.so=function(b){this.Kg||(this.Kg=j,this.xhr=new V(j),this.h().e(this.xhr,"complete",function(){Tp(this);this.De();this.Kg=m}),this.xhr.ajax(this.xB,"tid="+b+"&method=del"))};a.Gt=function(){Rp.call(this,k,k,"搜索话题");this.eC=k;this.ue="";this.data=[ih[0]]};y(Gt,Rp);t=Gt.prototype;
t.o=function(b){this.g=b;this.ag=K("zm-tag-editor-labels",this.g);this.ze(j);this.he();this.fb()};t.hn=function(){this.Dc||(this.Dc=L("div","zm-tag-editor-editor",[this.cn=L("div","zg-section zg-clear"),this.Se=L("div","zg-section zm-tag-editor-command-buttons-wrap",[this.eb=J("zh-topic-merge-input"),L("a",{"class":"zg-mr15 zg-btn-blue",href:"#",name:"add",style:"display:none;"},"添加"),this.VC=J("zh-topic-merge-btn")])]),kc(this.Dc,this.ag),this.Cg(this.Se))};
t.Cg=function(b){this.T=new Oo("/topic/autocomplete",this.eb,k,k,b,j);this.T.hi(j);this.T.El=this.Ae;this.T.Po(this.am());this.T.Nv=[this.ue];this.h().e(this.T,"select",this.ho);this.h().e(this.T,tm.gh.wi,this.ru)};t.am=function(){return v(function(b){return z.filter(b,function(b){return z.every(this.data,function(d){return d[1]!==b[1]&&3<b.length})},this)},this)};t.ho=function(){var b=this.T.$i().slice(1);b&&3<b.length&&(this.iC=b,this.Je(b[3],b[0]))};
t.Je=function(b,c){var d=this;setTimeout(function(){d.eb.value=c});this.eC=b};t.De=ba();a.Ht=function(b,c,d){T.call(this,d);this.M=c||Gp.O();this.vb=b||this.M.kw()};y(Ht,T);t=Ht.prototype;t.Bx=k;t.kb=k;t.M=k;t.vb=k;t.jb=j;t.cc=j;t.aw=j;t.Db=-1;t.hc=k;t.Pf=m;t.tJ=m;t.yQ=j;t.ng=k;t.ec=function(){return this.Bx||this.M.ec(this)};t.hr=function(){return this.kb||(this.kb=new gl(this.ec()))};t.v=function(){this.g=this.M.v(this)};t.X=function(){return this.M.X(this.m())};t.nc=function(b){return this.M.nc(b)};
t.ca=function(b){this.g=this.M.o(this,b);"none"==b.style.display&&(this.jb=m)};t.B=function(){Ht.n.B.call(this);Oh(this,function(b){b.ya&&It(this,b)},this);var b=this.m();this.M.te(this);this.D(this.jb,j);this.h().e(this,"enter",this.Ew).e(this,"highlight",this.Jw).e(this,"unhighlight",this.Rw).e(this,"open",this.UM).e(this,"close",this.fM).e(b,"mousedown",this.qe).e(Rb(b),"mouseup",this.mM).e(b,["mousedown","mouseup","mouseover","mouseout","contextmenu"],this.dM);this.Kh()&&Jt(this,j)};
a.Jt=function(b,c){var d=b.h(),e=b.ec();c?d.e(e,"focus",b.pe).e(e,"blur",b.Oc).e(b.hr(),"key",b.Ub):d.Da(e,"focus",b.pe).Da(e,"blur",b.Oc).Da(b.hr(),"key",b.Ub)};t.hb=function(){this.Lb(-1);this.hc&&this.hc.pb(m);this.Pf=m;Ht.n.hb.call(this)};t.w=function(){Ht.n.w.call(this);this.kb&&(this.kb.G(),this.kb=k);this.M=this.hc=this.ng=this.Bx=k};t.Ew=s(j);
t.Jw=function(b){var c=dt(this,b.target);if(-1<c&&c!=this.Db){var d=Kt(this);d&&d.ld(m);this.Db=c;d=Kt(this);this.Pf&&d.setActive(j);this.yQ&&(this.hc&&d!=this.hc)&&(d.Mb&64?d.pb(j):this.hc.pb(m))}Nc(this.m(),Uc.wm,b.target.m().id)};t.Rw=function(b){b.target==Kt(this)&&(this.Db=-1);Nc(this.m(),Uc.wm,"")};t.UM=function(b){if((b=b.target)&&b!=this.hc&&b.getParent()==this)this.hc&&this.hc.pb(m),this.hc=b};t.fM=function(b){b.target==this.hc&&(this.hc=k)};
t.qe=function(b){this.cc&&(this.Pf=j);var c=this.ec();c&&Cc(c)?c.focus():b.preventDefault()};t.mM=function(){this.Pf=m};t.dM=function(b){var c;a:{c=b.target;if(this.ng)for(var d=this.m();c&&c!==d;){var e=c.id;if(e in this.ng){c=this.ng[e];break a}c=c.parentNode}c=k}if(c)switch(b.type){case "mousedown":c.qe(b);break;case "mouseup":c.Kf(b);break;case "mouseover":c.fd(b);break;case "mouseout":c.Hh(b);break;case "contextmenu":c.vn(b)}};t.pe=ba();t.Oc=function(){this.Lb(-1);this.Pf=m;this.hc&&this.hc.pb(m)};
t.Ub=function(b){return this.isEnabled()&&this.R()&&(0!=Ph(this)||this.Bx)&&this.$e(b)?(b.preventDefault(),b.stopPropagation(),j):m};
t.$e=function(b){var c=Kt(this);if(c&&"function"==typeof c.Ub&&c.Ub(b)||this.hc&&this.hc!=c&&"function"==typeof this.hc.Ub&&this.hc.Ub(b))return j;if(b.shiftKey||b.ctrlKey||b.metaKey||b.altKey)return m;switch(b.keyCode){case 27:if(this.Kh())this.ec().blur();else return m;break;case 36:Lt(this);break;case 35:Mt(this,function(b,c){b--;return 0>b?c-1:b},0);break;case 38:if(this.vb==Jp)Nt(this);else return m;break;case 37:if(this.vb==Ip)this.ud()?Ot(this):Nt(this);else return m;break;case 40:if(this.vb==
Jp)Ot(this);else return m;break;case 39:if(this.vb==Ip)this.ud()?Nt(this):Ot(this);else return m;break;default:return m}return j};a.It=function(b,c){var d=c.m(),d=d.id||(d.id=c.Ld());b.ng||(b.ng={});b.ng[d]=c};t.H=function(b,c){Ht.n.H.call(this,b,c)};t.xk=function(b,c,d){b.Zj|=2;b.Zj|=64;(this.Kh()||!this.tJ)&&lp(b,32,m);b.Mo(m);Ht.n.xk.call(this,b,c,d);b.ya&&this.ya&&It(this,b);c<=this.Db&&this.Db++};
t.removeChild=function(b,c){if(b=oa(b)?Mh(this,b):b){var d=dt(this,b);-1!=d&&(d==this.Db?b.ld(m):d<this.Db&&this.Db--);(d=b.m())&&(d.id&&this.ng)&&H.remove(this.ng,d.id)}b=Ht.n.removeChild.call(this,b,c);b.Mo(j);return b};t.No=function(b){this.m()&&f(Error("Component already rendered"));this.vb=b};t.R=p("jb");
t.D=function(b,c){if(c||this.jb!=b&&this.dispatchEvent(b?"show":"hide")){this.jb=b;var d=this.m();if(d){R(d,b);if(this.Kh()&&(d=this.ec()))d.tabIndex=this.cc&&this.jb?0:-1;c||this.dispatchEvent(this.jb?"aftershow":"afterhide")}return j}return m};t.isEnabled=p("cc");
t.Xa=function(b){if(this.cc!=b&&this.dispatchEvent(b?"enable":"disable"))if(b?(this.cc=j,Oh(this,function(b){b.dI?delete b.dI:b.Xa(j)})):(Oh(this,function(b){b.isEnabled()?b.Xa(m):b.dI=j}),this.Pf=this.cc=m),this.Kh()){var c=this.ec();c&&(c.tabIndex=b&&this.jb?0:-1)}};t.Kh=p("aw");t.Fe=function(b){b!=this.aw&&this.ya&&Jt(this,b);this.aw=b;if(this.cc&&this.jb){var c=this.ec();c&&(c.tabIndex=b?0:-1)}};t.Lb=function(b){(b=Qh(this,b))?b.ld(j):-1<this.Db&&Kt(this).ld(m)};
t.ld=function(b){this.Lb(dt(this,b))};a.Kt=function(b){return Qh(b,b.Db)},a.Lt=function(b){Mt(b,function(b,d){return(b+1)%d},Ph(b)-1)},a.Ot=function(b){Mt(b,function(b,d){return(b+1)%d},b.Db)},a.Nt=function(b){Mt(b,function(b,d){b--;return 0>b?d-1:b},b.Db)},a.Mt=function(b,c,d){for(var d=0>d?dt(b,b.hc):d,e=Ph(b),d=c.call(b,d,e),g=0;g<=e;){var h=Qh(b,d);if(h&&b.DB(h)){b.oz(d);break}g++;d=c.call(b,d,e)}};t.DB=function(b){return b.R()&&b.isEnabled()&&!!(b.Mb&2)};t.oz=function(b){this.Lb(b)};
a.Pt=function(b,c){st.call(this,b,c)};y(Pt,st);Pt.prototype.Tn=0;Pt.prototype.hm=ca("Tn");Pt.prototype.ha=function(b,c,d,e){var g=bg(b),g=gg(g),h;h=Sb(b);h=Zb(h.Ga);h=new Mb(this.qh.x+h.scrollLeft,this.qh.y+h.scrollTop);var l=c,n=Om(h,b,l,d,g,10,e);if(0!=(n&496)){if(n&16||n&32)l^=2;if(n&64||n&128)l^=1;n=Om(h,b,l,d,g,10,e);0!=(n&496)&&Om(h,b,c,d,g,this.Tn,e)}};a.Qt=function(b,c,d,e){$n.call(this,b,c);this.Tn=d?5:0;this.Dy=e||i};y(Qt,$n);Qt.prototype.qn=p("Tn");Qt.prototype.hm=ca("Tn");
Qt.prototype.ha=function(b,c,d,e){var g=Pm(this.element,this.yf,b,c,k,d,10,e,this.Dy);if(g&496){var h=Rt(g,this.yf),c=Rt(g,c),g=Pm(this.element,h,b,c,k,d,10,e,this.Dy);g&496&&(h=Rt(g,h),c=Rt(g,c),Pm(this.element,h,b,c,k,d,this.qn(),e,this.Dy))}};
a.Rt=function(b,c){b&48&&(c^=2);b&192&&(c^=1);return c},a.St={},a.Tt=function(b){if(b){var c=b.getBoundingClientRect(),d=c.bottom,c=c.top;d<Yb().height&&0>c&&setTimeout(function(){var c=b.getBoundingClientRect().bottom,g=pt(document);window.scrollTo(g.x,g.y+c-d)})}},a.Ut=function(b){function c(b){return $.isNumeric(b)?b+" ":b}var d;d=d||+new Date;if(0>=d-b)return"刚刚";b=Math.floor((d-b)/1E3);d=Math.floor(b/31536E3);if(1<=d)return c(d)+"年前";d=Math.floor(b/2592E3);if(1<=d)return c(d)+"月前";d=Math.floor(b/
604800);if(1<=d)return c(d)+"周前";d=Math.floor(b/86400);if(1<=d)return c(d)+"天前";d=Math.floor(b/3600);if(1<=d)return c(d)+"小时前";d=Math.floor(b/60);if(1<=d)return c(d)+"分钟前";d=Math.floor(b);return c(d)+"秒前"},a.Vt=function(){var b=S;return 1===b||0===b?"匿名用户":['<a data-tip="p$t$',b[1],'" href="/people/',b[1],'" title="'+b[0]+'" class="','zm-item-link-avatar">','<img class="zm-item-img-avatar" src="'+b[2]+'" />',"</a>"].join("")},a.Wt=function(b,c){return!ma(b)?"匿名用户":['<a data-tip="p$t$',b[1],'" href="/people/',
b[1],'"',c?' class="'+c+'"':"",' title="',b[0],'">',b[0],"</a>"].join("")},a.Xt=function(b){if(0===b||1===b)return"匿名用户";var c=L("a",{href:"/people/"+b[1],title:b[0]},b[0]);c.setAttribute("data-tip","p$t$"+b[1]);return c},a.Yt=function(b){if(0===b||1===b)return L("span");if(ma(b)){var c=L("a",{href:"/people/"+b[1],title:b[0],"class":"zm-item-link-avatar"},L("img",{src:b[2],"class":"zm-list-avatar"}));c.setAttribute("data-tip","p$t$"+b[1]);return c}},a.Zt=function(b){return 1===b?j:ma(b)?b[3]===S[3]:
m},a.$t=function(b,c,d,e,g,h){h&&(e&&(e=$.proxy(e,h)),g&&(g=$.proxy(g,h)));$.post("/node/"+b,{method:c,params:d},function(b){b&&b.r?g&&g(b):e&&e(b)})},a.au=function(b,c){return $.post("/question/askpeople",{qid:b,uid:c,op:"remove"})},a.bu=function(b,c,d){return $.post("/question/askpeople",{qid:b,uid:c,_source_type:d,op:"add"})},a.cu=function(b,c){return $.post("/node/AnswerVoteBarV2",{method:c,params:{answer_id:b}},function(b){b&&b.r&&Di("提示信息","<p>"+b.msg+'</p><p><a href="/question/24752645" target="_blank">为什么回答会被建议修改？</a></p>')})},
a.du=function(b,c){return $.get(c?"/node/AnswerFullVoteInfoV2":"/node/AnswerVoteInfoV2",{params:{answer_id:b}})},a.eu=function(b){var c={},b=String(b),d="#"==b.charAt(0)?b:"#"+b;if(lt.test(d))return c.Ar=wt(d),c.type="hex",c;d=vt(b);if(d.length){var e=d[0],b=d[1],d=d[2],e=Number(e),b=Number(b),d=Number(d);(isNaN(e)||0>e||255<e||isNaN(b)||0>b||255<b||isNaN(d)||0>d||255<d)&&f(Error('"('+e+","+b+","+d+'") is not a valid RGB color'));e=kt(e.toString(16));b=kt(b.toString(16));d=kt(d.toString(16));c.Ar=
"#"+e+b+d;c.type="rgb";return c}if(xt&&(d=xt[b.toLowerCase()]))return c.Ar=d,c.type="named",c;f(Error(b+" is not a valid color string"))},a.fu=function(b){if(b.altKey&&!b.ctrlKey||b.metaKey||112<=b.keyCode&&123>=b.keyCode)return m;switch(b.keyCode){case 18:case 20:case 93:case 17:case 40:case 35:case 27:case 36:case 45:case 37:case 224:case 91:case 144:case 12:case 34:case 33:case 19:case 255:case 44:case 39:case 145:case 16:case 38:case 224:case 92:return m;case 0:return!B;default:return 166>b.keyCode||
183<b.keyCode}},a.gu=function(b){var c=Rb(b),d=A&&b.currentStyle;if(d&&Kc(Sb(c))&&"auto"!=d.width&&"auto"!=d.height&&!d.boxSizing)return c=wg(b,d.width,"width","pixelWidth"),b=wg(b,d.height,"height","pixelHeight"),new Ob(c,b);d=vg(b);c=yg(b);b=hg(b);return new Ob(d.width-b.left-c.left-c.right-b.right,d.height-b.top-c.top-c.bottom-b.bottom)},a.hu=function(b,c){var d=Sb(c),e=k;if(A)d=e=d.Ba().createStyleSheet(),A?d.cssText=b:d.innerHTML=b;else{var g=Tb(d.Ga,"head",i,i)[0];g||(e=Tb(d.Ga,"body",i,i)[0],
g=d.v("head"),e.parentNode.insertBefore(g,e));var h=e=d.v("style");A?h.cssText=b:h.innerHTML=b;d.appendChild(g,e)}},a.iu=function(b,c){var d=b.style[eb(c)];return"undefined"!==typeof d?d:b.style[Vf(b,c)]||""},a.ju=function(){f(Error("unimplemented abstract method"))},a.ku=function(){N.call(this)};y(ku,Yk);
ku.prototype.z=function(){this.Lr=J("help-index");(new ur).o(this.Lr);var b=window.location.href,c="";0<b.indexOf("#")&&(c=b.substring(b.indexOf("#")),b=b.substring(0,b.indexOf("#")));"/help"===b.substring(b.length-5)&&(b+="/faq");var d=Ub("a",k,this.Lr);z.forEach(d,function(d){(d.href===b||d.href===b+c)&&Hc(d,function(b){"UL"===b.tagName&&E.add(b,"force-display");"LI"===b.tagName&&E.add(b,"current")})},this);this.h().e(this.Lr,"click",this.CM)};
ku.prototype.CM=function(b){if((b=Jk(this.Lr,b.target))&&0<b.href.indexOf("#")){var c=Ic(b,"ul",k),c=Ub("li",k,c);z.forEach(c,function(b){E.remove(b,"current")},this);E.add(b.parentNode,"current")}};a.lu=function(b){N.call(this);this.view=this.name=k;H.extend(this.options={},this.defaults,b||{})};y(lu,Gd);a.mu={},a.nu=function(b,c){function d(c){lu.call(this,c);this.name=b}y(d,lu);ya(d.prototype,c);mu[b]=d};lu.prototype.defaults={};lu.prototype.h=function(){return this.zg||(this.zg=new le(this))};lu.prototype.z=ba();lu.prototype.w=function(){lu.n.w.call(this);this.view&&(H.remove(this.view.jd,this.name),this.view=k);this.zg&&(this.zg.G(),this.zg=k)};a.ou=function(b){T.call(this);H.extend(this.F={},this.defaults,b||{});this.source=this.F.source;this.promise=$.Deferred().resolve();this.jd={}};y(ou,T);t=ou.prototype;t.defaults={source:k,la:["autoload","shortcut"],Vg:j,Om:"zg-btn-white zu-button-more"};t.la=function(b,c){var d,e=mu[b];e||f(Error("Cannot find constructor"));d=new e(c);d.view=this;this.ya?d.z(this):this.h().e(this,"initialized",function(){d.z(this)});this.jd[b]=d;return this};
t.Hi=function(){!this.Bd&&this.F.Vg&&(this.Bd=this.jq(),kc(this.Bd,this.g),this.h().e(this.Bd,"click",this.Ox))};t.B=function(){ou.n.B.call(this);this.Hi();z.forEach(this.Hb(),this.Bq,this);z.forEach(this.F.la,this.la,this);this.dispatchEvent("initialized")};t.w=function(){H.forEach(this.jd,function(b){b.G()});this.jd=k;ou.n.w.call(this)};a.pu=function(b,c,d){b.ya&&z.forEach(b.Hb(),c,d);b.h().e(b,"itemcreated",function(b){c.call(d,b.item)})};t.Hb=function(){return oc(this.g)};
t.Bq=function(b,c){this.Gj(b,c);this.dispatchEvent({type:"itemcreated",item:b,index:c})};t.Gj=ha;a.qu=function(b){b.Bd&&(M(b.Bd),b.Bd=k);b.dispatchEvent("complete")};t.OP=function(b){if(b){var c=b.results,d=!c||!c.length;d||this.W(c);this.dispatchEvent("next");(d||b.next===m)&&qu(this)}};t.W=function(b,c){var b=$.isArray(b)?b.join(""):b,d=fc(b+" ");z.forEach($.makeArray(oc(d)),this.Bq,this);lc(this.g,d,c)};
t.Ox=function(){this.dispatchEvent("beforeloadnext")!==m&&"pending"!==this.promise.state()&&(this.zz(j),this.promise=this.source().done(v(this.OP,this)).always(v(xa(this.zz,m),this)))};t.cd=p("Bd");t.jq=function(){return L("a",{"aria-role":"button","class":this.F.Om},"更多")};t.zz=function(b){this.Bd&&(this.Bd.innerHTML=b?'<i class="spinner-gray"></i> 加载中':"更多",E.enable(this.Bd,"loading",b))};a.su=function(b,c){var d=Array.prototype.slice.call(arguments),e=d.shift();"undefined"==typeof e&&f(Error("[goog.string.format] Template required"));return e.replace(/%([0\-\ \+]*)(\d+)?(\.(\d+))?([%sfdiu])/g,function(b,c,e,n,q,r,w,F){if("%"==r)return"%";var I=d.shift();"undefined"==typeof I&&f(Error("[goog.string.format] Not enough arguments"));arguments[0]=I;return ru[r].apply(k,arguments)})},a.ru={s:function(b,c,d){return isNaN(d)||""==d||b.length>=d?b:b=-1<c.indexOf("-",0)?b+Array(d-b.length+
1).join(" "):Array(d-b.length+1).join(" ")+b},f:function(b,c,d,e,g){e=b.toString();isNaN(g)||""==g||(e=b.toFixed(g));var h;h=0>b?"-":0<=c.indexOf("+")?"+":0<=c.indexOf(" ")?" ":"";0<=b&&(e=h+e);if(isNaN(d)||e.length>=d)return e;e=isNaN(g)?Math.abs(b).toString():Math.abs(b).toFixed(g);b=d-e.length-h.length;0<=c.indexOf("-",0)?e=h+e+Array(b+1).join(" "):(c=0<=c.indexOf("0",0)?"0":" ",e=h+Array(b+1).join(c)+e);return e},d:function(b,c,d,e,g,h,l,n){return ru.f(parseInt(b,10),c,d,e,0,h,l,n)}};ru.i=ru.d;
ru.u=ru.d;nu("activeSource",{defaults:{$J:"%d 条新动态",Om:"zu-main-feed-fresh-button",gY:ha},z:function(b){this.data=[];this.button=this.jq();jc(this.button,b.m());this.h().e(this.button,"click",function(){b.W(this.data,0);this.setData([])});var c=this,d=this.options.source(function(b){b&&b.length&&c.setData(b.concat(c.data))},function(){return c.data});(!d||!qa(d.G))&&f(Error("Source must return a disposable object."));this.eL=d},setData:function(b){this.data=b;this.wP()},wP:function(){var b=this.data.length;
xc(this.button,su(this.options.$J,b));R(this.button,!!b)},jq:function(){return L("a",{href:"javascript:;",style:"display:none","class":this.options.Om})},G:function(){lu.prototype.G.call(this);Tc(this.eL);this.options=k;this.button&&(M(this.button),this.button=k)}});a.tu=function(){N.call(this);this.size=k;this.nW=yg(document.body).top;this.da=new le(this);this.dp=k;this.ZK=250;this.Dg()};y(tu,Gd);ia(tu);tu.prototype.Dg=function(){this.size=Yb();var b=this.dp=new Tn(this.update,this.ZK,this);this.da.e(window,"scroll",b.fire,m,b).e(window,"resize",b.fire,m,b)};tu.prototype.h=p("da");tu.prototype.w=function(){tu.n.w.call(this);this.da.G();this.da=k;this.dp.G();this.dp=k};tu.prototype.update=function(){this.size=Yb();this.dispatchEvent("update")};
a.vu=function(b,c,d){var e=uu;e.da.e(e,"update",function h(){b.getBoundingClientRect().bottom<this.size.height&&(c.call(d),this.da.Da(this,"update",h))})},a.uu=tu.O();$(function(){uu.update()});nu("autoload",{defaults:{MR:function(b){return 0!==b%3}},z:function(b){if(b.cd()&&S.ua()){var c=this,d=uu;c.h().e(d,"update",function(d){var e;e=ua(c);var l=sd[e];if(l){var n=la("abouttosee"),q=la(i);n&&q?(l=rd.abouttosee,e=!!l&&!!l[i]&&e in l[i]):e=!n&&!q?j:z.some(l,function(b){return n&&"abouttosee"==b.type||q&&b.capture==i})}else e=m;e&&(sg(b.cd())&&400>=b.cd().getBoundingClientRect().top-d.target.size.height)&&c.dispatchEvent("abouttosee")});var e=0;this.h().e(b,"complete",this.G).e(b,"next",
function(){e+=1;this.options.MR(e)&&this.enable()});this.enable()}},enable:function(){oe(this.h(),this,"abouttosee",function(){this.view.Ox()})}});nu("childConstructor",{defaults:{Ji:k,factory:k},z:function(b){qa(this.options.Ji)&&pu(b,this.EK,this);qa(this.options.factory)&&pu(b,this.aR,this)},EK:function(b){var c=new this.options.Ji;this.view.H(c);c.o(b)},aR:function(b){var c=this.options.factory(b);this.view.H(c);c.o(b)}});nu("dataPagingSource",{defaults:{HB:j},z:function(b){var c=$(b.m()).data("paging").next;c||qu(b);b.source=function(){return $.get(c).then(function(b){c=b.paging.next;return{results:b.htmls,next:!!c}})}}});a.wu=function(b){H.extend(this.F={},this.defaults,b||{});this.content="";this.yc=this.He=this.Ie=k;this.qd=m;this.valid=j};y(wu,T);t=wu.prototype;t.defaults={vH:"textarea.content",BB:".toggle-expand",KS:".summary",fv:"zm-editable-content",cr:m};
t.B=function(){wu.n.B.call(this);var b=this.g,c=this.F;c.cr?(this.Ie=$("."+c.fv,b),this.content=this.Ie.val(),this.yc=$(c.BB,b)):(this.Gp=$(c.vH,b),this.content=this.Gp.is(":input")?this.Gp.val():this.Gp.html(),this.Ie=$(c.KS,b),this.yc=$(c.BB,this.Ie));if(this.Ie.length){if(this.yc.length)this.yc.click(m).on("click",$.proxy(this.expand,this));this.Ie.on("click",$.proxy(this.cN,this))}else this.valid=m,this.expand=this.collapse=ha,this.dispatchEvent("invalid")};t.cd=function(){return this.yc.get(0)};
t.$a=p("content");t.Ja=function(b,c){b?this.expand(c):this.collapse(c)};t.cN=function(b){var c=Rq();if(!c||!c.Gc())c=$(b.target).closest("a").get(0),c&&"javascript:"!==c.protocol||(b.preventDefault(),this.expand())};
t.expand=function(b){!this.qd&&this.dispatchEvent("beforeexpand")!==m&&(this.qd=j,this.F.cr?(this.Ie.removeClass("fixed-summary"),this.yc.remove()):(this.He?this.He.show():this.Ie.length&&(this.He=$("<div>",{html:this.content,"class":this.F.fv}).insertBefore(this.Gp)),this.Ie.hide()),b!==j&&this.dispatchEvent("expand"))};t.collapse=function(b){this.qd&&(this.qd=m,this.He&&this.He.hide(),this.F.cr?this.Ie.addClass("fixed-summary"):this.Ie.show(),b!==j&&this.dispatchEvent("collapse"))};nu("expandLimit",{defaults:{XS:3},z:function(b){var c=Zi.create("ExpandLimit");c.get("expandCount")||c.Td("expandCount","0");S.ua()||(this.h().e(b,"beforeexpand",function(b){var e=parseInt(c.get("expandCount"),10)||0;if(b.target instanceof wu&&(b=e+1,c.Td("expandCount",b),b>=this.options.XS))return new on("expand"),m}),this.h().e(b,"beforeloadnext",function(){new on("expand");return m}))}});nu("locationSource",{defaults:{hs:20,param:k,Hs:m,offset:function(b){return b.length}},z:function(b){function c(b){return{start:d.Hs?z.Qd(b).id.split("-")[1]:0,offset:d.offset(b)}}var d=this.options,e=d.url||location.href,g=b.Hb().length;(!g||g<d.hs)&&qu(b);b.source=function(){return $.post(e,(d.param||c)(b.Hb())).then(function(c){if(!c.r){var c=c.msg,e=c[0];pa(e)&&e<d.hs&&qu(b);return{results:c[1]}}})}}});nu("nodeSource",{defaults:{HB:j},z:function(b){var c=$(b.m()).data("init"),d="/node/"+c.nodename,e=c.params,g=e.offset||0,c=e.limit,h=e.pagesize;this.options.HB&&(c&&b.Hb().length<c)&&qu(b);b.source=function(){return $.post(d,{method:"next",params:$.extend(e,{offset:g+b.Hb().length})}).then(function(b){var c=j;h&&(!b.r&&b.msg.length<h)&&(c=m);return!b.r&&{results:b.msg,next:c}})}}});nu("shortcut",{defaults:{items:">div"},z:function(b){b.Hb().length&&(this.eo=new Rn(this.options),this.eo.o(b.m()),this.h().e(this.eo,"action",function(c){c.data.index>=c.data.size&&b.cd()&&sg(b.cd())&&b.cd().click()}))},G:function(){lu.prototype.G.call(this);this.eo&&(this.eo.G(),this.eo=k)}});a.xu=function(b){ou.call(this,b)};y(xu,ou);a.yu=function(){N.call(this)};y(yu,Gd);yu.prototype.RA={question:"问题",comment:"评论",answer:"回答",favlist:"收藏",member:"用户",message:"私信",image:"图片",video:"视频",post:"文章"};yu.prototype.lv="report-dialog";yu.prototype.aF="loading";yu.prototype.GL='<form><div class="header"><% if (headnote) { %><span class="headnote"><%=headnote%></span><% } %>请选择理由</div><ul class="options clearfix"><% each(options, function(option) { %><li><label><input value="<%=option.value%>" name="reason" type="radio"><%=option.label%></label><% if (option.description) { %><div class="description visible-if-checked"><%=option.description%></div><% } %><% if (option.options) { %><ul class="group-options clearfix visible-if-checked"><% each(option.options, function(opt) { %><li><label><input required data-description="<%=opt.description%>" value="<%=opt.value%>" name="reason-<%=option.value%>" type="radio"><%=opt.label%></label></li><% }) %></ul><div class="group-description visible-if-checked"></div><% } %><% if (option.value == 0) { %><p class="input-container visible-if-checked"><input placeholder="请填写原因" type="text" name="detail" class="reason-text zg-form-text-input"></p><p class="error-container visible-if-checked"></p><% } %></li><% }) %></ul><p class="footnote"></p></form>';
yu.prototype.submit=ju;t=yu.prototype;t.lw=p("bn");t.Ou=function(){var b=new yi;bi(b,j);b.Tk=j;hi(b,ji);b.addEventListener(ii,this.jM,m,this);Rc(b,this);return b};t.jM=function(b){if("ok"===b.key)return(b=$("form",this.bn.m()).valid())&&this.submit(),b};
t.open=function(b,c,d){var e=this.bn=this.Ou();e.Ma(this.jD(b));e.Ea(this.Pu());e.D(j);E.add(e.m(),this.lv);E.add(e.m(),this.aF);this.qD(b).then(v(function(g){e.Ea(Qk(this.GL,{each:z.forEach,options:g,headnote:d}));E.remove(e.m(),this.aF);e.ha();e.Ug(450);this.Kv={type:b,id:c};this.Gu(b,g)},this))};t.FD=ba();
t.Gu=function(b,c){var d=this,e=$(this.bn.m()),g=$("form",e),h=$(".reason-text",e);e.on("change",":radio",function(b){b=$(b.target);e.find("li").removeClass("checked");b.parentsUntil(g,"li").addClass("checked");var n=this.value,q=z.find(c,function(b){return n===String(b.value)});d.FD(q);q="0"===n;h.toggle(q);q&&h.placeholder();b.closest("li").find("ul, :text").length||g.valid()});e.find("ul ul").on("change",":radio",function(b){$(b.delegateTarget).parent().find(".group-description").text($(this).data("description"))});
g.validate({rules:{reason:"required",detail:{rangelength:[2,100],required:function(){return!!$("input[name=reason]:checked",e).length}}},messages:{reason:"请选择理由",detail:"理由为 2-100 字"},errorLabelContainer:$(".error-container",g)})};t.Pu=s('<div class="loading">理由加载中<i class="spinner-gray"></i></div>');a.zu=function(){N.call(this)};y(zu,yu);zu.prototype.qD=v(Uj(function(b){return $.getJSON(Ga("/report/%s/options",b))}),fa);zu.prototype.jD=function(b){return Ga("为什么举报这个%s？",this.RA[b]||"条目")};zu.prototype.submit=function(){var b=this.lw(),c=$($("form",this.bn.m())[0]).serialize()+"&"+$.param(this.Kv);$.post("/report",c).done(function(c){b.D(m);c.r?U(c.msg):U("您的举报我们已经收到，处理完成后会私信告知处理结果。",2E3)});Y.Z({type:"ga_click_report",data:{type:this.Kv.type}})};
a.Au=sn(function(b,c,d){Y.Z({type:"ga_click_report_box",data:{type:b}});(new zu).open(b,c,d)},j);a.Bu=function(){N.call(this);this.xe="zm-pm-item"};y(Bu,Yk);Bu.prototype.z=function(){var b=J("zh-create-pm");b&&this.h().e(b,"click",this.uP);var b=J("zh-pm-item-wrap"),c=new xu;c.la("locationSource",{param:function(b){return{start:b[b.length-1].getAttribute("data-token")}}});c.o(b);this.h().e(b,"click",this.ra);$(function(){$("#zh-change-pm-admin").change(function(){var b=$(this).find("option:selected").attr("data-token");location.href="self"===b?"/admin_feedback":"/admin_feedback/"+b})})};
Bu.prototype.uP=sn(function(){var b;this.Dn();this.Kb.show();To(this.Kb,-1);(b=Xa(location.pathname,"admin_inbox")?"admin":$("#zh-change-pm-admin option:selected").attr("data-token"))&&this.Kb.nt(b)},j);Bu.prototype.Dn=function(){this.Kb||(this.Kb=new Po({Vs:j}))};
Bu.prototype.ra=function(b){if(b=Jk(this.QX,b.target)){var c=b.name,d=Ic(b,k,this.xe);if(!d||!b.name)return j;var e=$(d).data(),g=e.member,h=e.name;switch(c){case "reply":sn(v(function(){this.Dn();this.Kb.show();var b=this.Kb,c=e.type;b.cp=e.token;b.Yz=c;To(this.Kb,g,h,m);this.Kb.Vb.focus()},this),j)();break;case "report":Au("message",e.reportToken,"被举报私信将会被管理员查阅");break;case "delete":var l=d.getAttribute("data-token");Ci("删除私信会话","你确定要删除与 "+h+"的所有会话吗？",function(b){if(b){var c=new V(j);c.on("success",
function(){var b=Ie(c);b.r?U(b.msg):window.location.reload()});c.ajax("/inbox/delete","type=thread&token="+l)}},this);break;case "edit":b=this.eg,R(this.Jc,j),R(b,m),this.li=-1}}};a.Cu=function(){N.call(this);this.xe="zm-pm-item"};y(Cu,Yk);
Cu.prototype.z=function(){this.ls=J("zh-pm-detail-item-wrap");this.h().e(this.ls,"click",this.ra);var b=J("zh-pm-editor-form");if(b){this.Kb=new Po({Vs:j});this.Kb.qp=m;this.Kb.Sg(b);this.Kb.show();if(b=this.Hb()[0]){var b=$(b).data(),c=this.Kb,d=b.type;c.cp=b.token;c.Yz=d;To(this.Kb,b.member,b.name)}else b=jh,To(this.Kb,b.id,b.gw);this.Kb.focus()}else this.Kb=new Po({Vs:j});this.Hb().length&&(b=new xu,b.la("locationSource",{param:function(b){return{start:b[b.length-1].getAttribute("data-token")}}}),
b.o(this.ls))};Cu.prototype.Hb=function(){return oc(this.ls)};
Cu.prototype.ra=function(b){var c=Jk(this.ls,b.target);if(c&&(b=c.name,c=Ic(c,k,this.xe))){var c=$(c).data(),d=c.token;switch(b){case "reply":this.Kb.show();var b=this.Kb,e=c.type;b.cp=d;b.Yz=e;To(this.Kb,c.member,c.name,m);this.Kb.focus();break;case "delete":Ci("删除私信","你确定要删除这封私信吗？",function(b){if(b){var c=new V(j);oe(this.h(),c,"success",function(){var b=Ie(c);b.r?U(b.msg):window.location.reload()});c.ajax("/inbox/delete","type=single&token="+d)}},this);break;case "report":Au("message",d,"被举报私信将会被管理员查阅")}}};a.Du=function(){};y(Du,$o);ia(Du);Du.prototype.L=s("goog-menuheader");a.Eu=function(b,c,d){ip.call(this,b,d||Du.O(),c);lp(this,1,m);lp(this,2,m);lp(this,4,m);lp(this,32,m);this.$=1};y(Eu,ip);gp("goog-menuheader",function(){return new Eu(k)});a.Fu=function(){this.Wu=[]};y(Fu,$o);ia(Fu);a.Gu=function(b,c){var d=b.Wu[c];if(!d){switch(c){case 0:d=b.L()+"-highlight";break;case 1:d=b.L()+"-checkbox";break;case 2:d=b.L()+"-content"}b.Wu[c]=d}return d};t=Fu.prototype;t.pc=function(){return Vc.DI};t.v=function(b){var c=b.K().v("div",this.Ye(b).join(" "),Hu(this,b.$a(),b.K()));Iu(this,b,c,!!(b.Mb&8)||!!(b.Mb&16));bp(this,b,c);return c};t.X=function(b){return b&&b.firstChild};
t.o=function(b,c){var d=qc(c),e=Gu(this,2);d&&E.has(d,e)||c.appendChild(Hu(this,c.childNodes,b.K()));E.has(c,"goog-option")&&(b.Jo(j),this.Jo(b,c,j));return Fu.n.o.call(this,b,c)};t.Ea=function(b,c){var d=this.X(b),e=Ju(this,b)?d.firstChild:k;Fu.n.Ea.call(this,b,c);e&&!Ju(this,b)&&d.insertBefore(e,d.firstChild||k)};a.Hu=function(b,c,d){b=Gu(b,2);return d.v("div",b,c)};t.gi=function(b,c,d){c&&(Mc(c,d?Vc.FI:this.pc()),Iu(this,b,c,d))};t.Jo=function(b,c,d){c&&(Mc(c,d?Vc.EI:this.pc()),Iu(this,b,c,d))};
a.Ju=function(b,c){var d=b.X(c);if(d){var d=d.firstChild,e=Gu(b,1);return!!d&&E.has(d,e)}return m},a.Iu=function(b,c,d,e){e!=Ju(b,d)&&(E.enable(d,"goog-option",e),d=b.X(d),e?(b=Gu(b,1),d.insertBefore(c.K().v("div",b),d.firstChild||k)):d.removeChild(d.firstChild))};t.nn=function(b){switch(b){case 2:return Gu(this,0);case 16:case 8:return"goog-option-selected";default:return Fu.n.nn.call(this,b)}};
t.uw=function(b){var c=Gu(this,0);switch(b){case "goog-option-selected":return 16;case c:return 2;default:return Fu.n.uw.call(this,b)}};t.L=s("goog-menuitem");a.Ku=function(b,c,d,e){ip.call(this,b,e||Fu.O(),d);this.za(c)};y(Ku,ip);t=Ku.prototype;t.V=function(){var b=this.ay;return b!=k?b:this.wg()};t.za=ca("ay");t.gi=function(b){lp(this,8,b);this.ve()&&!b&&this.Uc(m);var c=this.m();c&&this.M.gi(this,c,b)};t.Jo=function(b){lp(this,16,b);var c=this.m();c&&this.M.Jo(this,c,b)};
t.wg=function(){var b=this.$a();return ma(b)?(b=z.map(b,function(b){var d=E.get(b);return z.contains(d,"goog-menuitem-accel")||z.contains(d,"goog-menuitem-mnemonic-separator")?"":Gc(b)}).join(""),La(b)):Ku.n.wg.call(this)};t.Kf=function(b){var c=this.getParent();if(c){var d=c.cG;c.cG=k;if(c=d&&pa(b.clientX))c=new Mb(b.clientX,b.clientY),c=d==c?j:!d||!c?m:d.x==c.x&&d.y==c.y;if(c)return}Ku.n.Kf.call(this,b)};t.$e=function(b){return b.keyCode==this.Zx&&this.Rd(b)?j:Ku.n.$e.call(this,b)};t.PL=p("Zx");
gp("goog-menuitem",function(){return new Ku(k)});a.Lu=function(){};y(Lu,Gp);ia(Lu);t=Lu.prototype;t.pc=function(){return Vc.CI};t.nc=function(b){return"UL"==b.tagName||Lu.n.nc.call(this,b)};t.pn=function(b){return"HR"==b.tagName?new Fp:Lu.n.pn.call(this,b)};t.xf=function(b,c){return sc(b.m(),c)};t.L=s("goog-menu");t.te=function(b){Lu.n.te.call(this,b);Nc(b.m(),Uc.uk,"true")};a.Mu=function(b){Fp.call(this,Ep.O(),b)};y(Mu,Fp);gp("goog-menuseparator",function(){return new Fp});a.Nu=function(b,c){Ht.call(this,Jp,c||Lu.O(),b);this.Fe(m)};y(Nu,Ht);t=Nu.prototype;t.Bm=j;t.uJ=m;t.L=function(){return this.M.L()};t.xf=function(b){if(this.M.xf(this,b))return j;for(var c=0,d=Ph(this);c<d;c++){var e=Qh(this,c);if("function"==typeof e.xf&&e.xf(b))return j}return m};t.Fa=function(b){this.H(b,j)};t.zi=function(b,c){this.xk(b,c,j)};t.removeItem=function(b){(b=this.removeChild(b,j))&&b.G()};t.Eh=function(b){return Qh(this,b)};t.ll=function(){return Ph(this)};
t.Hb=function(){var b=[];Oh(this,function(c){b.push(c)});return b};t.Vc=function(b,c){var d=this.R();d||R(this.m(),j);mg(this.m(),b,c);d||R(this.m(),m)};t.D=function(b,c,d){(c=Nu.n.D.call(this,b,c))&&(b&&this.ya&&this.Bm)&&this.ec().focus();this.cG=b&&d&&pa(d.clientX)?new Mb(d.clientX,d.clientY):k;return c};t.Ew=function(b){this.Bm&&this.ec().focus();return Nu.n.Ew.call(this,b)};t.DB=function(b){return(this.uJ||b.isEnabled())&&b.R()&&!!(b.Mb&2)};
t.ca=function(b){var c=this.M,d;d=this.K();d=Tb(d.Ga,"div",c.L()+"-content",b);for(var e=d.length,g=0;g<e;g++)Hp(c,this,d[g]);Nu.n.ca.call(this,b)};t.$e=function(b){var c=Nu.n.$e.call(this,b);c||Oh(this,function(d){!c&&(d.PL&&d.Zx==b.keyCode)&&(this.isEnabled()&&this.ld(d),c=d.Ub(b))},this);return c};t.Lb=function(b){Nu.n.Lb.call(this,b);(b=Qh(this,b))&&ig(b.m(),this.m())};a.Ou=function(b,c,d){T.call(this);this.offset=this.Wg=0;this.iS=d;this.mL=b;this.url=c||window.location.href;this.Gg="zm-item";this.params={}};y(Ou,T);t=Ou.prototype;t.pA=!sb;t.oA=!sb;t.di=ca("Gg");t.z=function(){this.Xb=J("zh-load-more");this.o(this.mL)};
t.B=function(){Ou.n.B.call(this);this.Em=1;Pu(this);this.sk=$(this.Xb);this.Xb&&Qu(this)&&(this.h().e(this.Xb,"click",function(){this.Mn=j;this.fh&&"pending"===this.fh.state()&&1===this.Em?(this.fh.done(v(this.ef,this)),this.xz=j,Ru(this,j)):this.ty()}),this.pA&&(this.Zz=new Tn(this.qy,100,this),this.h().e(window,"scroll",function(){this.Zz.fire()})));Su(this,this.Hb())};a.Ru=function(b,c){c?b.sk.html('<i class="spinner-gray"></i>正在加载').prop("disabled",j):b.sk.html("更多").prop("disabled",m)};
t.qy=function(){var b=this.Xb;if(b&&sg(b)&&1E3>=b.getBoundingClientRect().top-Yb().height&&!(this.Ms||this.fh&&"pending"===this.fh.state()))this.oA&&(3===this.Em?(this.Em=1,this.xz=m):(this.Mn=m,this.Em++,this.xz=j)),Tu(this)};t.ty=function(){this.pA&&this.Ms?(this.ef(this.Ms),this.Ms=k):(Ru(this,j),Tu(this))};
a.Qu=function(b){var c=b.Hb();b.offset=b.gy?b.gy(c):c.length;if(b.yr)return c=b.yr(),R(b.Xb,c),c;if(b.Xb){if("-1"===b.sk.attr("data-next")||!c||10>c.length)return b.sk.hide(),m;b.sk.removeClass("hidden").show()}return j},a.Tu=function(b,c,d,e){d=d||ha;if(!(b.fh&&"pending"===b.fh.state())){var g=b.sG($.extend(b.params,{offset:b.offset,start:b.Wg}));"live"!==g.start&&Y.Z({type:"topstory_feed_more"});b.fh=$.post(b.url,g).done(d).done($.proxy(function(b){if(e)return e.call(this,b);this.pA&&!c?this.xz?
this.ef(b):(this.Ms=b,Ru(this,m)):this.ef(b)},b));1!==b.Em&&Ru(b,j);return b.fh}};t.sG=aa();t.ef=function(b){if(b&&!b.r){var c=b.msg,d=c[0],e=c[1],g;2<c.length&&(g=c[2],this.Xb.setAttribute("data-next",g));0<d&&(this.Yp(e),this.offset=this.gy?this.gy(this.Hb()):this.offset+d);c=j;c=this.yr?this.yr(b):!(-1===g||10>d);R(this.Xb,c);Ru(this,m);Uu(this)}};a.Uu=function(b){b.dispatchEvent({data:{Mn:b.Mn,oA:b.oA},type:"afterload"})};t.Hb=function(){return Vb(this.Gg,this.g)};t.lG=function(b){return b.id.split("-")[1]};
a.Pu=function(b){var c=b.Hb(),d;if(b.iS)if(b.Xb&&(d=b.Xb.getAttribute("data-next")),d)b.Wg=d;else if(c=z.Qd(c))b.Wg=b.lG(c)};t.Yp=function(b,c){var d=ma(b)?b.join(""):b,d=fc(d+" "),e=Vb(this.Gg,d);Su(this,e);"prepend"===c?jc(d,this.g.firstChild):this.g.appendChild(d);Pu(this)};a.Su=function(b,c){z.forEach(c,function(b){var c=this.Gj(b);this.dispatchEvent({data:{item:b,vO:c},type:"itemcreated"})},b)};t.Gj=ha;a.Vu=function(b,c){return $.post("/node/ColumnPostVoteBarV2",{method:c,params:{post_id:b}})},a.Wu=function(b,c){return $.get(c?"/node/ColumnPostFullVoteInfoV2":"/node/ColumnPostVoteInfoV2",{params:{post_id:b}})};a.Xu=function(b,c,d){T.call(this);this.tb=b;this.entryType=c||"answer";this.pd=k;this.F=$.extend({},this.defaults,d||{})};y(Xu,T);a.Yu={ae:1,jg:-1,KA:0};Xu.prototype.defaults={pT:"up",gL:"down",GK:"count",Ns:"pressed"};H.extend(Xu.prototype,Yu);t=Xu.prototype;t.$=Yu.KA;
t.o=function(b){Xu.n.o.call(this,b);var c=this.F,b=this.J=$(b);this.cu=$("."+c.pT,b);this.Zt=$("."+c.gL,b);this.wA=$("."+c.GK,b);c=this.cu.hasClass(this.F.Ns);b=this.Zt.hasClass(this.F.Ns);c?this.$=Yu.ae:b&&(this.$=Yu.jg);Zu(this);this.cu.click($.proxy(this.Lt,this));this.Zt.click($.proxy(this.Kt,this));return this};t.Md=p("$");
t.Yb=sn(function(b){if(b!==this.$&&H.pg(Yu,b)){this.dispatchEvent({type:"action",data:{state:b}});this.pd&&"pending"===this.pd.state()&&this.pd.abort();var c=this.$,d=+this.wA.text(),e=0;b===Yu.ae?e=1:c===Yu.ae&&(e=-1);this.wA.text(d+e);this.$=b;Zu(this);b={};b[Yu.ae]="vote_up";b[Yu.jg]="vote_down";b[Yu.KA]="vote_neutral";this.pd=("post"===this.entryType?Vu:cu)(this.tb,b[this.$]);this.pd.done(v(function(b){b.r||this.Sh()},this))}},function(b){var c={};c[Yu.ae]="question_answer_vote_up";c[Yu.jg]="question_answer_vote_down";
return{ua:c[b],lg:j}});t.iT=function(b){b===Yu.ae?Nk("vote","voteup","side_vote"):b===Yu.jg&&Nk("vote","votedown","side_vote")};t.Lt=function(){this.Yb(this.$===Yu.jg?Yu.ae:this.$^Yu.ae)};t.Kt=function(){this.Yb(this.$===Yu.ae?Yu.jg:this.$^Yu.jg)};
a.Zu=function(b){var c=b.$,d=b.F,e=c===Yu.ae,c=c===Yu.jg,g=e?"取消赞同":"赞同",h=c?"取消反对":"反对，不会显示你的姓名";b.cu.toggleClass(d.Ns,e).find(".label").text(g).end().attr("aria-pressed",e).attr("title",g);b.Zt.toggleClass(d.Ns,c).find(".label").text(h).end().attr("aria-pressed",c).attr("title",h)};t.Sh=function(){this.dispatchEvent("change")};a.$u=function(b){N.call(this);this.g=b;b=A||C&&!D("531")&&"TEXTAREA"==b.tagName;this.N=new le(this);this.N.e(this.g,b?["keydown","paste","cut","drop","input"]:"input",this)};y($u,Gd);$u.prototype.ma=k;
$u.prototype.handleEvent=function(b){if("input"==b.type)av(this),(!rb||this.g==Rb(this.g).activeElement)&&this.dispatchEvent(bv(b));else if("keydown"!=b.type||fu(b)){var c="keydown"==b.type?this.g.value:k;A&&229==b.keyCode&&(c=k);var d=bv(b);av(this);this.ma=Kd(function(){this.ma=k;this.g.value!=c&&this.dispatchEvent(d)},0,this)}};a.av=function(b){b.ma!=k&&(Hd.clearTimeout(b.ma),b.ma=k)},a.bv=function(b){b=new kd(b.Tb);b.type="input";return b};
$u.prototype.w=function(){$u.n.w.call(this);this.N.G();av(this);delete this.g};a.dv=function(b,c,d,e){N.call(this);this.Fd=b;this.vh=c;this.Mg=d;this.zC=e||cv;this.oj=new $u(b);O(this.oj,"input",this.lo,m,this);this.Fi()};y(dv,Gd);a.cv=0;t=dv.prototype;t.lo=function(){this.Fi()};t.Fi=function(){var b=this.ir();this.vh&&(0>this.Mg-b?(xc(this.vh,"已超出 "+(b-this.Mg)+" 字"),E.add(this.vh,"zg-text-error")):(xc(this.vh,"还可以输入 "+(this.Mg-b)+" 字"),E.remove(this.vh,"zg-text-error")))};t.w=function(){dv.n.w.call(this);delete this.Fd;this.oj.G();this.oj=k};
t.isValid=function(){return 0<=this.Mg-this.Fd.value.length};t.ir=function(){return this.Fd.value.length};a.ev=function(b,c,d,e){dv.call(this,b,c,d,e)};y(ev,dv);ev.prototype.ir=function(){return Lk(this.Fd.value)};a.fv=function(b,c){N.call(this);this.S=k;this.XK=c;this.bS.apply(this,b);this.z()};y(fv,Yk);fv.prototype.Ne={};a.gv=Uj(function(){return $.get("/node/WebShareDialogV2")});t=fv.prototype;t.z=function(){this.h().e(Li,"question_title_change",function(){this.Ne[this.tf]=k});gv().then(v(function(b){b=fc(Ma(b));this.v(b);this.fb();this.show();hv(this,this.XK)},this))};t.show=function(){iv(this);this.uc&&(this.uc.checked=m,this.Ij());Dp.O().refresh();this.S.D(j)};t.hide=function(){this.S.D(m)};
t.bS=function(b,c,d,e){this.lf={title:b,type:c,cT:d,params:e};this.tf=c+":"+d};
a.iv=function(b){b.S.Ma(b.lf.title);b.Ne[b.tf]||(b.xhr=new V(j),oe(b.h(),b.xhr,"success",b.cS),b.xhr.ajax("/"+b.lf.type+"/"+b.lf.cT+"/sharetext","","GET"));J("zh-webshare-sina-pm").value=b.Ne[b.tf]&&b.Ne[b.tf].sina||"加载中...";b.lH.Fi();Zk(b.Hz);b.Hz.Ot();var c=b.lk;c.Vb.value=b.Ne[b.tf]&&b.Ne[b.tf].pm||"加载中...";c.eK&&c.eK.Fi();Zk(c.oG);c.oG.Ot();R(c.Jc,j);R(c.eg,m);if("answer"===b.lf.type||"post"===b.lf.type)$(b.g).find("#tb-webshare-daily").parent().removeClass("zg-hide"),b.Ne[b.tf]&&$(b.g).find(".tb-webshare-daily-title").html(b.Ne[b.tf].daily)};
t.cS=function(){var b=Ie(this.xhr);b&&b.r?U(b.msg):(this.Ne[this.tf]=b,iv(this))};t.v=function(b){this.g=b;this.S=new yi(k,m);hi(this.S,k);this.S.Tk=j;this.S.X().appendChild(this.g);this.lk=new Po({nG:"share"});this.lk.mb=this.S;this.lk.Sg(J("tb-webshare-letter-content"));this.lk.Hk=m;this.lk.z()};t.rz=function(){this.uc.checked=j;this.Ij()};
a.hv=function(b,c){var d=J(c+"-content"),e=J(c);z.forEach(b.NS,function(b){E.remove(b.parentNode,"active")});z.forEach(b.MS,function(b){R(b,m)});E.add(e.parentNode,"active");R(d,j);b.CR||(b.S.ha(),b.CR=j)};
t.fb=function(){var b=K("tab-navs",this.g);this.h().e(b,"click",this.jQ);this.NS=$(".tab-nav > a",this.g);this.MS=Vb("zm-tab-content",this.g);$(".zm-command",this.g).on("click",$.proxy(this.ra,this));this.Jy=J("zh-webshare-sina-pm");this.Hz=new al(this.Jy);this.lH=new ev(this.Jy,J("zg-webshare-sina-counter"),140,cv);this.h().e(Y,"sina_callback",function(b){this.rz(b.tc.id,b.tc.name)});this.Fu();b=K("zg-btn-blue",this.lk.m());S.yi||E.tH(b,"zg-btn-blue","zg-btn-disabled");this.h().e(b,"click",this.ra)};
t.Fu=function(){this.uc=K("sina-checkbox",this.g);this.h().e(this.uc,"change",this.wy)};t.Ij=function(){var b=K("weibo-share-button",this.g),c=this.uc.checked;E.enable(b,"zg-btn-blue",c);E.enable(b,"zg-btn-disabled",!c)};t.wy=function(b){var b=b.target,c=b.getAttribute("data-bindurl");b===this.uc&&!rh.id?(window.open(c),b.checked=m,b=j):b=i;b||this.Ij()};t.jQ=function(b){(b=this.Xe(b.target))&&hv(this,b.id)};
t.ra=function(b){var c=this.Xe(b.target);if(c)switch(c.name){case "send_sina":if(!E.has(c,"zg-btn-disabled")){var d=this.Jy.value;d&&this.tf in this.Ne&&(c=new Kk(j),c.add("content",d),d=[],this.uc.checked&&d.push("sina"),c.add("via",d.join(",")),this.Lj(c),this.lf&&Y.Z({type:"ga_click_share_"+this.lf.type+"_weibo",data:{$H:d}}))}break;case "send":if(!E.has(c,"zg-btn-disabled"))if(c=this.lk,"-1"===String(c.li))Ro(c,"请填写收信人。");else if(d=c.Vb.value,this.tf in this.Ne)if(Ma(d)){var e=new Kk(j);e.add("talker_id",
c.li);e.add("content",d);e.add("via","pm");this.Lj(e);this.lf&&Y.Z("ga_click_share_"+this.lf.type+"_message")}else Ro(c,"请填写私信内容。");break;case "send_daily":c=new Kk(j);c.add("content",$(".tb-webshare-daily-form [name=recommend-reason]").val());c.add("via","daily");this.Lj(c);break;case "cancel":this.hide()}b.stopPropagation();b.preventDefault()};
t.Lj=function(b){H.forEach(this.lf.params,function(c,d){b.add(d,c)});this.xhr=new V(j);oe(this.h(),this.xhr,"complete",this.uu);this.xhr.ajax("/"+this.lf.type+"/share",b.dd())};t.uu=function(){var b=Ie(this.xhr);b&&b.r?U(b.msg):(this.S.D(m),U(b.msg||"分享发送完毕"))};t.R=function(){return this.S.R()};a.jv=void 0,a.kv=[],a.lv=[].slice,a.mv=Wk(550,function(){if(kv.length){var b=kv;S.ua()&&(b={items:JSON.stringify(b)},$.post("/lastread/touch",b));kv=[]}});jv=function(){kv.push(lv.call(arguments));mv()};a.nv=function(b){var c=k;try{c=b.rules||b.cssRules}catch(d){15==d.code&&(d.styleSheet=b,f(d))}return c},a.ov=function(b){var c=[],b=b||document.styleSheets,d=la(i)?i:m;if(b.imports&&b.imports.length)for(var e=0,g=b.imports.length;e<g;e++)z.extend(c,ov(b.imports[e]));else if(b.length){e=0;for(g=b.length;e<g;e++)z.extend(c,ov(b[e]))}else{var h=nv(b);if(h&&h.length)for(var e=0,g=h.length,l;e<g;e++)l=h[e],l.styleSheet&&z.extend(c,ov(l.styleSheet))}(b.type||b.rules||b.cssRules)&&(!b.disabled||d)&&c.push(b);
return c};a.pv=/a(:(link|visited|active|hover))?/,a.qv=function(){this.an="";this.Rg=[]};qv.prototype.clone=function(){var b=new qv;b.Rg=this.Rg.concat();b.an=this.an;return b};
a.rv=function(b,c,d){var e=[],g;for(g in c){var h=c[g];h&&e.push(g,":",h,d?" !important":"",";")}b.an=e.join("")},a.sv=/(^|;|{)\s*color:([^;]+);/g,a.uv=function(b){this.Hy=[];this.zu={};if(b){for(var c=[],b=b.split(/\s+/gm),d=0;d<b.length;d++)if(b[d]){var e=new tv(b[d]);c.push(e)}this.Wh=c}},a.tv=function(b){var c=vv[b];if(c)return c;for(var c=b.match(/[#\.]/)?b.split(/(?=[#\.])/):[b],d={},e=0;e<c.length;e++){var g=c[e];"."==g.charAt(0)?d.className=g.substring(1,g.length):"#"==g.charAt(0)?d.id=g.substring(1,
g.length):d.tagName=g.toUpperCase()}this.qE=b;this.NO=d;this.wH={};vv[b]=this},a.vv={},a.wv=function(b,c){var d=c.uid,e=b.wH[d];if("undefined"!=typeof e)return e;var g=b.NO,e=g.tagName,h=g.className,g=g.id,l=j;e&&"*"!=e&&e!=c.nodeName?l=m:g&&g!=c.id?l=m:h&&!c.lK[h]&&(l=m);return b.wH[d]=l},a.yv=function(b){var c=ua(b),d=xv[c];if(d)return d;d=[];do{var e={id:b.id,nodeName:b.nodeName};e.uid=ua(e);var g={};if(b.className)for(var h=E.get(b),l=0;l<h.length;l++)g[h[l]]=1;e.lK=g;d.unshift(e)}while(b=b.parentNode);
this.DF=d;this.uid=ua(this);xv[c]=this},a.xv={},a.zv={},a.Av="color visibility quotes list-style-type list-style-image list-style-position list-style page-break-inside orphans widows font-family font-style font-variant font-weight text-indent text-align text-transform white-space caption-side border-collapse border-spacing empty-cells cursor".split(" "),a.Bv="font-family font-size font-weight font-variant font-style color text-align text-decoration text-indent text-transform letter-spacing white-space word-spacing".split(" ");a.Cv=function(){N.call(this);this.cc=this.Np()};y(Cv,Gd);t=Cv.prototype;t.C=k;t.KJ=j;t.Ib=ke("goog.editor.Plugin");t.OH=function(){this.C&&(this.disable(this.C),this.C=k)};t.enable=function(b){this.C==b?this.cc=j:this.Ib.log(be,"Trying to enable an unregistered field with this plugin.",i)};t.disable=function(b){this.C==b?this.cc=m:this.Ib.log(be,"Trying to disable an unregistered field with this plugin.",i)};t.isEnabled=function(b){return this.C==b?this.cc:m};t.Np=mf;t.qO=mf;
t.w=function(){this.C&&this.OH(this.C);Cv.n.w.call(this)};a.Dv=H.rm({Lw:1,GM:2,sr:3,gj:4,tr:5,execCommand:6,queryCommandValue:7,rG:8,nK:10,mK:11}),a.Ev=H.sh(8,10,11);Cv.prototype.execCommand=function(b,c){var d=this.qO(b);d||(B&&Fv(this.C,j,j),this.C.uh());try{var e=this.Ve.apply(this,arguments)}finally{d||(this.C.Re(),Gv(this.C))}return e};Cv.prototype.we=s(m);a.Hv=function(b,c,d,e,g){this.RC=b;this.Kz=c;this.gq=d;this.WC=e;this.Sv=g||{}},a.Iv=function(b,c){this.GT=b;this.aC=c},a.Jv=function(b,c,d,e){var g=[];b.gq&&b.Kz&&g.push("<!DOCTYPE HTML>");g.push('<html style="background:none transparent;min-width:0;');b.gq&&g.push("height:",b.WC?"100%":"auto");g.push('">');g.push("<head><style>");d&&d.aC&&g.push(d.aC);B&&b.Kz&&g.push(" img {-moz-force-broken-image-icon: 1;}");g.push("</style></head>");g.push('<body g_editable="true" hidefocus="true" ');Bt&&g.push("contentEditable ");
g.push('class="editable ');g.push('" id="',b.RC,'" style="min-width:0;');B&&b.gq&&(g.push(";width:100%;border:0;margin:0;background:none transparent;",";height:",b.Kz?"100%":"auto"),b.WC?g.push(";overflow:auto"):g.push(";overflow-y:hidden;overflow-x:auto"));rb&&g.push(";outline:hidden");for(var h in b.Sv)g.push(";"+h+":"+b.Sv[h]);g.push('">',c,"</body></html>");b=g.join("");e=e.contentDocument||e.contentWindow.document;e.open();e.write(b);e.close()};a.Qv=function(b,c){N.call(this);this.Ag=this.id=b;this.gb=k;this.jd={};this.mj={};for(var d in Dv)this.mj[d]=[];this.Lk="";this.bk={};this.bk[Kv]=1;this.bk[Lv]=1;this.sx=this.Zr=m;this.Jq=new xj(this.xC,Mv,this);this.Hq={};for(var e in Nv)this.Hq[Nv[e]]=0;B&&(this.ge=new xj(this.un,Ov,this));this.dc=new le(this);this.HT=[];this.zj=Pv;this.Nl=Sb(c||document);this.Hc=this.Nl.m(this.id);this.zk=this.Nl.Oa()};y(Qv,Gd);Qv.prototype.field=k;Qv.prototype.Hc=k;Qv.prototype.Ib=ke("goog.editor.Field");
a.Kv="change",a.Lv="delayedchange",a.Nv={dU:"cvc",UU:"load",bW:"unload",VT:"beforechange",bU:Kv,iU:Lv,WT:"beforefocus",rU:"focus",YT:"blur",XT:"beforetab",HU:"ifrsz",FV:"selectionchange"},a.Pv=0,a.Rv=k;t=Qv.prototype;t.Bg=m;t.UH=m;t.St=m;t.m=p("field");t.addListener=function(b,c,d,e){var g=this.m();ar&&(g&&this.lc())&&(g=g.ownerDocument);this.dc.e(g,b,c,d,e)};t.Fh=function(b){return this.jd[b]};a.Ov=15,a.Mv=250;Qv.prototype.lc=nf;Qv.prototype.Nn=nf;Qv.prototype.hH=mf;a.Sv={46:j,8:j};A||(Sv[9]=j);
a.Tv={86:j,88:j};A&&(Sv[229]=j);a.Uv=function(b){var c=!(b.ctrlKey||b.metaKey)&&b.keyCode in Sv;return(b.ctrlKey||b.metaKey)&&b.keyCode in Tv||c},a.Vv=function(b,c){b.zj=2;b.field=c;b.gb=Sb(c);b.Zr=m;b.sx=m;c.setAttribute("g_editable","true")};
Qv.prototype.Zu=function(){this.dc&&this.dc.removeAll();if((Ng||Og)&&this.lc()&&this.hH()){try{var b=this.gb.Oa();b.removeEventListener("keydown",this.Lm,m);b.removeEventListener("touchend",this.Lm,m)}catch(c){}delete this.Lm}if(rb&&this.lc()){try{b=this.gb.Oa(),b.removeEventListener("focus",this.Ku,m),b.removeEventListener("blur",this.Ju,m)}catch(d){}delete this.Ku;delete this.Ju}this.ge&&this.ge.stop();this.Jq.stop()};
Qv.prototype.w=function(){(1==this.zj||this.Od())&&this.Ib.jk("Disposing a field that is in use.");this.Hc&&this.execCommand("clearlorem");this.zj=Pv;for(var b in this.jd){var c=this.jd[b];c.Np()||c.disable(this)}this.gb=this.field=k;this.Zu();this.cl&&(zd(this.cl),this.cl=k);this.Nl=k;this.dc&&(this.dc.G(),this.dc=k);for(;b=this.HT.pop();)b.G();Rv==this.id&&(Rv=k);for(var d in this.jd)b=this.jd[d],b.KJ&&b.G();delete this.jd;Qv.n.w.call(this)};
a.Wv=["DOMNodeInserted","DOMNodeRemoved","DOMNodeRemovedFromDocument","DOMNodeInsertedIntoDocument","DOMCharacterDataModified"];Qv.prototype.uz=function(){if(Yq||!this.lc())this.dc.e(this.m(),"DOMSubtreeModified",this.Mw);else{var b=this.gb.Ba();this.dc.e(b,Wv,this.Mw,j);this.dc.e(b,"DOMAttrModified",v(this.wD,this,this.Mw),j)}};
a.Xv=function(b,c){if(9==c.keyCode&&!b.dispatchEvent({type:"beforetab",shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.ctrlKey})||B&&c.metaKey&&(37==c.keyCode||39==c.keyCode))return c.preventDefault(),m;var d;if(!(d=c.charCode))d=Uv(c)?j:!(!B||c.ctrlKey||c.metaKey||B&&!c.charCode);b.xw=d;b.xw&&b.uh();return j},a.Yv={8:1,9:1,13:1,33:1,34:1,35:1,36:1,37:1,38:1,39:1,40:1,46:1},a.Zv={65:j,86:j,88:j},a.$v={8:1,9:1,13:1,27:1,33:1,34:1,37:1,38:1,39:1,40:1};t=Qv.prototype;
t.Ln=function(b,c){for(var d=this.mj[b],e=z.slice(arguments,1),g=0;g<d.length;++g){var h=d[g];if((h.isEnabled(this)||Ev[b])&&h[Dv[b]].apply(h,e))return j}return m};t.dO=function(b,c){for(var d=this.mj[b],e=z.slice(arguments,1),g=0;g<d.length;++g){var h=d[g];(h.isEnabled(this)||Ev[b])&&h[Dv[b]].apply(h,e)}};t.Ss=function(b,c,d){for(var e=this.mj[b],g=z.slice(arguments,1),h=0;h<e.length;++h){var l=e[h];if(l.isEnabled(this)||Ev[b])g[0]=l[Dv[b]].apply(l,g)}return g[0]};
a.aw=function(b,c,d){var e={},b=b.Ss(8,c||"",e);Uf(d,e);d.innerHTML=b};t.Ze=function(b){(B||Xv(this,b))&&!this.Ln(1,b)&&hr&&bw(this,b)};t.HM=function(b){if(B){if(!Xv(this,b))return}else this.xw=j,this.uh();!this.Ln(2,b)&&!hr&&bw(this,b)};t.IM=function(b){!B&&(this.xw||Uv(b))&&this.un();this.Ln(3,b);cw(this,"selectionchange")||(Yv[b.keyCode]||(b.ctrlKey||b.metaKey)&&Zv[b.keyCode])&&this.YG.start()};
a.bw=function(b,c){if(!c.altKey){var d=kb?c.metaKey:c.ctrlKey;if(d||$v[c.keyCode]){var e=c.charCode||c.keyCode;17!=e&&b.Ln(5,c,String.fromCharCode(e).toLowerCase(),d)&&c.preventDefault()}}};t.execCommand=function(b,c){for(var d=arguments,e,g=this.mj[6],h=0;h<g.length;++h){var l=g[h];if(l.isEnabled(this)&&l.we(b)){e=l.execCommand.apply(l,d);break}}return e};
t.queryCommandValue=function(b){var c=this.Od()&&this.bf;if(oa(b))return this.Qs(b,c);for(var d={},e=0;e<b.length;e++)d[b[e]]=this.Qs(b[e],c);return d};t.Qs=function(b,c){for(var d=this.mj[7],e=0;e<d.length;++e){var g=d[e];if(g.isEnabled(this)&&g.we(b)&&(c||g.Np()))return g.queryCommandValue(b)}return c?k:m};t.wD=function(b,c){if(!cw(this,Kv)){var d=c.Tb;try{if(d.originalTarget.prefix||"scrollbar"==d.originalTarget.nodeName)return}catch(e){return}d.prevValue!=d.newValue&&b.call(this,d)}};
t.Mw=function(b){cw(this,Kv)||(b=b.gD?b.Tb:b,b.target.firebugIgnore||(this.sx=this.Zr=j,this.ge.start()))};t.qr=function(){A&&this.execCommand("clearlorem",j);B&&this.zv();this.Re()};a.dw=function(b){var c;return b.lc()&&(c=b.gb)?(b=c.Oa())&&b.frameElement:k},a.ew=function(b){return(b=b.gb&&b.gb.Oa())&&Rq(b)},a.Gv=function(b,c,d){if(!cw(b,"selectionchange")){var e=ew(b),e=e&&e.Bb();b.bf=!!e&&sc(b.m(),e);b.dispatchEvent("cvc");b.dispatchEvent({type:"selectionchange",OX:c&&c.type});b.Ln(4,c,d)}};
t.aN=function(){var b=this.XG;this.XG=k;Gv(this,i,b)};t.uh=function(){cw(this,"beforechange")||this.dispatchEvent("beforechange")};a.Fv=function(b,c,d){c&&(b.ge&&at(b.ge),b.bk[Kv]=1);d&&(fw(b),b.bk[Lv]=1)},a.gw=function(b,c,d){!c&&b.ge&&at(b.ge);b.bk[Kv]=0;b.bk[Lv]=0;c&&b.un();d&&b.xC()},a.cw=function(b,c){return!!b.bk[c]||b.Hq[c]&&500>=za()-b.Hq[c]};t.Re=function(b){gw(this,j,b)};t.un=function(){cw(this,Kv)||(this.ge&&this.ge.stop(),this.sx=this.Zr=j,cw(this,Lv)||this.Jq.start())};
t.xC=function(){cw(this,Lv)||(this.Jq.stop(),this.Zr=m,this.dispatchEvent(Lv))};a.fw=function(b){b.ge&&at(b.ge);at(b.Jq)};t.zv=function(){this.wC();this.yC()};t.wC=function(){cw(this,"beforefocus")||(this.execCommand("clearlorem",j),this.dispatchEvent("beforefocus"))};t.yC=function(){if(!cw(this,"focus")){Rv=this.id;this.bf=j;this.dispatchEvent("focus");if(B){var b=this.m(),c=ew(this);if(c){var d=dq(c);0==eq(c)&&(!d||d==b||"BODY"==d.tagName)&&zt(b)}}!Zq&&this.lc()&&this.gb.Oa().parent.getSelection().removeAllRanges()}};
t.Mq=function(){cw(this,"blur")||(Rv==this.id&&(Rv=k),this.bf=m,this.dispatchEvent("blur"))};a.hw=function(b){Ic(b.target,"A")&&b.preventDefault()};t.dj=function(b){Rv=this.id;if(A){var c=b.target;c&&("A"==c.tagName&&b.ctrlKey)&&this.Nl.Oa().open(c.href)}this.St=j};t.Dw=function(){this.St=m};t.CD=function(b){if(!this.UH||this.St)this.St=m,Gv(this,b),A&&(this.XG=b.target,this.YG.start())};t.OM=function(b){Gv(this,b)};
t.hl=function(){if(this.queryCommandValue("usinglorem"))return" ";if(!this.Od()){var b=this.Hc;b||this.Ib.log(ae,"Couldn't get the field element to read the contents",i);return b.innerHTML}var c=this.m(),b=c.cloneNode(m),c=c.innerHTML;A&&c.match(/^\s*<script/i)&&(c=" "+c);b.innerHTML=c;this.dO(11,b);return this.Ss(10,b.innerHTML)};
t.yd=function(b,c,d,e){if(1==this.zj)this.Ib.log(be,"Can't set html while loading Trogedit",i);else{e&&this.execCommand("clearlorem");c&&b&&(c="<p>"+c+"</p>");d&&Fv(this,m,j);b=c;if(c=this.m()){if(this.lc()&&C)for(var g=c.ownerDocument.getElementsByTagName("HEAD"),h=g.length-1;1<=h;--h)g[h].parentNode.removeChild(g[h])}else c=this.Hc;c&&aw(this,b,c);e&&this.execCommand("updatelorem");this.Od()&&(d?(B&&at(this.ge),gw(this)):this.Re())}};
t.gA=function(){var b=this.gb.Ba();b.designMode="on";dr&&b.execCommand("styleWithCSS",m,m)};t.sE=function(){this.Lk&&iw(this)&&hu(this.Lk,this.m())};t.Od=function(){return 2==this.zj};t.focus=function(){if(!Bt&&this.lc())this.gb.Oa().focus();else{if(rb)var b=this.zk.pageXOffset,c=this.zk.pageYOffset;this.m().focus();rb&&this.zk.scrollTo(b,c)}};t.Hf=function(){(Wq||C)&&jw(this);this.focus()};a.jw=function(b){var c=b.m();if(c){var d=qt(c);c==d?Tq(c,0).select():Xs(d,j);Gv(b)}};
t.ze=function(b){this.zj=1;var c=this.Hc;this.nodeName=c.nodeName;this.bY=c.className;this.cssText=c.style.cssText;c.className+=" editable";this.Rx(b)};t.Rx=function(b){var c=this.Hc;if(c){var c=c.innerHTML,d={},c=this.Ss(8,c,d),e=this.Nl.v("IFRAME",this.oD());if(iw(this)){var g=v(this.fE,this,e,c,d);this.cl=O(e,"load",g,j);b&&(e.src=b)}this.pB(e);iw(this)||this.fE(e,c,d)}};
t.rr=function(){A&&Ct(this.gb.Oa());Rv!=this.id&&this.execCommand("updatelorem");if((Ng||Og)&&this.lc()&&this.hH()){var b=this.gb.Oa();this.Lm=v(b.focus,b);b.addEventListener("keydown",this.Lm,m);b.addEventListener("touchend",this.Lm,m)}rb&&this.lc()?(this.Ku=v(this.zv,this),this.Ju=v(this.Mq,this),b=this.gb.Oa(),b.addEventListener("focus",this.Ku,m),b.addEventListener("blur",this.Ju,m)):(gr?(this.addListener("focus",this.yC),this.addListener(id,this.wC)):this.addListener("focus",this.zv),this.addListener("blur",
this.Mq,B));if(B)this.uz();else{this.addListener(["beforecut","beforepaste","drop","dragend"],this.uh);var c=this.Re,d;d=d||0;this.addListener(["cut","paste"],function(){return c.apply(this,Array.prototype.slice.call(arguments,0,d))});this.addListener("drop",this.qr)}this.addListener(C?"dragend":"dragdrop",this.qr);this.addListener("keydown",this.Ze);this.addListener("keypress",this.HM);this.addListener("keyup",this.IM);this.YG=new xj(this.aN,250,this);er&&this.addListener("click",hw);this.addListener("mousedown",
this.dj);this.UH?(this.dc.e(this.gb.Ba(),"mouseup",this.CD),this.addListener("dragstart",this.Dw)):this.addListener("mouseup",this.CD);this.addListener("mouseover",this.OM);this.sE();gw(this);this.Ib.info("Dispatching load "+this.id);this.dispatchEvent("load");for(var e in this.jd)this.jd[e].enable(this)};a.iw=function(b){if(!la(b.vx)&&(b.vx=m,A&&b.lc())){for(var c=b.Nl.Oa();c!=c.parent;)try{c=c.parent}catch(d){break}c=c.location;b.vx="https:"==c.protocol&&-1==c.search.indexOf("nocheckhttps")}return b.vx};
t.pB=function(b){var c=this.Hc;b.className=c.className;b.id=c.id;mc(b,c)};t.mw=function(b){var c=Kc(Sb(this.Hc));return new Hv(this.id,c,m,m,b)};t.iI=function(b,c,d){d=this.mw(d);iw(this)?(b=(b.contentDocument||b.contentWindow.document).body,Bt&&(b.contentEditable=j),b.className="editable",b.setAttribute("g_editable",j),b.hideFocus=j,b.id=d.RC,Uf(b,d.Sv),b.innerHTML=c):Jv(d,c,new Iv(this.m(),this.Lk),b)};
t.fE=function(b,c,d){this.cl&&(zd(this.cl),this.cl=k);b.gW="true";this.iI(b,c,d);Vv(this,(b.contentDocument||b.contentWindow.document).body);!Bt&&this.lc()&&this.gA();this.rr()};t.oD=function(){var b="padding:0;"+this.Hc.style.cssText;Fa(b,";")||(b+=";");b+="background-color:white;";A&&(b+="overflow:visible;");return{frameBorder:0,style:b}};a.kw=function(b,c){Qv.call(this,b,c)},a.lw=void 0;y(kw,Qv);t=kw.prototype;t.Ib=ke("goog.editor.SeamlessField");t.zE=m;t.iO=m;t.Nn=p("zE");t.GD=function(){cw(this,Kv)||mw(this)};
t.Iz=function(){if(this.Vo?0:this.Vo=j){var b=m,c=dw(this);if(c){var d,e=dw(this),g=e.contentDocument.body;d=g.parentNode;0===parseInt(iu(e,"height"),10)&&Uf(e,"height","1px");if(Kc(Sb(g)))e=d.offsetHeight;else if(e=d.scrollHeight,d.clientHeight!=d.offsetHeight){d=e;if(!(e=lw))e=document.createElement("div"),e.style.cssText="overflow:auto;position:absolute;top:0;width:100px;height:100px",g=document.createElement("div"),ng(g,"200px","200px"),e.appendChild(g),document.body.appendChild(e),g=e.offsetWidth-
e.clientWidth,M(e),e=lw=g;e=d+e}d=e;this.UO&&(d=Math.max(d,this.UO));parseInt(iu(c,"height"),10)!=d&&(c.style.height=d+"px",b=j)}this.Vo=m;b&&this.dispatchEvent("ifrsz")}};
a.mw=function(b){if(b.Vo?0:b.Vo=j){var c=dw(b),d=b.m(),e=m;if(c&&d){var g,h=c.parentNode,l=h.offsetWidth;parseInt(iu(c,"width"),10)!=l&&(g=yg(d),c.style.width=l+"px",d.style.width=l-g.left-g.right+"px",e=j);h=h.offsetHeight;b.Nn()&&parseInt(iu(c,"height"),10)!=h&&(g||(g=yg(d)),c.style.height=h+"px",d.style.height=h-g.top-g.bottom+"px",e=j)}b.Vo=m;e&&b.dispatchEvent("ifrsz")}},a.nw=function(b){b.m()&&(mw(b),b.Nn()||b.Iz())};t.Ww="";a.ow=m;t=kw.prototype;t.lc=function(){return!Bt};
t.uz=function(){kw.n.uz.call(this);if(this.lc()){var b=dw(this).ownerDocument;this.dc.e(b,Wv,this.GD,j);this.CO=wd(this.gb.Oa(),"load",this.Iz,j,this);this.dc.e(b,"DOMAttrModified",v(this.wD,this,this.GD),j)}};t.un=function(){cw(this,Kv)||(kw.n.un.call(this),this.lc()&&this.Iz())};
t.Mq=function(){if(!cw(this,"blur")&&(kw.n.Mq.call(this),!Bt&&!Zq)){var b=this.gb.Oa(),c=m;zd(this.SE);this.SE=wd(b.document.body,"dragover",function(){c=j});fa.setTimeout(v(function(){if(!c&&this.gb){var b=ew(this),e=this.gb.Oa();Ct(e);b&&(b.collapse(j),b.select())}},this),0)}};t.gA=function(){kw.n.gA.call(this);var b=this.gb.Ba();b.execCommand("enableInlineTableEditing",m,"false");b.execCommand("enableObjectResizing",m,"false")};
t.sE=function(){!this.lc()&&!ow&&(this.Lk&&hu(this.Lk,this.m()),ow=j)};t.Rx=function(b){if(this.lc())kw.n.Rx.call(this,b);else if(b=this.Hc)Vv(this,b),b.contentEditable=j,aw(this,b.innerHTML,b),this.rr()};t.rr=function(){if(this.lc()){var b=this;fa.setTimeout(function(){nw(b)},0)}kw.n.rr.call(this)};t.oD=function(){return{frameBorder:0,style:"padding:0;"}};
t.pB=function(b){if(!this.iO){var c=this.Hc;c&&(this.zE="auto"==Yf(c,"overflowY"))}var c=this.Hc,d=Sb(c),e=c.style.width,g=c.style.height;Uf(c,"visibility","hidden");var d=d.v("DIV",{style:"height:0;clear:both",innerHTML:"&nbsp;"}),h=d.cloneNode(j);c.insertBefore(d,c.firstChild);c.appendChild(h);var h=gu(c),d=h.width,h=h.height,l="";this.Nn()&&(l="&nbsp;",Uf(c,"position","relative"),Uf(c,"overflow","visible"),Uf(b,"position","absolute"),Uf(b,"top","0"),Uf(b,"left","0"));ng(c,d,h);Kc(Sb(c))&&(this.NX=
c.style.lineHeight,Uf(c,"lineHeight","0"));c.innerHTML=l;ng(b,d,h);ng(c,e,g);Uf(c,"visibility","");c.appendChild(b);iw(this)||(c=b.contentWindow.document,Kc(Sb(b.ownerDocument))&&(c.open(),c.write("<!DOCTYPE HTML><html></html>"),c.close()))};t.mw=function(b){var c=this.Hc;if(c)return new Hv(this.id,Kc(Sb(c)),j,this.Nn(),b);f(Error("no field"))};
t.iI=function(b,c,d){Uf(b,"visibility","hidden");var d=this.mw(d),e=this.Hc,g=this.Lk;if(!this.Ww){var h=this.Hc;if(h){var l=h.ownerDocument,n=ua(l);if(!zv[n]){for(var q=ua(l),r=[],l=ov(l.styleSheets),w=0,F;F=l[w];w++)if((F=nv(F))&&F.length)for(var I=0,G=F.length;I<G;I++){var Q=new qv,W;W=Q;var ja=F[I],Ja=ja.style;if(Ja){var Na=i,Ra=i;Ja&&(Na=ja.selectorText)&&(Ra=Ja.cssText)?A&&(Ra+="/* */"):ja.cssText&&(Ra=/([^\{]+)\{/,Na=Ra.exec(ja.cssText)[1],Ra=ja.cssText.replace(Ra,"").replace(/\}[^\}]*$/g,
""));if(Na){ja=W;ja.Rg=[];Na=Na.split(/,\s*/gm);for(Ja=0;Ja<Na.length;Ja++){var me=Na[Ja];0<me.length&&ja.Rg.push(new uv(me))}W.an=Ra;W=j}else W=m}else W=m;W&&r.push(Q)}zv[q]=r}q=zv[n];n=[];for(r=0;r<q.length;r++)n.push(q[r].clone());l=new yv(h);w=new tv("body");for(q=0;q<n.length;q++){F=n[q].Rg;r=F.length;for(I=0;I<r;I++){G=F[I];Q=G;W=l.uid;if(Q.zu[W])W=Q.zu[W];else{for(var Ra=0,Ja=Na=ja=k,me=l.DF,LD=me.length,Sj=0;Sj<=Q.Wh.length;Sj++){for(Na=Q.Wh[Sj];Ra<LD;){var sx=me[Ra];if(Na&&wv(Na,sx)){ja=
{GC:Ra,ZG:Sj};Ra++;break}else Ja&&wv(Ja,sx)&&(ja={GC:Ra,ZG:Sj-1});Ra++}Ja=Na}W=Q.zu[W]=ja}W&&(Q=W.ZG,G=G.Wh,Ra=G.length-1,W.GC==l.DF.length-1||Q<Ra?(G=G.concat(),G.splice(0,Q+1,w),Q=new uv,Q.Wh=G,F.push(Q)):0<Q&&Q==Ra&&(Q=new uv,Q.Wh=[w,G[Ra]],F.push(Q)))}}l=new qv;h=h.currentStyle||Rb(h).defaultView.getComputedStyle(h,"")||{};q=new uv;q.Wh=[new tv("html")];l.Rg=[q];w={};for(q=0;r=Av[q];q++)w[r]=h[eb(r)];rv(l,w);n.push(l);l=new qv;w=new uv;w.Wh=[new tv("body")];F={position:"relative",top:"0",left:"0",
right:"auto",display:"block",visibility:"visible"};for(q=0;r=Bv[q];q++)F[r]=h[eb(r)];rv(l,F,j);l.Rg=[w];n.push(l);h=[];r=n.length;for(q=0;q<r;q++){F=n[q];l=h;I=F.Rg.length;w=m;for(G=0;G<I;G++){Q=F.Rg[G].Wh;W=Q.length;for(Ra=0;Ra<W;Ra++)l.push(Q[Ra].qE," ");G<I-1&&l.push(",");B&&!D("1.9a")&&(w=w||pv.test(Q[W-1].qE))}F=F.an;w&&(F=F.replace(sv,"$1 color: $2 ! important; "));l.push("{",F,"}\n")}this.Ww=h.join("")}}e=new Iv(e,g+this.Ww);d.gq&&(g=yg(e.GT),(g.top||g.left||g.right||g.bottom)&&Uf(b,"margin",
-g.top+"px "+-g.right+"px "+-g.bottom+"px "+-g.left+"px"));Jv(d,c,e,b);nw(this);Uf(b,"visibility","visible")};t.Zu=function(){zd(this.SE);zd(this.CO);kw.n.Zu.call(this)};a.pw={};pw._default_={qw:function(b){return $.get("/node/CommentV2",{params:{comment_id:b}})},il:ju,jl:ju,add:function(b){return $.post("/node/AnswerCommentAddV2",{method:"add_comment",params:b})},remove:function(b){return $.post("/node/CommentV2",{method:"remove_comment",params:{comment_id:b}})},Lx:function(b,c){return $.post("/node/CommentV2",{method:c?"like_comment":"undo_like_comment",params:{comment_id:b}})}};
pw.answer={il:function(b,c){return $.get("/node/AnswerCommentBoxV2",{params:{answer_id:b,load_all:c}})},jl:function(b){return $.get("/node/AnswerCommentListV2",{params:{answer_id:b}})},add:function(b){return $.post("/node/AnswerCommentAddV2",{method:"add_comment",params:b})},JJ:function(b,c){return $.post("/node/AnswerCommentV2",{method:"author_remove_comment",params:{comment_id:b,is_block:c}})}};
pw.question={il:function(b){return $.get("/node/QuestionCommentBoxV2",{params:{question_id:b}})},jl:function(b){return $.get("/node/QuestionCommentListV2",{params:{question_id:b}})},add:function(b){return $.post("/node/QuestionCommentAddV2",{method:"add_comment",params:b})}};
pw.favlist={il:function(b){return $.get("/node/FavlistCommentBoxV2",{params:{favlist_id:b}})},jl:function(b){return $.get("/node/FavlistCommentListV2",{params:{favlist_id:b}})},add:function(b){return $.post("/node/FavlistCommentAddV2",{method:"add_comment",params:b})}};
pw.post={qw:function(b){return $.get("/node/PostCommentV2",{params:{comment_id:b}})},il:function(b,c){return $.get("/node/PostCommentBoxV2",{params:{post_id:b,load_all:c}})},jl:function(b){return $.get("/node/PostCommentListV2",{params:{post_id:b}})},add:function(b){return $.post("/node/PostCommentV2",{method:"add_comment",params:b})},Lx:function(b,c){return $.post("/node/PostCommentV2",{method:c?"like_comment":"undo_like_comment",params:{comment_id:b}})},remove:function(b){return $.post("/node/PostCommentV2",
{method:"remove_comment",params:{comment_id:b}})}};
pw.roundtable={qw:function(b){return $.get("/roundtable/comments/"+b)},il:function(b,c){return $.get("/node/RoundtableCommentBoxV2",{params:{roundtable_id:b,load_all:c}})},jl:function(b){return $.get("/roundtable/comments",{roundtable_id:b})},add:function(b){return $.post("/node/RoundtableCommentV2",{method:"add_comment",params:b})},Lx:function(b,c){return $.post("/node/RoundtableCommentV2",{method:c?"like_comment":"undo_like_comment",params:{comment_id:b}})},remove:function(b){return $.post("/node/RoundtableCommentV2",
{method:"remove_comment",params:{comment_id:b}})}};a.rw=function(b,c){var d=b.split("!");this.type=d[0]+"!";this.namespace=d[1];this.xc=new qw(c)};y(rw,gd);a.qw=function(b){this.category=b.category;this.action=b.action;this.label=b.label;this.value=b.value};qw.prototype.fill=function(b,c){this[b]=this[b].replace("?",c);return this};a.sw=function(){N.call(this)};y(sw,yu);a.tw=function(b,c,d){$.post(b,c).done(function(b){if(b.r)U(b.msg);else{var c=b.msg;(c=c&&c.redirect)?window.location.href=c:(U("操作成功！"),d&&d(b))}})},a.uw=void 0,a.vw=Uj($.getJSON);uw=function(b,c){return vw(Ga("/manage/%s/options?action=%s",b,c))};t=sw.prototype;t.GA={remove:"删除",lock:"锁定",unlock:"解除锁定",collapse:"折叠",uncollapse:"解除折叠",mute:"隔离",unmute:"解除隔离"};t.qD=function(b){return uw(b,this.gl())};
t.Ou=function(){var b=sw.n.Ou.call(this);b.mc.set("ok",this.GA[this.gl()]);return b};t.gl=function(){return $(this.Nu).data("op").split("-")[0]};t.jD=function(b){return Ga("确定要%s该%s？",this.GA[this.gl()],this.RA[b]||"条目")};t.bH=function(b){$(".footnote",this.lw().m()).text(b)};t.FD=function(b){b&&(b.trackable?(b=$.extend({action:"get_member_info",reason:b.value},this.Kv),$.post("/manage",b).then(function(b){return Ga("用户已被警告 %s 次，禁言 %s 次",b.warn_num,b.ban_num)}).then(v(this.bH,this))):this.bH(""))};
sw.prototype.submit=function(){var b=$(this.Nu).data(),c=b.action,b=b.content,d=$($("form",this.bn.m())[0]).serialize();b&&(d+="&"+b);tw(c,d,this.Gk)};sw.prototype.w=function(){this.Gk=this.Nu=k;sw.n.w.call(this)};sw.prototype.open=function(b,c,d){this.Nu=b;this.Gk=d||ea.IX;sw.n.open.call(this,c.type,c.id,"")};a.ww=function(b){T.call(this);H.extend(this.F={},this.defaults,b||{});this.vk=new Nd;this.uf=k};y(ww,T);t=ww.prototype;t.defaults={trigger:{A:"data-editable"},bJ:"hc-actionbar",uO:"checked",mS:100,vN:100};
t.B=function(){ww.n.B.call(this);this.Gm=L("div");document.body.appendChild(this.Gm);var b=this.F,c=new to(b.trigger,m,k,this.g);c.tt=b.mS;c.Cr=b.vN;c.Sg(this.Gm);O(c,"trigger",function(b){c.Vc(new $n(b.anchor,1))});O(c,"beforeshow",function(b){this.uf=b.target.anchor;this.W()},m,this);c.className=b.bJ;this.AN=c};t.ow=p("AN");
a.xw=function(b,c){var d=b.F.uO,e=oc(b.Gm),g=z.find(e,function(b){return b.getAttribute("data-action")===c});if(!g||E.has(g,d))return m;z.forEach(e,function(b){E.remove(b,d)});E.add(g,d);return j};t.ZJ=function(b,c,d){c=L("div",{title:b.Q,"data-action":b.name,className:"button "+b.name+(0===c?" first":c===d.length-1?" last":"")},[L("i","icon icon-actionbar-"+b.name)]);ug(c,j);this.h().e(c,"click",function(){xw(this,b.name)&&b.Fk(this.uf)});return c};
t.W=function(){this.Gm.innerHTML="";hc(this.Gm,z.map(H.Ka(this.vk.Jt()),this.ZJ,this))};a.yw=function(b){T.call(this);H.extend(this.F={},this.defaults,b||{})};y(yw,T);yw.prototype.defaults={WD:{},GJ:j};
yw.prototype.B=function(){yw.n.B.call(this);var b=this,c=this.g;if(this.F.GJ){var d=new ww({});d.vk.set("link",{name:"link",Q:"链接",Fk:function(b){xc(b,b.href)}||ha});d.vk.set("text",{name:"text",Q:"文本",Fk:function(b){xc(b,b.getAttribute("data-title"))}||ha});d.o(c);var e=d.ow();Ys(e,new Pf(2,0,0,0));e.xl=new Pf(2,0,0,0)||k;var g=d.h();g.e(e,"beforeshow",function(b){var b=b.target.anchor,c=Fc(b);c===b.href?xw(d,"link"):(c!==b.getAttribute("data-title")&&b.setAttribute("data-title",c),xw(d,"text"))}).e(e,
"beforehide",function(b){if((b=b.target)&&c.contains(b)&&zw(b))return m});var h;g.e(e,"show",function(b){h=b.target.anchor;E.add(h,"hover")}).e(e,"hide",function(){h&&(E.remove(h,"hover"),h=k)});this.Mp=d}this.h().e(c,"paste",function(){setTimeout(function(){var c=b.F,d=b.g,e=zc(d,function(b){return 3===b.nodeType&&!Aw(b,d,function(b){return zw(b)||"CODE"===b.nodeName||"PRE"===b.nodeName})}),g,h=Rq(),F=h&&cq(h);z.forEach(e,function(b){var c=b.nodeValue,d=c.replace(Bw,function(b){Ea(b,"http")||(b=
"http://"+b);return b.link(b)});d!==c&&(c=fc(d),F===b&&(g=c.lastChild),mc(c,b))});g&&Xs(g);var I=c.WD,c=z.filter(d.getElementsByTagName("A"),function(b){var c=b.getAttribute("href");if(c=!(!c||"#"===c))if(c=!b.getAttribute("data-editable"))if(c=z.contains(Cw,b.protocol))c=Fc(b),Ea(b.href,c)?b=i:(b.setAttribute("data-editable",j),b.setAttribute("data-title",c),b=j),c=!b;return c}),c=z.map(c,function(b){return Dw(b.href).done(function(c){var e=I;if(c&&d.contains(b)){var e=e||{},g=function(b,c,d){var e=
Rq();if(e){var g=e.U(),h=e.sa(),l=e.fa(),n=e.Ha();sc(c,g)&&(g=b,h=0);sc(c,l)&&(l=b,n=0);d(function(){g===b&&l===b?Xs(b):Dq(g,h,l,n).select()})}else d(ha)},h={link:function(b,c){b.setAttribute("data-editable",j);c.title===b.href?b.setAttribute("data-title",b.hostname.split(".").slice(/(.com|.edu|.gov|.net|.org)$/.test(b.hostname)?-2:-3).join(".").replace(/^www\./,"")+" 的页面"):(b.setAttribute("data-title",c.title),g(b,b,function(d){xc(b,c.title);d()}))},image:function(b,c){var d=document.createElement("img");
d.src=c.src;d.setAttribute("data-rawwidth",c.width);d.setAttribute("data-rawheight",c.height);g(d,b,function(c){mc(d,b);c()})}};(e=e[c.type]||h[c.type])&&e(b,c)}})});c.length&&(b.dispatchEvent("willScrape"),$.when.apply($,c).always(function(){b.dispatchEvent("didScrape")}))})}).e(c,"keydown",this.pN)};
yw.prototype.pN=function(b){var c=th(b.keyCode),d=8===b.keyCode;if(!(b.ctrlKey||(b.altKey||b.metaKey)||!c&&!d)){var c=Rq(),e=c.U(),g=c.fa(),h=this.g,l,n=Aw(e,h,zw)||g!==e&&(l||(l=Aw(g,h,zw)));if(n){var q=Fc(n),r=c.sa(),w=c.Ha();if(n.getAttribute("data-editable")&&q===n.href){var F=m;l=l||Aw(g,h,zw)||n;var h=n.contains(e),I=l.contains(g);if(d)h&&(e=n,r=0,F=j),I&&(g=l,w=Qs(l),F=j),F&&Dq(e,r,g,w).select();else if(h&&I&&l===n){if(!c.isCollapsed()||!(0===r||q.length===r))b.preventDefault(),Xs(n)}else h&&
(e=n.nextSibling,r=0,F=j),I&&(g=l.previousSibling,w=Qs(g),F=j),F&&Dq(e,r,g,w).select()}}}};a.Bw=/\b(?:(?:https?):\/\/|www\.)(?:\([\-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[\-A-Z0-9+&@#\/%=~_|$?!:,.])*(?:\([\-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[A-Z0-9+&@#\/%=~_|$])/ig,a.Cw=["http:","https:"],a.Aw=function(b,c,d){for(;b&&b!==c;){if(d(b))return b;b=b.parentNode}},a.zw=function(b){return"A"===b.nodeName},a.Dw=Uj(function(b){return $.post("/scraper",{url:b})});a.Ew=function(b,c,d){T.call(this);this.id=b;this.type=c;this.field=k;this.qd=this.Vf=m;this.Sd="写下你的评论…";this.placeholder='<p style="color:#999">'+this.Sd+"</p>";this.Cl="";this.ea=-1;this.ZE=$.Deferred().resolve();this.Py=this.os=k;this.MB="zm-comment-box";this.dh=k;(b=pw[c])||f(Error("API not found"));this.Bi=$.extend({},pw._default_,b);H.extend(this.F={},this.defaults,d||{})};y(Ew,T);t=Ew.prototype;t.defaults={WE:m,autofocus:j,Dv:"empty",xe:"zm-item-comment"};
t.ca=function(b){Ew.n.ca.call(this,b);Fw(this);Gw(this);this.qd=j;z.forEach(Hw(this),this.oy,this)};a.Iw=function(b,c,d){var e=K(b.MB,c);d&&(b.dh=d);e?b.o(e):(b.Vf=j,b.W(c))};t.EJ="zm-comment-bubble";t.lB="."+Ew.prototype.EJ;t.Xt=function(b){return $(b,this.g)};t.v=function(){this.g=L("div",{"class":this.MB,style:"display:none"});this.Te()};t.Ii=s('<i class="icon icon-spike zm-comment-bubble"></i><div class="zm-comment-spinner">正在加载，请稍等 <i class="spinner-lightgray"></i></div>');
t.w=function(){Ew.n.w.call(this);this.field=this.QB=this.Vm=this.dB=this.dh=this.Py=this.XE=k};a.Jw=function(b){var c=b.Wk,d=c.m();if(c.hl()!==b.placeholder){c.yd(m,b.placeholder);var e=["click","focus","keydown"],g=function(){c.yd(m,this.Cl||"");this.field.lastChild?Xs(this.field.lastChild):c.Hf();xd(d,e,g,m,this)};O(d,e,g,m,b);var h;window.getSelection?(h=window.getSelection(),h.anchorNode&&sc(b.field,h.anchorNode)&&h.removeAllRanges()):document.selection&&b.field.blur()}};
t.Sr=function(b){(b=b.m&&b.m())&&(new yw({WD:{image:ha}})).o(b)};t.Rr=function(b,c){if(b.m){var d=(new jj).add("type",this.type+"_comment").add("resource_id",this.id),e=b.m();this.BX=d=new Ir(e,{ym:{source:"/people/autocomplete?"+d.toString()},Kj:K("zu-main")||document.body});new Er(e,{az:Kr});qa(c)&&c(d)}};
t.qS=sn(function(b){var c=K("zm-comment-content-wrap",b),d=K("zm-comment-form",b),e=b.getAttribute("data-id"),g=this,h;if(d){h=K("zm-comment-editable",d);if(sg(d)){if(mt(d))return R(d,m)}else R(d,j);Kw(h)}else{(b=K("zm-comment-reply-hack"))?(b=fc(Us(b)),E.qu(b,"zm-comment-reply-hack","zm-comment-reply-hacked"),kc(b,c)):(b="",S.ua()&&(b='<img class="avatar" src="'+S.ML()+'">'),b=fc('<div class="zm-comment-form expanded"><div class="zm-comment-editable-wrap">'+b+'<div class="zm-comment-editable" aria-label="写下你的回复"></div></div><div class="zm-command zg-clear"><a href="javascript:;" class="zm-comment-submit zg-right zg-btn-blue">评论</a><a href="javascript:;" class="zm-comment-close zm-command-cancel">取消</a></div></div>'),
c.appendChild(b));d=b;h=K("zm-comment-editable",d);var l=new kw(h);l.yd(m,"");l.ze();this.Rr(l,function(){Kw(h)});this.Sr(l);c=K("zm-comment-close",d);b=K("zm-comment-submit",d);b.name="";var n=function(){var b=Ma(l.hl()),c=Ma(Fc(h));b&&c?Lw(g,{content:b,zR:e},function(b){b.r||(R(d,m),l.yd(m,""),(b=z.Qd(Hw(g)))&&tt(b,{offsetTop:100,iB:j}))}):(U("请填写内容"),h.focus())};O(c,"click",function(){R(d,m)});O(b,"click",n);O(h,"keydown",function(b){if(13===b.keyCode&&(b.ctrlKey||b.metaKey))n(),b.preventDefault()})}tt(d,
100)},function(){return{ua:{question:"question_comment_reply",answer:"question_answer_comment_reply"}[this.type]||j,lg:j}});a.Kw=function(b){b.focus();b=fq(b);b.collapse();b.select()},a.Gw=function(b){var c=location.hash.slice(1).split("-"),d="comment"===c[0]&&c[1];d&&(b=z.find(Hw(b),function(b){return b.getAttribute("data-id")===d}),Fk(b),tt(b))},a.Hw=function(b){return $(b.Vm).children(".zm-item-comment").get()};t.st=function(b){E.enable(this.QB,"expanded",b)};
t.mi=function(b,c){this.dispatchEvent(new rw("click!comment",{category:"?",action:this.type+"_comments",label:"?_"+b,value:pa(c)?c:this.Ra()}))};t.cj=function(){this.qd?Mw(this):this.Vf=j};t.MP=function(b){if(13===b.keyCode&&(b.ctrlKey||b.metaKey))this.Op(),$(this.field).blur(),b.preventDefault();27===b.keyCode&&Nw(this)};
t.ra=function(b){var c=Jk(this.g,b.target,"BUTTON")||Jk(this.g,b.target);if(c&&c.name){var d=Ic(c,k,this.F.xe);b.preventDefault();switch(c.name){case "reply_comment":this.qS(d);break;case "cancelanon":b=$(this.g).parents(".feed-item-hook").data("qid");ct(0,k,b);break;case "delcomment":this.or(c);break;case "like_comment":this.KM(c);break;case "author_delcomment":var e=this,g=Ic(c,k,this.F.xe),h=g.getAttribute("data-id"),b=$(".zm-item-link-avatar",g).prop("href");$.get(b+"/block",function(b){var c=
Ci("删除评论","你确定要删除这条评论吗？"+('<p style="margin-top: 0.2em;color:#999;'+(b.r||b.msg?"display:none":"")+'"><label><input type="checkbox">同时将此人屏蔽</label></p>'),function(b){if(b){var b=$(":checkbox",c.m()).prop("checked"),d=xa(M,g);e.Bi.JJ(h,Number(b)).done(v(function(){qa(d)&&d();this.ea-=1;Ow(this)},e))}},e)});break;case "admin_delcomment":var l=Ic(c,k,this.F.xe);(new sw).open(c,{id:l.getAttribute("data-id"),type:"comment"},v(function(){M(l);this.ea-=1;Ow(this)},this));break;case "closeform":Nw(this);
break;case "report":this.ur(c);b.stopPropagation();break;case "addnew":this.Op();break;case "load-more":this.mi("comments_all"),this.XE(c)}}};
t.XE=function(b){this.os&&"pending"===this.os.state()||(b&&E.add(b,"loading"),this.os=this.Py||this.YE(),this.os.done(v(function(c){c=$(c).filter(".zm-item-comment").get();if(c.length){var d=Hw(this);d.length&&(c=z.filter(c,function(b){return!z.find(d,function(c){return c.getAttribute("data-id")===b.getAttribute("data-id")})}),c=z.concat(d,c).sort(function(b,c){return b.getAttribute("data-id")-c.getAttribute("data-id")}),z.forEach(c,this.nB,this),b&&M(b));hc(this.Vm,c)}},this)))};
t.KM=sn(function(b){var c=$(b),d=Ic(b,k,this.F.xe),b=$(".like-num",d),e=d.getAttribute("data-id");(d=!c.hasClass("liked"))&&this.mi("like_comment");this.Bi.Lx(e,d);var e=$("em",b),g=+e.text()+(d?1:-1);b.toggleClass("liked",d).toggleClass("nil",0>=g).attr("data-tip","s$r$"+g+" 人觉得这个很赞");e.text(g);c.toggleClass("liked",d);yk(c[0],d?"取消赞":"赞")},j);a.Nw=function(b){0<b.Ra()?(b.Cl=b.$a(),b.st(m),Jw(b)):b.dh?b.collapse():b.st();b.Af()};t.expand=function(){this.Ja(j)};t.collapse=function(){this.Ja(m)};
t.fc=p("qd");t.Ja=function(b){if(b!==this.qd){b&&(this.Xt(this.lB).hide(),this.Te());this.qd=b;this.dispatchEvent(b?"beforeexpand":"beforecollapse");R(this.g,this.qd);var c=v(function(){b&&Pw(this);this.dispatchEvent(b?"expand":"collapse");this.el&&!b&&(Ar(this.el),tt(this.el.g))},this),d;b&&this.Vf?(d=Mw(this))&&d.done(c):setTimeout(c);this.dh&&(b?(this.GQ=Fc(this.dh),yk(this.dh,"收起评论")):yk(this.dh,0>this.ea?this.GQ:this.ea?this.ea+" 条评论":"添加评论"))}};t.sf=function(){this.Ja(!this.qd)};
a.Pw=function(b){if(b.dh){var c=$(b.dh);b.Xt(b.lB).show().css("left",c.position().left+c.width()/2)}},a.Mw=function(b){if("pending"!==b.ZE.state()){b.hb();b.g.innerHTML=b.Ii();b.expand();var c=b.Bi.il(b.id,b.F.WE).done(v(b.sR,b));return b.ZE=c}};t.YE=function(){return this.Bi.jl(this.id)};a.Qw=function(b,c,d,e){var c=$(c),g=$(d);d?($(".zm-command, .zm-comment-info",b.g).hide(),$(b.field).hide().after(g).after(c)):c.insertAfter(b.field);e&&e.call(b,c,g)};
t.sR=function(b){b=fc(Ma(b));R(b,this.qd);z.forEach($("."+this.F.xe,b).get(),this.oy,this);this.Vf=m;this.hb();mc(b,this.g);this.g=b;Fw(this)};
a.Fw=function(b){H.forEach({dB:".load-more",Vm:".zm-comment-list",QB:".zm-comment-form",field:".zm-comment-editable"},function(b,c){this[c]=$(b,this.g)[0]},b);b.field&&b.field.setAttribute("aria-label",b.Sd);if(Sg){var c=b.field;c.setAttribute("contentEditable",j);var d=b.Wk={m:function(){return c},hl:function(){return c.innerHTML},yd:function(b,d){c.innerHTML=d},Hf:function(){zt(c)}};b.Rr(d);b.Sr(d)}else{var e=L("textarea",{placeholder:b.Sd,"class":"zm-comment-textarea"});mc(e,b.field);new al(e,
22);b.field=e;b.Wk={m:function(){return e},hl:function(){return e.value},yd:function(){e.value="";e.style.height=$f(22,j)},Hf:function(){e.focus()}}}b.h().e(b.field,["change","keyup"],function(b){27!==b.keyCode&&(this.Cl=At(this.field)?"":this.$a())});S.ua()&&!S.yi&&Qw(b,'<div class="active-mask-tip-comment">为正常使用知乎提问、回答、评论和编辑功能，请验证您的邮箱、激活帐号。</div>','<div class="zm-command"><a class="zg-r3px zg-btn-blue" href="javascript:;">我要激活</a></div>',function(b,c){function d(){dl.O().D(j)}b.on("click",d);c.on("click",
d)});S.ua()||Qw(b,'<div class="signin-mask-tip-comment"></div>',k,function(c,d){function e(){new on({question:"question_comment_box",answer:"question_answer_comment_box"}[b.type])}c.on("click",e);d.on("click",e)});Jw(b);b.h().e(b.g,"click",b.ra).e(b.field,"keydown",b.MP).e(Li,"anon_change",b.cj).e(b.Wk.m(),["click","focus"],xa(b.st,j)).e(b.Wk.m(),"focus",xa(b.mi,"add_comment_start"));b.ea=Number(b.g.getAttribute("data-count"));$(b.g).on("focusin focusout","."+b.F.xe,function(b){$(this).toggleClass("focusin",
"focusin"===b.type)});!sb&&b.dB&&(b.Py=$.Deferred(function(b){setTimeout(b.resolve,2E3)}).promise().then($.proxy(b.YE,b)));Ow(b);Pw(b)},a.Ow=function(b){var c=b.F,d=!b.Ra();E.enable(b.g,c.Dv,d);d&&b.field&&c.autofocus&&b.field.focus();b.dispatchEvent("change")};t.$a=function(){var b=Ma(this.Wk.hl());return b===this.placeholder?"":b};t.Op=function(){var b=this.$a(),c=Ma(Fc(this.field));b&&"TEXTAREA"===this.field.tagName&&c||b?Lw(this,b):(U("请填写内容"),this.field.focus())};t.Ra=p("ea");
a.Lw=function(b,c,d){if(!(b.Tl&&"pending"===b.Tl.state())){var e;ra(c)&&(e=c.zR,c=c.content);var c=Pa(c),g=new Nd;g.set(b.type+"_id",b.id);g.set("content",c);e&&g.set("reply",e);c=b.Bi.add(g.Jt());c.done($.proxy(b.YL,b)).done(d);b.Tl=c;b.Cl=b.$a();b.mi("add_comment_submit")}};t.YL=function(b){if(b.r)return U(b.msg);this.Bi.qw(b.msg).done($.proxy(this.tR,this));this.Wk.yd("");Jw(this);this.st(m)};t.oy=function(b){this.nB(b)};
t.nB=function(b){if(qh("auth_f_manage")&&!("favlist"===this.type||$(".del, .op.remove",b).length)){var c=b.getAttribute("data-id");$("<a>",{href:"#",name:"admin_delcomment","class":"del zm-comment-op-link op needsfocus",html:'<i class="zg-icon zg-icon-comment-del"></i>删除',"data-op":"remove-comment","data-action":"/manage?"+$.param({comment_id:c,action:"remove_comment2"})}).appendTo($(".zm-comment-ft, .actions",b))}};
t.tR=function(b){this.Cl="";b=fc(b);this.Vm.appendChild(b);this.oy(b);this.ea+=1;Ow(this)};t.ur=function(b){b=Ic(b,k,this.F.xe).getAttribute("data-id");Au("comment",b)};t.or=function(b){var c=Ic(b,k,this.F.xe),d=c.getAttribute("data-id");Ci("删除评论","你确定要删除这条评论吗？",function(b){if(b){var g=xa(M,c);this.Bi.remove(d).done(v(function(){qa(g)&&g();this.ea-=1;Ow(this)},this))}},this)};t.Te=function(){$(window).on("beforeunload.CommentForm",v(function(){if(this.Cl)return"你的评论还未保存，确认离开该页面吗？"},this))};t.Af=function(){$(window).off("beforeunload.CommentForm")};
a.Rw=function(b){if(!b.el&&!dh.sc){var c=Ic(b.g,k,"zm-item-meta");if(c){var d=K("zm-meta-panel",c);d&&(b.el=new Cr(k,c),b.el.Zg="comment",b.el.o(d))}}};a.Sw=function(b){T.call(this);this.entryType=b};y(Sw,T);t=Sw.prototype;t.Qv="zm-item-expanded";t.ss="zm-item-meta";t.vj=k;t.B=function(){Sw.n.B.call(this);var b=$(this.g),c={};$("meta[itemprop]",b).each(function(){var b=$(this);c[b.attr("itemprop")]=b.attr("content")});this.tb=c[this.entryType+"-id"];this.yh=c[this.entryType+"-url-token"];this.Tq=c;this.Jm();this.ce()};
t.Jm=function(b){var c={'a[name="expand"]':function(b){this.Ja(j);this.Pn&&(b.currentTarget.name="toggleExpanded")},'a[name="collapse"]':function(){this.Ja(m)},'a[name="toggleExpanded"]':this.sf,'a[name="ignore"]':this.Iw,".js-close":this.KD,".js-collect":this.rl,".js-hiderelated":this.JD,".js-report":this.ZM,".js-share":this.rc,".js-toggle-commentbox":this.PD,".js-unhide":this.TD,'a[name="dislike"]':this.kM};H.extend(c,b||{});H.forEach(c,function(b,c){$(this.g).on("click",c,$.proxy(b,this))},this);
var d=$(".zm-meta-panel",this.g);H.forEach({'a[name="toggle-comment"]':function(b){this.PD(b);d.toggleClass("focusin",this.oa.fc())},'a[name="share"]':this.rc},function(b,c){d.on("click",c,$.proxy(b,this))},this)};t.PD=function(b){this.gp();this.oa.fc()&&(b=parseInt(Fc(b.currentTarget),10)||0,this.oa.mi("view_comments",b))};t.ZM=function(){Au(this.entryType,this.tb)};t.Ux=function(){jv(this.entryType,this.yh,"read")};t.Bj=function(){jv(this.entryType,this.yh,"touch")};
t.fc=function(){return E.has(this.g,this.Qv)};t.sf=function(){this.Ja(!this.fc())};t.Ja=function(b){if(b===this.fc())return m;b&&gu(this.g).height<Yb().height&&1<$("a.collapse",this.g).length&&$("a.collapse",this.g).eq(0).remove();E.enable(this.g,this.Qv,b);this.dispatchEvent(b?"expand":"collapse");return j};t.xQ=function(){window.open(K(this.vj,this.g).href)};t.KD=function(){$(this.g).fadeOut(150,function(){$(this).remove()})};t.TD=ha;t.JD=ha;
t.rc=sn(function(){new fv(arguments,"tb-webshare-sina")},{ua:"question_answer_share"});
t.kM=function(){var b=$(this.g),c=$(".feed-item-inner",this.g),d=$(".dislike-wrap",this.g),e=d.data();d.one("click",".revert",function(){c.slideDown();d.slideUp();$.post("/topstory/item/uninterest/revert",e)}).one("click",".close",function(){b.slideUp(function(){b.remove()})}).on("click",".zg-unfollow",function(){var c=$(this).data(),d={roundtable:bk,column:ak};Ci("确定取消关注？",su("确定取消关注%s吗？",c.title),function(e){e&&(d[c.follow](c.token,m),b.slideUp(function(){b.remove()}))},this)});$.post("/topstory/item/uninterest",
e).done(function(){c.slideUp();d.slideDown()})};t.gp=function(){if(!this.oa){var b=$(".toggle-comment",this.g)[0];this.oa=new Ew(this.tb,this.entryType);this.H(this.oa);Iw(this.oa,K(this.ss,this.g),b);Rw(this.oa)}this.oa.sf()};t.Hw=function(){this.oa?this.oa.field.focus():this.gp()};
t.ce=function(){this.Zf=wk.gI(this.g);vk(this.Zf.register("shift+o",this.xQ,this),{group:"操作",name:"新窗口打开条目"});var b=$('a[name="dislike"], a[name="ignore"]',this.g);b.length&&vk(this.Zf.register("i g",function(){b.click()}),{group:"操作",name:"不感兴趣"})};a.Tw=function(b){T.call(this);this.vp="votebar-mobile";this.xv="votebar-mobile-dialog";this.uA=b;this.bI=L("span","_votebar-holder")};y(Tw,T);Tw.prototype.ca=function(b){Tw.n.ca.call(this,b);this.h().e(b,"click",this.AQ)};Tw.prototype.aL=function(){var b=this.uA;mc(b.m(),this.bI);E.remove(b.m(),this.vp)};Tw.prototype.zO='<div class="text zg-clear"><label class="zg-left">赞同</label><label class="zg-right">反对</label></div>';
Tw.prototype.AQ=function(){this.mb&&this.mb.G();var b=new yi(k,m);b.Tk=j;b.Io(j);b.EL=j;var c=this.uA;mc(this.bI,c.m());E.add(c.m(),this.vp);this.h().e(c,"action",function(){this.mb&&setTimeout(v(function(){this.mb.D(m)},this),150)});oe(this.h(),b,"hide",this.aL);c=b.X();c.appendChild(this.uA.m());c.appendChild(fc(this.zO));E.add(b.m(),this.xv);b.D(j);this.mb=b;Rc(this,b)};a.Uw=function(){Sw.call(this,"post")};y(Uw,Sw);t=Uw.prototype;t.vj="post-link";
t.B=function(){Uw.n.B.call(this);var b=this.Bt=new wu;this.H(b);Rc(this,b);this.h().e(b,"expand",function(){this.Ja(j)});b.o(this.g);b.cd()&&oe(this.h(),b,"expand",this.Ux);vu(this.g,this.Bj,this);if(b=K("zm-votebar",this.g))this.rb=new Xu(this.tb,this.entryType),Rc(this,this.rb),this.rb.o(b),(b=K("votenum-mobile",this.g))&&(new Tw(this.rb)).o(b);if(b=K("zm-item-vote-info",this.g)){var c=this.qY=new Vw(this.tb,this.entryType);Rc(this,c);c.o(b);this.rb&&this.h().e(this.rb,"change",function(){c.Yh()}).e(c,
"change",function(){var b=K("zm-item-vote-count",this.g),e=$(".zm-votebar .count",this.g)[0];b&&yk(b,c.Ra());e&&yk(e,c.Ra())})}};t.rc=function(){Uw.n.rc.call(this,"分享文章","post",this.tb,{post_id:this.tb})};t.Ja=function(b){Uw.n.Ja.call(this,b)&&(b||Tt($(".entry-body",this.g)[0]),this.Bt.Ja(b),this.tz(b))};t.tz=function(b){var c=this.Hn();c&&zr(c,b)};
t.Hn=function(){if(this.wp)return this.wp;var b=!sb,c=K("zm-editable-content",this.g),d=this.rb&&this.rb.m();b&&(d&&$(d).is(":visible")&&c&&230<$(c).height())&&(b=this.wp=new Cr(k,c),this.H(b),b.Zg="votebar",b.Ey=50,b.o(d))};t.Iw=function(){$(".feed-hide-options",this.g).show().siblings().hide();$.post(su("/post/uninterest"),{id:this.tb})};t.TD=function(){$(".feed-hide-options",this.g).hide().siblings().show();$.post(su("/post/undo_uninterest"),{id:this.tb})};
t.JD=function(b){var b=$(b.currentTarget),c=b.data();Ci(b.attr("title"),su("确定%s吗？",b.text()),function(b){b&&(this.KD(),$.post(su("/%s/uninterest",c.type),{id:c.id}))},this)};
t.ce=function(){Uw.n.ce.call(this);vk(this.Zf.register("v",function(){this.rb&&this.rb.Lt()},this),{group:"操作",name:"赞同"});vk(this.Zf.register("d",function(){this.rb&&this.rb.Kt()},this),{group:"操作",name:"反对"});vk(vk(vk(vk(this.Zf.register("o",this.sf,this),{group:"操作",name:"显示全部/收起"}).register("c",this.gp,this),{group:"操作",name:"打开评论"}).register("f x",this.rc,this),{group:"操作",name:"分享"}).register("shift+c",this.Hw,this),{group:"操作",name:"定位到评论框"})};a.Ww=function(b){Sw.call(this,b)};y(Ww,Sw);Ww.prototype.vj="question_link";Ww.prototype.Iw=function(){var b=this.Tq["question-id"];this.dispatchEvent({type:"ignore",key:"question-id",value:b});$.post("/question/uninterest",{qid:b})};a.Xw=function(){Sw.call(this,"question")};y(Xw,Ww);Xw.prototype.B=function(){Xw.n.B.call(this);vu(this.g,function(){jv("question",this.yh,"touch")},this)};Xw.prototype.rc=function(){Xw.n.rc.call(this,"分享问题","question",this.yh,{qid:this.tb})};
Xw.prototype.ce=function(){Xw.n.ce.call(this);vk(vk(vk(this.Zf.register("c",this.gp,this),{group:"操作",name:"打开评论"}).register("f x",this.rc,this),{group:"操作",name:"分享"}).register("shift+c",this.Hw,this),{group:"操作",name:"定位到评论框"})};a.Yw=function(){Sw.call(this,"answer")};y(Yw,Ww);a.Zw=function(b){return K("zm-item-answer",b)||K("entry-body",b)};t=Yw.prototype;t.B=function(){Yw.n.B.call(this);this.jB=Zw(this.g);this.Pn=this.jB.getAttribute("data-isowner");this.gx();this.zl()};t.rc=ha;
t.Ja=function(b){Yw.n.Ja.call(this,b)&&(b||(Tt(this.mg.m()),$w(this,m)),b&&this.zl(),this.mg.tz(b),this.mg.Bt.Ja(b))};t.gx=function(){var b=K("zm-item-answer-author-wrap",this.g);b&&(b=K("zm-list-avatar",b),dk.add(b))};t.zl=function(){this.mg=new ax(this.Tq["question-id"],{lb:this.Tq["question-url-token"]},this.tb);var b=K("zm-item-meta",this.g);this.mg.Rc=b;this.H(this.mg);this.mg.o(this.jB);b=this.mg.Bt;this.h().e(b,"expand",function(){this.Ja(j)});this.zl=ha};
t.ce=function(){Yw.n.ce.call(this);vk(this.Zf.register("o",this.sf,this),{group:"操作",name:"显示全部/收起"})};t.Jm=function(){Yw.n.Jm.call(this,{"a[name=expandQuestionDetail]":function(){$w(this,j)}})};a.$w=function(b,c){$(".feed-question-detail-item",b.g).toggleClass("question-detail-expanded",c)};a.bx=function(){Sw.call(this,"roundtable")};y(bx,Sw);t=bx.prototype;t.B=function(){bx.n.B.call(this);this.Gn()};t.vj="roundtable_link";t.Iw=function(){$.post("/roundtable/"+this.yh,{action:"mute"});this.dispatchEvent({type:"ignore",key:"roundtable-id",value:this.tb})};t.Gn=function(){vu(this.g,this.Bj,this)};t.Bj=function(){jv("roundtable",this.yh,"touch")};a.cx=function(){Sw.call(this,"column")};y(cx,Sw);cx.prototype.B=function(){cx.n.B.call(this);var b=K("column",this.g);vu(b,this.Bj,this)};cx.prototype.Bj=function(){jv("column",this.yh,"touch")};a.dx=function(b){var c=b.getAttribute("data-type");return(c={p:Uw,a:Yw,q:Xw,r:bx,c:cx}[c])?new c:Zw(b)?new Yw:new T};a.ex=function(b,c,d){Ou.call(this,b,c,d)};y(ex,Ou);ex.prototype.Gj=function(b){var c=dx(b);this.H(c);c.o(b);c instanceof Yw&&c.Ja(m)};a.fx=function(){N.call(this);this.S=k;this.na=0;this.Mx=[];this.ks=[];this.bA="最多输入 20 字";this.vv="最多输入 256 字"};y(fx,Yk);ia(fx);t=fx.prototype;
t.v=function(){this.fL=j;this.g=L("div",k,[this.wj=L("div",k,[this.Jg=L("div","zm-favo-list-content"),this.ZA=L("div","zh-favo-add-new-wrap zm-command",this.BS=L("a",{"class":"zm-favo-dialog-create zg-left",href:"javascript:;"},"+ 创建收藏夹"),this.$u=L("a",{href:"javascript:;","class":"zg-btn-blue"},"关闭")),this.pu=L("div","zh-favo-add-new-wrap zm-command",this.sK=L("a",{href:"javascript:;","class":""},"取消"),this.CS=L("a",{"class":"zm-favo-dialog-create zg-btn-blue",href:"javascript:;"},"创建收藏夹"))]),this.ew=
L("div",{style:"display:none"},[L("div",k,["标题",this.aA=L("span",{"class":"zh-favo-add-title-error"},"请填写标题")]),L("div","zg-section",this.xj=L("input",{"class":"zg-form-text-input",style:"width:97%;font-size:13px"})),L("div",k,"描述（可选）"),L("div","zg-section zg-editor-simple-wrap zg-form-text-input",this.Dl=L("textarea",{"class":"zg-editor-input",style:"height:66px"})),this.bR=L("label",k,[this.nO=L("input",{type:"radio",checked:"checked",value:"public",name:"mode"}),L("strong",k," 公开 "),L("span","zg-gray-normal",
"公开后不能设置为私密")]),this.xO=L("br"),this.ZQ=L("label",k,[this.mO=L("input",{type:"radio",value:"private",name:"mode"}),L("strong",k," 私密 "),L("span","zg-gray-normal","只有你可以查看这个收藏夹")]),L("div","zm-command",[this.Oz=L("a",{href:"javascript:;","class":"zg-mr10"},"取消"),this.tq=L("a",{href:"javascript:;","class":"zg-mr10"},"完成"),this.XA=L("a",{"class":"zg-btn-blue"},"确认创建")])])]);R(this.aA,m);R(this.pu,m);(new Fo(this.bA)).o(this.xj);(new Fo(this.vv)).o(this.Dl);z.forEach(this.Mx,function(b){gx(this,b)},this);
this.Mx.length||(this.Jg.innerHTML='<div id="zh-fav-list-item-place-holder" class="zg-r5px zm-fav-list-item-place-holder">你可以创建多个收藏夹，将答案分类收藏</div> ',R(this.pu,j),R(this.ZA,m));hx(this);this.S.X().innerHTML="";this.S.X().appendChild(this.g);this.S.ha()};
a.hx=function(b,c,d){b.S||(b.S=new yi(k,m),hi(b.S,k),b.S.Ma(c||""),d&&(b.S.X().innerHTML=d),b.h().e(b.S,"afterhide",function(){this.Af()}))},a.gx=function(b,c,d){var e=J("zh-fav-list-item-place-holder");e&&R(e,m);b.Qy=c[5]?"":L("span","zm-fav-list-item-lock",[L("i","icon icon-lock")]);e=L("span","zm-favo-list-item-title");xc(e,c[1]);e=L("a",{"class":"zg-r5px zm-favo-list-item-link",href:"javascript:;"},[b.Qy,e,L("span",{className:"meta zg-gray",innerHTML:'<span class="num">'+c[3]+'</span> 条答案 <span class="zg-bull">•</span> '+
c[4]+" 人关注"})]);b.Qy&&b.Qy.setAttribute("data-tip","s$t$私密收藏夹");e.setAttribute("data-lid",c[0]);z.contains(b.ks,c[0])&&E.add(e,"zm-favo-list-item-link-active");c=K("zm-favo-list-item-link",b.Jg);d&&c?jc(e,c):b.Jg.appendChild(e)};
t.fb=function(){this.h().e(this.Oz,"click",function(){this.na?ix(this,0):jx(this)}).e(this.BS,"click",function(){Y.Z({type:"ga_click_add_collection"});ix(this,1)}).e(this.$u,"click",function(){jx(this)}).e(this.CS,"click",function(){Y.Z({type:"ga_click_add_collection"});ix(this,1)}).e(this.sK,"click",function(){jx(this)}).e(this.tq,"click",function(){jx(this)}).e(this.XA,"click",this.ff).e(this.Jg,"click",this.bQ).e(this.xj,"change",function(){R(this.aA,m)})};
t.bQ=function(b){var c=Ic(b.target,"A");if(c&&!this.locked){var b=c.getAttribute("data-lid"),d=m;E.has(c,"zm-favo-list-item-link-active")?(d=j,this.gC=b):this.cC=b;c=new Kk;c.add("answer_id",this.na);c.add("favlist_id",b);this.lz=new V(j);this.locked=j;oe(this.h(),this.lz,"complete",this.qJ);this.lz.ajax(d?"/collection/remove":"/collection/add",c.dd())}};
t.qJ=function(){this.locked=m;this.$u.innerHTML="关闭";var b=Ie(this.lz);b&&!b.r?(b=Vb("zm-favo-list-item-link",this.Jg),z.forEach(b,function(b){var d=b.getAttribute("data-lid"),e=K("num",b),g=parseInt(e.innerHTML,10);d===this.gC?(e.innerHTML=g-1+"",E.remove(b,"zm-favo-list-item-link-active")):d===this.cC&&(e.innerHTML=g+1+"",E.add(b,"zm-favo-list-item-link-active"))},this),this.cC=this.gC=k,Nk("Favorite","add_favorite")):U("添加失败: "+b.msg)};
a.kx=function(b,c){if(b.na!==c&&b.Jg){var d=Vb("zm-favo-list-item-link",b.Jg);z.forEach(d,function(b){E.remove(b,"zm-favo-list-item-link-active")},b)}b.na=c};t.Hj=function(){this.fb();this.$u.innerHTML="关闭";this.na?(R(this.tq,m),ix(this,0)):(ix(this,1),R(this.Oz,m),this.tq.innerHTML="取消")};t.show=function(b){b?(lx(this),this.S.D(j),this.Hj()):(hx(this,"添加到收藏夹",'<div style="text-align: center; color: #999;">收藏夹加载中<i class="spinner-gray"></i></div>'),this.S.D(j),this.jr())};
a.nx=function(b,c,d,e){var g=J("zh-fav-head-title"),h=J("zh-fav-head-description-source"),c=c||(g?Fc(g):""),d=d||(h?Fc(h):"");b.fC=e||kh;lx(b);b.nF=j;b.fb();ix(b,1);R(b.Oz,m);b.tq.innerHTML="取消";b.XA.innerHTML="保存";b.S.Ma("编辑收藏夹");b.xj.value=Za(c);b.Dl.value=Za(d);b.fC[1]?(R(b.bR,m),R(b.ZQ,m),R(b.xO,m)):b.mO.setAttribute("checked",j);b.PN=mx(b);b.S.D(j);b.Xr=j};t.jr=function(){this.na&&!this.nF&&$.get("/collections/json",{answer_id:this.na}).done(v(this.SP,this))};
a.lx=function(b){if(b.fL){var c=Vb("zm-favo-list-item-link",b.Jg);z.forEach(c,function(b){var c=b.getAttribute("data-lid");E.remove(b,"zm-favo-list-item-link-active");z.contains(this.ks,+c)&&E.add(b,"zm-favo-list-item-link-active")},b)}else b.v()};t.SP=function(b){b&&!b.r&&(this.Mx=b.msg[0],this.ks=b.msg[1],lx(this),this.nF=j,this.Hj())};
a.ix=function(b,c){var d=!!c;b.S.Ma(0===c?"添加到收藏夹":"创建新收藏夹");R(b.wj,!d);R(b.ew,d);new Zl(b.xj,b.bA);new Zl(b.Dl,b.vv);if(1===c)$(b.ew).on("change.FavoDiag","input, textarea, select",function(){b.Te()});else $(b.ew).off("change.FavoDiag"),b.Af()},a.mx=function(b){var c=new Kk,d=Ak(b.xj.value),e=Wa(b.Dl.value===b.vv?"":b.Dl.value);e||(e=-1);c.add("title",d);c.add("description",e);c.add("is_public",b.nO.checked?1:0);return c};
t.ff=function(){var b=Ak(this.xj.value);if(!b||b===this.bA)R(this.aA,j);else{b=mx(this);this.na&&b.add("answer_id",this.na);if(this.Xr){if(this.PN.dd()===b.dd()){jx(this);return}b.add("favlist_id",this.fC[0])}this.xhr=new V(j);oe(this.h(),this.xhr,"complete",this.hJ);this.xhr.ajax(this.Xr?"/collection/update":"/collection/create",b.dd())}};
t.hJ=function(){var b=Ie(this.xhr);b&&!b.r?this.Xr?(jx(this),U("编辑成功"),setTimeout(function(){window.location.reload()},1E3),this.Xr=m):this.na?(R(this.pu,m),R(this.ZA,j),ix(this,0),this.ks.push(b.msg[0]),gx(this,b.msg,j),this.xj.value="",this.Dl.value=""):(jx(this),U("创建成功"),setTimeout(function(){window.location.href="/collections/mine"},1E3)):U(b.msg)};t.R=function(){return this.S.R()};
a.jx=function(b){b.S.D(m);b.dispatchEvent(ox);Y.Z({type:"ga_click_collect_answer",data:{count:$(".zm-favo-list-item-link-active",b.Jg).length}})},a.ox="close";fx.prototype.Te=function(){$(window).on("beforeunload.FavoDiag",v(s("你对收藏夹的修改还未保存，确认离开该页面吗？"),this))};fx.prototype.Af=function(){$(window).off("beforeunload.FavoDiag")};a.px=function(b){var c=b.type;if(!la(c))return k;switch(c.toLowerCase()){case "checkbox":case "radio":return b.checked?b.value:k;case "select-one":return c=b.selectedIndex,0<=c?b.options[c].value:k;case "select-multiple":for(var c=[],d,e=0;d=b.options[e];e++)d.selected&&c.push(d.value);return c.length?c:k;default:return la(b.value)?b.value:k}},a.qx=function(b,c){var d=b.elements[c];if(d.type)return px(d);for(var e=0;e<d.length;e++){var g=px(d[e]);if(g)return g}return k};a.rx=function(){T.call(this)};y(rx,T);rx.prototype.ca=function(b){rx.n.ca.call(this,b);this.h().e(Y,"sina_callback",this.Bs);this.h().e(Y,"qqconn_callback",this.Bs);this.h().e(J("zh-setting-page-bind-sina-unbindbtn"),"click",this.aG);this.h().e(J("zh-setting-page-bind-qqconn-unbindbtn"),"click",this.aG)};
rx.prototype.Bs=function(b){if("sina_callback"===b.type){var c=rh.name=b.tc.name,b=rh.id=b.tc.id;J("zh-setting-page-bind-sinaname").innerHTML='<a href="http://weibo.com/'+b+'" target="_blank">@'+c+"</a>";tx(j)}else"qqconn_callback"===b.type&&(J("zh-setting-page-bind-qqconnname").innerHTML=b.tc.name,ux(j))};
rx.prototype.aG=function(b){var c=b.target.getAttribute("data-weibotype");if(window.confirm("你确定要解除与"+{sina:"新浪微博",qqconn:" QQ "}[c]+"的绑定吗？")){var d=new V(j);oe(this.h(),d,"success",function(){var b=Ie(d);b&&!b.r?"sina"===c?tx():"qqconn"===c&&ux():U(b.msg)});d.ajax("/oauth/unbind/"+c)}};
a.tx=function(b){R(J("zh-setting-page-bind-sina-binded-wrap"),!!b);R(J("zh-setting-page-bind-sina-tobind-wrap"),!b)},a.ux=function(b){R(J("zh-setting-page-bind-qqconn-binded-wrap"),!!b);R(J("zh-setting-page-bind-qqconn-tobind-wrap"),!b)};a.vx=function(){T.call(this)};y(vx,T);t=vx.prototype;
t.ca=function(b){vx.n.ca.call(this,b);if(b=K("profile-edit-avatar-btn")){var c=this.Du=new Vl(Ul);c.o(b);this.h().e(this.Du,"beforepost",function(){$(".zm-avatar-editor-preview").parent().append($("<div class='avatar-edit-preview-loading'><span></span></div>"))});this.h().e(this.Du,"success",function(){$t("ProfileHeaderV2","save",{data:{avatar_path:c.getData().id}},function(){$(".avatar-edit-preview-loading").remove();$("img.zm-avatar-editor-preview").attr("src",c.getData().url)},function(){$(".avatar-edit-preview-loading").remove();
U("更新失败")})})}this.T=[];var d=this;$(".editable-group",this.g).each(function(){var b=new Xm;d.T.push(b);b.o(this)});b=J("zm-profile-edit-submit");this.h().e(b,"click",this.uy);(new rx).o(this.g);$(this.g).on("change","input, textarea, select",function(){d.Te()})};
t.B=function(){vx.n.B.call(this);var b=J("zm-profile-progress-anim"),c=new wx;c.addEventListener("update",function(){var d=100*c.V()|0;10>d&&(d=10);b.style.width=b.innerHTML=d+"%"});z.forEach(this.T,function(b,d){c.watch({name:"name"+d,target:b,zh:["add","remove"],ph:function(){return!!b.nd.children().length}})},this);var d=this.g,e=J("zm-profile-edit-male"),g=J("zm-profile-edit-female"),h=J("zm-profile-edit-description"),l=$(".business-selection select")[0],n=J("zm-profile-edit-expert-disable");
c.watch({name:"expert_progress",target:J("zm-profile-edit-expert-enable"),zh:["change"],ph:function(){return k!==qx(d,"enable_expert")}}).watch({name:"expert_progress",target:n,zh:["change"],ph:function(){return k!==qx(d,"enable_expert")}}).watch({name:"gender_progress",target:e,zh:["change"],ph:function(){return k!==qx(d,"gender")}}).watch({name:"gender_progress",target:g,zh:["change"],ph:function(){return k!==qx(d,"gender")}}).watch({name:"desc_progress",target:h,zh:["blur"],ph:function(){return!!Ma(h.value)}}).watch({name:"business_progress",
target:h,zh:["blur"],ph:function(){return!!Ma(h.value)}}).watch({name:"headline_progress",target:l,zh:["blur"],ph:function(){return!!Ma(l.value)}})};t.Te=function(){$(window).on("beforeunload.profileedit",v(s("你的更改还未保存，确认离开该页面吗？"),this))};t.Af=function(){$(window).off("beforeunload.profileedit")};
t.uy=function(){function b(b){U(ma(b)?b[0][1]:b)}var c=$("#zm-profile-edit-male").is(":checked")?1:0,d=$("#zm-profile-edit-headline").val(),e=$("#zm-profile-edit-description").val(),g=$(".business-selection select").val(),h=[];$("#zm-profile-edit-loc-container").children().each(function(){h.push($(this).data("title"))});var l=[];$("#zm-profile-edit-co-container").children().each(function(){var b=$(this);l.push([b.data("title"),b.data("sub-title")||""])});var n=[];$("#zm-profile-edit-edu-container").children().each(function(){var b=
$(this);n.push([b.data("title"),b.data("sub-title")||""])});var q=$("#zm-profile-edit-weibo-enable").is(":checked")?1:0,r=$("#zm-profile-edit-expert-enable").is(":checked")?1:0,c=H.filter({gender:c,headline:d,description:e,location:h,business:g,employment:l,education:n,enable_weibo:q,enable_expert:r},et),w=v(function(){this.Af();window.location.href="/people/"+S[1]+"/about"},this),d=new V(j);d.addEventListener("complete",function(){var c;try{c=Ie(this)}catch(d){}c&&!c.r&&qa(w)?w.call(this,c):qa(b)&&
b.call(this,c.msg)});d.ajax("/people/edit","data="+encodeURIComponent(Zc(c)))};a.wx=function(){this.Hy={}};y(wx,Gd);wx.prototype.update=function(b,c){this.Hy[b]=c;this.dispatchEvent({type:"update"});return this};wx.prototype.watch=function(b){var c=v(function(){this.update(b.name,b.ph())},this);O(b.target,b.zh,c);c();return this};wx.prototype.V=function(){var b=H.Ka(this.Hy);return b.length&&z.filter(b,Boolean).length/b.length};a.xx=function(){this.Si="editing";T.call(this)};y(xx,T);xx.prototype.ca=function(b){xx.n.ca.call(this,b);this.J=$(b);this.J.on("click",'a[href^="javascript"]',$.proxy(this.ra,this));this.J.on("click",'a[href^="javascript"], input',m);this.J.on("click",".item",$.proxy(this.zQ,this))};a.yx=function(b,c,d){if(!dh.sc||navigator.userAgent.match(/iPad/i)!=k)b=$(".item",b.J).index(c),c.siblings().eq(b-b%2).height(d?"auto":c.height())};
xx.prototype.zQ=function(b){var c=$(b.currentTarget),d=c.data("href"),c=d&&!c.hasClass(this.Si),b=b.metaKey||b.ctrlKey;c&&(b?window.open(d):location.href=d)};
xx.prototype.ra=function(b){var c=$(b.currentTarget),d=c.closest(".item"),b=c.attr("name");if("edit"===b)c.closest(".description").hide().siblings(".description-edit").show().find("input").focus().closest(".item").addClass(this.Si).closest(".skilled-topics").addClass(this.Si),yx(this,d);else if("cancel"===b)c.closest(".description-edit").hide().siblings(".description").show().closest(".item").removeClass(this.Si).closest(".skilled-topics").removeClass(this.Si),yx(this,d,j);else if("save"===b){var e=
new V(j);this.h().e(e,"success",function(){var b=Ie(e);b.r?U(b.msg):(c.closest(".description-edit").hide().siblings(".description").show().children(".des").text(b.msg).siblings(".edit").addClass("zu-edit-button").children(".edit-msg").html("修改").closest(".item").removeClass(this.Si).closest(".skilled-topics").removeClass(this.Si),yx(this,d,j))});e.ajax("/topic/bio/update","tid="+c.closest(".item").data("id")+"&bio="+c.parent().siblings("input").val(),"POST")}};a.zx=function(){T.call(this)};y(zx,T);
zx.prototype.ca=function(b){zx.n.ca.call(this);if(b&&(this.J=$(b),$(".editable-group",this.J).each(function(){(new Ax).o(this)}),(b=J("profile-header-description-input"))&&new al(b),(b=K("zm-profile-header-avatar-container"))&&E.has(b,"self"))){var c=new Vl(Ul);c.o(b);this.h().e(c,"beforepost",function(){$(".zm-avatar-editor-preview").parent().append($("<div class='avatar-edit-preview-loading'><span></span></div>"))});this.h().e(c,"success",function(){$t("ProfileHeaderV2","save",{data:{avatar_path:c.getData().id}},
function(){$(".avatar-edit-preview-loading").remove();K("zm-avatar-editor-preview").src=c.getData().url},function(){$(".avatar-edit-preview-loading").remove();U("更新失败")})})}};a.Ax=function(){T.call(this)};y(Ax,T);t=Ax.prototype;t.ca=function(b){Ax.n.ca.call(this);this.J=$(b);this.Yd=$(".info-wrap",this.J);this.Ad=$(".edit-wrap",this.J);this.MT=$(".title",this.Yd);this.LT=$("input",this.Ad)};
t.B=function(){Ax.n.B.call(this);this.J.on("click","[name='edit']",$.proxy(function(){this.J.addClass("editing");var b=this.Ad.find("input").get(0);b?b.focus():(b=this.Ad.find("textarea").get(0))&&b.focus()},this));var b=this;this.Lp=[];$("input[type=text]",this.J).each(function(){var c=new Ym("/topic/autocomplete",this,$(this).parents(".topic-input-wrap")[0]);b.Lp.push(c)});this.Ad.on("keydown","input",function(b){13===b.keyCode&&setTimeout(function(){var c=$(b.target),g=c.parents(".edit-wrap").children().index(c.parent()),
h=c.parents(".edit-wrap").find("input, select").get(g+1),g=c.parents(".edit-wrap").find("input, select").get(g-1);c.val()&&(h?h.focus():g&&!$(g).val()&&g.focus())})});this.Ad.on("click","[name='cancel'], [name='save']",$.proxy(function(b){b=b.target.name;"cancel"===b?this.cancel():"save"===b&&this.save()},this));var c=$(".fold-wrap");c.click(function(b){"fold"===b.target.name?c.addClass("fold"):"unfold"===b.target.name&&c.removeClass("fold")})};
t.save=function(){var b=this.J.data("name");if("location"===b){var b=this.Ad.find("input.location"),c=this.Ad.find("select"),d=this.Ad.find("input.male").is(":checked")?1:0;$t("ProfileHeaderV2","save",{data:{location:[b.val()],business:c.val(),gender:d}},function(b){b=b.msg;b.location[0].html||(b.location[0].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写居住地</a>");b.business.html||(b.business.html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写行业</a>");
this.Yd.find("span.location").attr("title",b.location[0].text).html(b.location[0].html);this.Yd.find("span.business").attr("title",b.business.text).html(b.business.html);this.Yd.find("i.gender").removeClass("male female").addClass(1===parseInt(b.gender,10)?"male":"female");this.cancel()},this.Uh,this)}else"employment"===b?(c=this.Ad.find("input.employment"),b=this.Ad.find("input.position"),c=c.val(),b=b.val(),$t("ProfileHeaderV2","save",{data:{employment:[[c,b]]}},function(b){b=b.msg;!b.employment[0][0].text&&
!b.employment[0][1].text?this.J.addClass("empty"):this.J.removeClass("empty");b.employment[0][0].html||(b.employment[0][0].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写公司信息</a>");b.employment[0][1].html||(b.employment[0][1].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写职位</a>");this.Yd.find(".employment").attr("title",b.employment[0][0].text).html(b.employment[0][0].html);this.Yd.find(".position").attr("title",b.employment[0][1].text).html(b.employment[0][1].html);
this.cancel()},this.Uh,this)):"education"===b?(c=[this.Ad.find("input.education"),this.Ad.find("input.education-extra")],b=c[0].val(),c=c[1].val(),$t("ProfileHeaderV2","save",{data:{education:[[b,c]]}},function(b){b=b.msg;!b.education[0][0].text&&!b.education[0][1].text?this.J.addClass("empty"):this.J.removeClass("empty");b.education[0][0].html||(b.education[0][0].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写学校信息</a>");b.education[0][1].html||(b.education[0][1].html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写专业</a>");
this.Yd.find(".education").attr("title",b.education[0][0].text).html(b.education[0][0].html);this.Yd.find(".education-extra").attr("title",b.education[0][1].text).html(b.education[0][1].html);this.cancel()},this.Uh,this)):"description"===b&&(b=this.Ad.find("textarea.description"),$t("ProfileHeaderV2","save",{data:{description:b.val()}},function(b){b=b.msg;b.description.text?this.J.removeClass("empty"):(b.description.fold_html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写个人简介</a>",
b.description.unfold_html="<a href='javascript:;' class='zg-link-litblue-normal' name='edit'>填写个人简介</a>",this.J.addClass("empty"));this.Yd.find(".fold-item .content").empty().html(b.description.fold_html);this.Yd.find(".unfold-item .content").html(b.description.unfold_html);b.description.shortened?this.Yd.removeClass("disable-fold"):this.Yd.addClass("disable-fold");this.cancel()},this.Uh,this))};t.Uh=function(b){U(b.msg)};t.cancel=function(){this.J.removeClass("editing")};a.Bx=function(){N.call(this);this.Gg="zm-item";this.qW="zm-item-top-btn";this.OR=j};y(Bx,Yk);t=Bx.prototype;t.z=function(b){this.Sb=b;this.h().e(b,"click",this.ra);this.refresh()};t.di=ca("Gg");
t.ra=function(b){if(b.target){var c=Jk(this.Sb,b.target);c&&(this.type=c.getAttribute("data-type"),this.id=c.getAttribute("data-id"),this.action=c.name,this.item=Ic(b.target,k,this.Gg),this.type&&(this.id&&this.action&&this.item)&&(this.kI||(this.kI=j,this.xhr=new V(j),this.h().e(this.xhr,"complete",this.ef),this.xhr.ajax("/people/"+("top"===this.action?"pin":"unpin")+"_"+this.type,this.type+"_id="+this.id,"POST")),this.oW=c))}};
t.ef=function(){if("cancel-top"===this.action)aj(this.item,j);else if("top"===this.action){var b=Vb(this.Gg,this.Sb);this.SX=eg(this.item).y;b&&2<=b.length&&jc(M(this.item),K(this.Gg,this.Sb));this.scroll();Fk(this.item);R(K("zm-item-top-btn-top",this.item),m);R(K("zm-item-top-btn-cancel",this.item),j);this.refresh()}this.kI=m};t.scroll=function(){if(this.OR){var b=K("zm-profile-section-wrap"),c=Lc(Sb((fa||window).document)).y;b&&0>eg(b).y-c&&b.scrollIntoView()}};
t.refresh=function(){var b=Vb(this.Gg,this.Sb);b&&0<b.length&&z.forEach(b,function(b,d){if(0!==d){var e=K("zm-item-top-btn-top",b);e&&R(e,j)}},this)};a.Cx=function(b,c){b.h().e(c,"next",b.refresh)};a.Dx=function(){this.bw=["zg-btn-follow","zg-btn-unfollow"];this.cw="people"};y(Dx,T);Dx.prototype.B=function(){this.h().e(this.g,"click",this.ra)};Dx.prototype.ra=function(b){var c=Jk(this.g,b.target);this.Tm&&this.Tm(c);c&&(c.name&&"focus"===c.name)&&un(c,this.cw,function(){c.getAttribute("data-followme")&&(E.has(c,"zg-btn-follow")?c.setAttribute("data-tip","s$b$对方已关注你"):c.setAttribute("data-tip","s$b$已互相关注"))},this.bw,{UW:"question"===this.cw?"关注问题":k})};Dx.prototype.aH=ca("Tm");a.Fx=function(b,c,d,e){N.call(this);this.Fd=b;this.vh=c;this.Mg=d;this.zC=e||Ex;b.maxLength=d;this.oj=new $u(b);O(this.oj,"input",this.lo,m,this);this.Fi()};y(Fx,Gd);a.Ex=0;Fx.prototype.lo=function(){this.Fi()};Fx.prototype.Fi=function(){var b=this.Fd.value.length;if(b>this.Mg){var c=this.Fd.scrollTop,d=this.Fd.scrollLeft;this.Fd.value=this.Fd.value.substring(0,this.Mg);b=this.Mg;this.Fd.scrollTop=c;this.Fd.scrollLeft=d}this.vh&&xc(this.vh,1==this.zC?b:this.Mg-b)};
Fx.prototype.w=function(){Fx.n.w.call(this);delete this.Fd;this.oj.G();this.oj=k};a.Gx=function(b){N.call(this);this.S=k;this.ia=b;this.ct=0;this.uG=""},a.Hx=void 0;y(Gx,Yk);t=Gx.prototype;t.z=function(){this.Al||(this.Al=j,this.v(),this.fb())};t.fb=function(){A||(new Fo("搜索问题")).o(this.Jc);this.T=new Oo("/redirect-question/autocomplete",this.Jc,k,k,J("zh-question-redirect-diag-content"),m);this.T.Dm=m;this.T.hi(j);this.h().e(this.T,tm.gh.wi,Vk);this.h().e(this.T,"select",this.dQ).e(this.YJ,"click",function(){this.S.D(m)})};
t.dQ=function(){var b=this.T.$i();if("search_link"===b[0])window.open("/search?q="+encodeURIComponent(b[1])+"&type=question");else{this.Jc.value="";var c=b[3],b=b[1];this.S.D(m);this.Jc.value="";this.xhr=new V(j);oe(this.h(),this.xhr,"complete",this.rJ);this.xhr.ajax("/question/redirect","qid="+this.ia+"&rqid="+c);this.ct=c;this.uG=b}};t.rJ=function(){var b=Ie(this.xhr);b&&(b.r?U(b.msg):this.xi?(this.xi.innerHTML="已经重定向",this.xi.setAttribute("data-disabled",1)):this.dispatchEvent("change"))};
t.v=function(){this.g=L("div",{id:"zh-question-redirect-diag"},["将问题跳转至",L("div",{id:"zh-question-redirect-diag-content"},this.Jc=L("input",{type:"text","class":"zg-form-text-input"})),L("div","zm-command",this.YJ=L("a",{href:"javascript:;","class":"zm-command-cancel",name:"cancel"},"放弃操作"))]);this.S=new yi(k,m);this.S.Ma("问题重定向");hi(this.S,k);this.S.X().appendChild(this.g)};t.show=function(){this.z();this.S.D(j)};a.Ix={},a.Ix=function(){N.call(this)};y(Ix,Yk);Ix.gu=[["需要详细阐述","答案过于简短或表述不清晰，请完善答案。"],["答非所问","没有正面或直接回答问题，请修改答案。"],["应作为问题的评论","该内容是对问题本身的评论而不是回答，请改为发布到评论。"],["应作为答案的评论","该内容是对另外一个答案的评论或回应，而不是回答问题，请改为发布到评论。"],["内容重复","与已有答案重复，请修改答案。"],["内容已过期","答案的时效性已过，请更新答案。"],["需要注明关联利益","有广告、推销嫌疑，请注明作者与利益方的关系。"]];Ix.pj=k;Ix.O=function(){Ix.pj||(Ix.pj=new Ix,Ix.pj.z());return Ix.pj};t=Ix.prototype;
t.z=function(){if(!this.g){this.v();this.fb();var b=new bo(this.g);Sh(b);b.$D=j;b.Io(j);b.D(m);b.My=0;b.R()&&b.ha();Ys(b,new Pf(13,0,0,-22));this.Ly=b}};t.fb=function(){this.h().e(this.g,"click",this.aQ)};t.aQ=function(b){"A"===b.target.tagName&&(b=b.target.getAttribute("data-index"),this.NK.TW(b),this.Ly.D(m))};
t.v=function(){var b=L("div",{id:"zh-answer-flag-popup","class":"zg-r5px zu-hovercard-wrap"},[L("div","zg-r5px zu-hovercard-inner",[L("div",{id:"zh-answer-flag-popup-header"},[L("a",{"class":"zg-right",href:"http://www.zhihu.com/question/19867017",target:"_blank"},"这是什么？"),"选择一个理由："]),this.dG=L("div",{id:"zh-answer-flog-options-wrap"})]),L("div","zu-hovercard-spin-top")]);z.forEach(Ix.gu,function(b,d){var e=L("a",{href:"javascript:;","class":"zm-menu-item-link"},b[0]);e.setAttribute("data-index",
d);this.dG.appendChild(e)},this);document.body.appendChild(b);this.g=b};t.show=function(b,c){this.Ly.Vc(new $n(b,1));var d=c.aX(),e=Vb("zm-menu-item-link",this.dG);z.forEach(e,function(b,c){R(b,!z.contains(d,c))},this);this.Ly.D(j);this.NK=c};a.Jx=function(){N.call(this)},a.Kx=void 0;y(Jx,Yk);
Jx.prototype.z=function(){this.v();this.h().e(this.dl,"change",function(){var b=this.dl.value;this.Ty.value="no"===b?"":Ix.gu[+b][1]}).e(this.Gi,"click",function(b){"cancel"===b.target.name?this.S.D(m):this.Ty.value&&"no"!==this.dl.value&&(this.Yv=new V(j),this.h().e(this.Yv,"complete",function(){var b=Ie(this.Yv);b&&!b.r?(this.xi.innerHTML="已经标记",this.S.D(m)):U(b.msg)}),b=Ak(this.Ty.value),this.Yv.ajax("/answer/flag","answer_id="+this.aJ+"&flag="+this.dl.value+"&reason="+encodeURIComponent(b)))})};
Jx.prototype.v=function(){this.g=L("div",k,[L("div","zg-section",[L("div",k,"标记："),this.dl=L("select")]),L("div",k,[L("div",k,"原因"),this.Ty=L("textarea",{style:"width:96%;border:solid 1px #666;height:66px;padding:5px"})]),this.Gi=L("div","zm-command",[L("a",{"class":"zg-mr10",href:"javascript:void(0);",name:"cancel"},"取消"),L("a",{"class":"zg-btn-blue",href:"javascript:void(0);",name:"confirm"},"确定")])]);this.dl.appendChild(L("option",{value:"no"},"选择标记原因"));z.forEach(Ix.gu,function(b,c){this.dl.appendChild(L("option",
{value:c},b[0]))},this);this.S=new yi(k,m);this.S.Ma("标记答案");hi(this.S,k);this.S.X().appendChild(this.g)};Jx.prototype.show=function(){this.S.D(j)};a.Lx=function(b){var c=b&&b.name;if(c)switch(c){case "adminflag":Kx||(Kx=new Jx,Kx.z());c=Kx;c.xi=b;c.aJ=b.id.split("-")[1];c.show();break;case "redirect":case "cancel_redirect":if(!b.getAttribute("data-disabled")){var d;Hx||(Hx=new Gx,Hx.z());d=Hx;d.xi=b;d.ia=b.id.split("-")[1];"redirect"===c?d.show():(Fi("/question/unredirect",k,"POST","qid="+d.ia+"&rqid="+d.ct),d.xi.innerHTML="重定向已撤销",d.xi.setAttribute("data-disabled",1))}break;case "revert":var e=Ci("撤销",'<div class="zg-form-text-input"><textarea class="zg-editor-input content" title="请输入撤销原因" placeholder="请输入撤销原因"></textarea></div>',
function(c){if(c){var c=g.value,d=b.getAttribute("id").split("-")[1],c=(new jj).add("revision",d).add("reason",c),n=new V(j);n.on("success",function(){var b=Ie(n);b.r?U(b.msg):(e.D(m),b.msg?window.location.href=b.msg:location.reload())});n.ajax("/revert",c.toString());return m}}),g=K("content",e.X());new Zl(g);new al(g,48);new Fx(g,k,200)}},a.Mx=function(b){$(b).on("click",'a[name="revert"]',function(){Lx(this)})};a.Nx=function(){T.call(this)};y(Nx,T);t=Nx.prototype;t.z=function(){ys.H(this);this.o(document.body)};
t.B=function(){Nx.n.B.call(this);var b=K("zm-profile-header-operation");b&&(new Dx).o(b);(b=K("zm-profile-header"))&&(new zx).o(b);(b=J("zh-profile-activity-wrap"))&&this.h().e(b,"click",function(b){if((b=b.target)&&"focus"===b.name){var c=b.getAttribute("data-type");un(b,c,k,["zm-profile-follow-link-gray","zm-profile-unfollow-link-gray"])}});(this.dw=b=J("zh-profile-page-force-to-rename"))&&this.h().e(b,"click",this.bT);if(this.iz=J("zh-profile-search-form")){(b=J("zh-profile-search-type"))&&this.h().e(b,
"click",this.$P);this.Uj=this.iz.getAttribute("data_type");this.h().e(this.iz,"submit",this.search);O(window,"popstate",function(b){var b=b.state,c;b&&b.Os&&(c=J("zh-profile-search-query"),c.value=decodeURIComponent(b.Os),Ox(this,b.type),this.search(i,m),c.focus())},m,this);var b=(new wf(location)).dd().get("pq"),c=(new wf(location)).dd().get("type");c||(c="all");if(b&&c){var d=J("zh-profile-search-info");d&&R(d,j);Ox(this,c);J("zh-profile-search-query").value=b;this.search(i,i,m)}}if(b=J("zh-profile-activity-page-list"))c=
new xu({la:["expandLimit"],Vg:j}),c.la("locationSource",{url:"/people/"+jh[1]+"/activities",hs:10,param:function(b){return{start:z.Qd(b).getAttribute("data-time")}}}),c.la("childConstructor",{factory:dx}),this.H(c),c.o(b),this.h().e(c,"click!",function(b){"comment"===b.namespace&&b.xc.fill("category","profile").fill("label","profile_feed")});(b=K("zm-profile-fav-wrap"))&&this.h().e(b,"click",this.sL);(b=J("zm-profile-details-editform"))&&(new vx).o(b);if(b=K("zm-profile-answer-sort"))this.jh=new Nu,
this.jh.Fa(this.BJ=new Ku("按时间排序")),this.jh.Fa(this.CJ=new Ku("按投票排序")),this.jh.Fa(this.AJ=new Ku("问"+S[0]+"的问题")),this.jh.W(b),this.jh.D(m),this.h().e(b,"click",function(b){this.jh.D(j);b.stopPropagation();oe(this.h(),document,"click",function(){this.jh.D(m)})}),this.h().e(this.jh,"action",this.bN);(b=J("zh-profile-edit-expert"))&&(new Px).o(b);var e=K("profile-expert-tip");e&&this.h().e(e,"click",function(b){var c=b.target;("enable"===c.name||"close"===c.name)&&$t("ProfileExpertTopicsV2",c.name,
k,function(){"enable"===c.name?location.reload():aj(e,j)})});$(".zm-profile-section-wrap.skilled-topics").each(function(){(new xx).o(this)});$(".zm-profile-module.skilled-topics").each(function(){(new xx).o(this)});$(".zm-profile-module.active-topics").each(function(){(new xx).o(this)});if(c=J("zh-profile-ask-list"))if(b=new xu({la:["autoload","locationSource"],Vg:m}),this.H(b),b.o(c),c=K("zm-profile-section-list"))d=new Bx,d.di("zm-profile-section-item"),Cx(d,b),d.z(c);if(c=$("#zh-profile-answer-list > .zh-general-list").get(0)||
$("#zh-profile-answer-list").get(0))if(b=new xu({Vg:m}),this.H(b),b.la("childConstructor",{Ji:Yw}).la("expandLimit"),b.o(c),this.h().e(b,"click!",function(b){"comment"===b.namespace&&b.xc.fill("category","profile").fill("label","profile_answers_list")}),c=K("zm-profile-section-list"))d=new Bx,Cx(d,b),d.z(c);if(b=$("#zh-profile-log-list").get(0))c=new xu,c.la("locationSource",{Hs:j}),this.H(c),c.o(b),Mx(b);if(c=J("zh-profile-topic-list"))if(b=new xu({la:["autoload","locationSource"]}),this.H(b),this.h().e(b,
"itemcreated",function(b){var b=b.item,c=b.getAttribute("data-tid").split("-")[1];if(S.wd===jh[3]){var d=new Qr(j,"/topic/bio/update","bio");d.Qt=j;d.params=["tid="+c];d.Gb='<a href="javascript:;" name="edit">添加你在该话题的经验</a>';d.o(b)}}),b.o(c),c=K("zm-profile-section-list"))d=new Bx,d.di("zm-profile-section-item"),Cx(d,b),d.z(c);if(b=$("#zh-profile-column-list > .zh-general-list").get(0))c=new xu({la:["autoload","nodeSource"]}),this.H(c),c.o(b);if(b=$("#zh-profile-follows-list > .zh-general-list").get(0))c=
new xu({la:["autoload","nodeSource"]}),this.H(c),c.o(b);if(b=$("#zh-profile-follows-list-old").get(0))c=new xu({la:["autoload","locationSource"]}),this.H(c),c.o(b);if(b=$("#zh-profile-fav-list > .zh-general-list").get(0))c=new xu({la:["autoload","nodeSource"],Vg:m}),this.H(c),c.o(b);this.Fn();-1<location.search.indexOf("clean-followers-noti=1")&&(new V(j)).ajax("/notification/clear","no_refresh_content=true&type=follow");$("#__signin").click(function(){qn(new on,m)})};
t.bT=function(){Ci("确定","确定要强制此用户改名吗？",function(b){b&&(J("realname_form").submit(),this.dw.innerHTML="已发送",E.add(this.dw,"zg-gray"),Bd(this.dw))},this)};
t.Fn=function(){this.nj();var b=J("zm-profile-header-pm-btn");b&&O(b,"click",qf(function(b){b.preventDefault()},sn(function(){var c=new Po;c.show();To(c,jh[3],jh[0]);So(c,b.href);c.Vb.focus()},j)));var c=J("zh-profile-cancel-block");c&&this.h().e(c,"click",this.IF);(c=J("zh-report-people"))&&this.h().e(c,"click",this.JG);(c=J("zh-profile-search-query-mirro"))&&new Zl(c,c.getAttribute("placeholder"))};
t.IF=function(){Ci("确定取消屏蔽？","取消屏蔽后，对方将可以关注你、向你发私信、评论你的回答、使用「@」提及你，邀请你回答问题。",function(b){b&&Qx(this,m)},this)};t.Ck=function(){oe(this.h(),document,"click",function(){this.ab.D(m)})};t.nj=function(){var b=J("profile-side-op");b&&this.h().e(b,"click",this.fj)};t.bN=function(b){var c="";b.target===this.BJ?c="time":b.target===this.CJ?c="vote":b.target===this.AJ&&(c="ask");location.href="/people/"+S[1]+"/answers?sort="+c};
t.fj=function(b){b=b.target.name;"block"===b?Ci("确定要屏蔽该用户？","屏蔽用户后，对方将不能关注你、向你发私信、评论你的实名回答、使用「@」提及你，邀请你回答问题，但仍然可以查看你的公开信息。",function(b){b&&Qx(this,j)},this):"report"===b?this.JG():"cancel-block"===b&&this.IF()};t.JG=function(){Au("member",jh[3])};a.Qx=function(b,c){var d=new V(j);oe(b.h(),d,"complete",function(){window.location.reload()});d.ajax("/people/"+jh[1]+"/block","action="+(c?"add":"cancel"))};
t.sL=function(b){if(b&&b.target&&(b=Jk(this.g,b.target))){var c=K("zm-profile-fav-item-title",b),d=K("zm-profile-fav-item-des",b);c&&d&&"fav-edit"===b.name&&(c=c.innerHTML,d=d.innerHTML||"",b=[Number(b.getAttribute("data-id")),Number(b.getAttribute("data-public"))],nx(fx.O(),c,d,b))}};t.$P=function(b){if((b=b.target)&&b.name)Ox(this,b.name),this.search()};
a.Ox=function(b,c){var d=Vb("zm-profile-search-type-item");if(d)for(var e=0;e<d.length;e++)E.remove(d[e],"current"),d[e].name===c&&E.add(d[e],"current");b.Uj=c};
t.search=function(b,c,d){this.Ce=J("zh-profile-search-query").value;this.cm="/people/"+J("zh-profile-search-form").getAttribute("data_url")+"/search";if(this.Ce){c===i&&(c=j);d===i&&(d=j);if(window.history.pushState){if(this.kz)return;b&&b.preventDefault();this.dm=new V(j);this.kz=j;this.h().e(this.dm,"complete",this.jI);c&&window.history.pushState({Os:encodeURIComponent(this.Ce),type:this.Uj},"","?pq="+encodeURIComponent(this.Ce)+"&type="+this.Uj);this.dm.ajax(this.cm,"type="+this.Uj+"&pq="+encodeURIComponent(this.Ce),
"","POST")}else b||(d?(this.Ce=J("zh-profile-search-query").value,this.cm="/people/"+J("zh-profile-search-form").getAttribute("data_url")+"/search",window.location.href=this.cm+"?type="+this.Uj+"&pq="+encodeURIComponent(this.Ce)):(this.dm=new V(j),this.kz=j,this.h().e(this.dm,"success",this.jI),this.Ce=J("zh-profile-search-query").value,this.cm="/people/"+J("zh-profile-search-form").getAttribute("data_url")+"/search",this.dm.ajax(this.cm,"type="+this.Uj+"&pq="+encodeURIComponent(this.Ce),"","POST")));
(b=J("zh-profile-search-info"))&&R(b,j)}else b&&b.preventDefault()};
t.jI=function(){this.kz=m;xc(J("zh-profile-search-word"),this.Ce);var b=Ie(this.dm);if(b&&!b.r){var c=J("zh-profile-search-list");if(c)if(0===b.msg[0])J("zh-profile-list-container").innerHTML='<div id="'+c.id+'"><div style="margin: 20px;color: #999;text-align: center;">抱歉，没有找到任何结果</div></div>';else{var d;d=""+('<div id="'+c.id+'">');d+=b.msg[1]+"</div>";J("zh-profile-list-container").innerHTML=d+'<a href="javascript:;" id="zh-load-more" class="zg-btn-white zu-button-more" style="">更多</a>';if((b=Vb("zm-item",
c))&&b.length)this.Wg=b[b.length-1].id.split("-")[1];this.Wa=k;this.Wa=new ex(J(c.id),k,j);this.Wa.z();this.Wa.Wg=this.Wg;this.Wa.url=this.cm;this.Wa.params.pq=this.Ce;this.Wa.params.type=this.Uj;J("zh-profile-search-query").focus()}}};a.Px=function(){T.call(this)};y(Px,T);
Px.prototype.ca=function(b){this.g=b;this.Na=new Dt;this.Na.o(this.g);this.form=J("zm-profile-expert-editform");this.h().e(this.form,"submit",this.uy);this.h().e(this.Na,["add","remove","sort"],function(){this.Te()});$(".enable").on("change","input",$.proxy(function(){this.Te()},this));var c=J("zh-profile-expert-warning");c&&this.h().e(c,"click",function(b){"close"===b.target.name&&aj(c)});$(".enable input[type='radio']").click(function(b){R(J("zh-profile-expert-reopen-tip"),!Number($(b.target).val()))})};
Px.prototype.Te=function(){$(window).on("beforeunload.profile",v(s("你的更改还未保存，确认离开该页面吗？"),this))};Px.prototype.Af=function(){$(window).off("beforeunload.profile")};
Px.prototype.uy=function(b){b.preventDefault();z.map(this.Na.data,function(b){return b[3]});var b=$(this.form).serializeArray()[0].value,c=$("#zh-expert-topics .item").map(function(){return $(this).data("url-token")}).get();$t("ProfileEditExpertTopicsV2","save",{settings:{enable_expert:b,expert_topic:c}},function(){this.Af();window.location.href="/people/"+S[1]},k,this)};a.Rx=function(){T.call(this);this.ga=k};y(Rx,T);Rx.prototype.B=function(){Rx.n.B.call(this);this.h().e(this.g,"submit",function(b){b.preventDefault();this.save()})};Rx.prototype.save=function(){this.update(Sx(this))};Rx.prototype.update=function(b){if(!(this.ga&&"pending"===this.ga.state())){var c=$(this.g).data("init"),b={method:"save",params:$.extend({},c.params||{},{settings:b})};this.ga=$.post("/node/"+c.nodename,b,v(this.ff,this))}};
Rx.prototype.ff=function(b){b&&(b[0]?this.dispatchEvent({type:"success",data:b}):this.dispatchEvent({type:"error",data:b}))};a.Sx=function(b){b=$(b.g);b=b.serializeArray().concat($("input:checkbox",b).map(function(){return{name:this.name,value:this.checked?this.value:0}}).get());return z.reduce(b,function(b,d){b[d.name]=d.value;return b},{})};a.Tx=function(){T.call(this)};y(Tx,T);a.Ux=function(b){var c=$.Deferred();Ci("取消屏蔽",b,function(b){b?c.resolve():c.reject()});return c.promise()};
Tx.prototype.B=function(){Tx.n.B.call(this);var b=J("zh-topic-block-editor");b&&(new Ft(lh)).o(b);var c=$(".blocked-users",this.m());if(c.length)$(".item",c).on("click",".js-unblock",function(b){var d=$(b.delegateTarget);Ux("取消屏蔽之后，对方将可以：关注你、给你发私信、向你提问、评论你的答案、邀请你回答问题。").then(function(){return $.post("/settings/unblockuser",{uid:d.data("id")})}).then(function(){d.fadeOut(function(){d.remove()});c.children().length||window.location.reload()})});var d=$(".blocked-columns",this.m());if(d.length)$(".item",
d).on("click",".js-unblock",function(b){var c=$(b.delegateTarget);Ux("取消屏蔽之后，你将可以看到来自该专栏的文章。").then(function(){return $.post("/settings/unblockcolumn",{id:c.data("id")})}).then(function(){c.fadeOut(function(){c.remove()});d.children().length||window.location.reload()})})};a.Vx=function(){T.call(this);this.VW=[];this.UX="/profile/validate"};y(Vx,T);
Vx.prototype.z=function(){var b=this,c=$("#zh-settings-noti-form-wrapper>form")[0];if(c){var d=new Rx;d.o(c);d.addEventListener(["success","error"],function(b){window.scrollTo(0,0);Gs(H.Ka(b.data),3E3)})}var e=$(".js-ajax-form");e.submit(function(b){var c=$(b.target),b=c.attr("action")||location.href;$.post(b,c.serialize()).done(function(b){Gs(H.Ka(b),5E3);c.hasClass("unsubscribe")&&(e.remove(),$(".settings-section").remove())});return m});$(".js-unsubscribe-other-reason").on("change",function(b){$(b.target).parent().siblings().find(".zg-form-text-input").toggle()});
var g=$(".feedback-form");g.submit(function(){var b=g.attr("action");$.post(b,g.serialize()).done(function(){g.before('<div style="font-size:13px;color:black;margin-bottom:20px">感谢您的反馈！</div><a href="/">&laquo; 返回知乎</a>');g.remove()});return m});$("#weibopageenable").on("change",function(b){b=$(b.target);$.post("/node/SettingsWeiboPageV2",{method:b.is(":checked")?"enable":"disable"}).done(function(b){b.r?U(b.msg):Gs([m,"保存成功"])});return m});c=$("#js-settings-account-form");if(c.length){var h=xk(function(){new Zl(J("password"))}),
d=$("#url_token"),l=$("#js-url-preview .token");d.on("input change keyup",function(){l.text($.trim(this.value))});var n=$("#email"),q=function(){$("#js-email-confirm").show();n.off("focus",q);h()};n.one("focus",q);$(function(){document.activeElement===n.get(0)&&q()});$(".resend-mail",c).click(function(){var b=$(this);Li.dispatchEvent("/activation/resend-email");$.post("/settings/resend_reset_email",function(c){c.r?U(c.msg):b.replaceWith("已发送")});return m});$(".zg-form-text-input",c).each(function(){function b(){this.value!==
this.defaultValue&&(d.hide(),c.off("change input keyup",b))}var c=$(this),d=c.next(".validate-error");if(d.length)c.on("change input keyup",b)});var d=new ks,r=$(".rename-tab",c);d.o(r.get(0));var w=function(){$("input[placeholder]:visible",r).placeholder()};d.on("select",w);var F=$(".rename-button",c),c=function(){F.remove();r.show();w()};F.one("click",c);"#rename-section"===location.hash&&c()}c=$("#js-form-account-password");c.length&&($("input[placeholder]",c).each(function(){new Zl(this)}),c.validate({messages:{np:{required:'<i class="icon icon-validate-error"></i>新密码未填写'},
op:{required:'<i class="icon icon-validate-error"></i>旧密码未填写'},rp:{required:'<i class="icon icon-validate-error"></i>确认密码未填写'}},errorClass:"validate-error"}));(c=J("zh-setting-page-black-list-wrap"))&&(new Tx).o(c);(c=J("zh-setting-page-bind-wrap"))&&(new rx).o(c);$(".zu-main-content-inner form").on("change","input, textarea, select",function(){b.en("SettingsPage")}).on("submit",function(){b.Sk("SettingsPage")})};
Vx.prototype.en=function(){$(window).on("beforeunload.SettingsPage",v(s("你的修改还未保存，确认离开该页面吗？"),this))};Vx.prototype.Sk=function(){$(window).off("beforeunload.SettingsPage")};a.Wx=function(){N.call(this);this.S=k;this.qj=0;this.zI="/oauth/friends/sina";this.KI="/invitation/sina";this.vc=new Id(200)};y(Wx,Yk);t=Wx.prototype;t.z=function(){this.Al||(this.Al=j,this.v(),this.fb(),Xx(this))};t.show=function(){this.z();this.S.D(j);var b=new Mb(this.S.m().offsetLeft,this.S.m().offsetTop);b.y=102;ag(this.S.m(),b)};t.v=function(){var b=J("zh-invitation-sina-diag");b&&(this.g=b,this.S=new yi(k,m),this.S.Ma("邀请微博好友"),hi(this.S,k),this.S.X().appendChild(this.g))};
t.ra=function(b){if("cancel"===b.target.name)this.S.D(m);else if("invite"===b.target.name){var b=Vb("zm-item-checkbox-right",this.wj),c=[];z.forEach(b,function(b){b.checked&&(c.push(b.value),b.checked="")},this);c&&c.length&&(this.Ny=new V(j),this.h().e(this.Ny,"complete",this.lJ),this.Ny.ajax(this.KI,"sinaids="+c.join(",")))}};
a.Yx=function(b,c){b.qj=c?b.qj+1:b.qj-1;b.uE.innerHTML=b.qj+""},a.Xx=function(b,c){b.bF||(b.bF=j,b.xhr=new V(j),oe(b.h(),b.xhr,"complete",b.ef),b.xhr.ajax(b.zI,c?"force=1":""))};t.ef=function(){this.bF=m;var b=Ie(this.xhr);b&&!b.r?this.setData(b):U(b.msg)};
t.setData=function(b){this.SK=j;this.BT.innerHTML=+b[0];this.qj=+b[1];this.uE.innerHTML=this.qj+"";this.data=b=b[3];var c=[];z.forEach(b,function(b){c.push(['<div class="zm-item zm-item-h50"><input type="checkbox" value="',b[0],'" class="zm-item-checkbox-right" /><img class="zm-list-avatar-medium" src="',b[2],'" /><div class="zm-list-content"><strong class="zg-gray-normal">',b[1],'</strong><div class="zg-gray-normal">',b[3],"</div></div></div>"].join(""))},this);this.wj.innerHTML=c.join("")};
t.fb=function(){this.ht=K("zg-form-text-input",this.g);(new Fo("搜索微博好友")).o(this.ht);this.Gi=K("zm-command",this.g);this.wj=J("zh-invitation-sina-friends-list");this.iR=J("zh-invitation-sina-force-refresh");this.h().e(this.iR,"click",function(){this.wj.innerHTML="列表刷新中，请稍侯...";Xx(this,j)});this.h().e(this.wj,"click",this.hP);var b=Ub("strong",k,this.g);this.BT=b[0];this.uE=b[1];this.h().e(this.ht,"focus",this.Zo).e(this.ht,"blur",this.ji).e(this.vc,Jd,this.kQ);this.h().e(this.Gi,"click",this.ra)};
t.hP=function(b){var c=Ic(b.target,k,"zm-item");if(c){var d=k,e=Ub("input",k,c)[0];if(E.has(c,"zm-item-active"))E.remove(c,"zm-item-active"),Yx(this,j),d=m;else{var g;0>=this.qj?(U("您的邀请码已经用完"),g=m):g=j;g?(E.add(c,"zm-item-active"),Yx(this,m),d=j):"INPUT"===b.target.tagName&&b.preventDefault()}"INPUT"!==b.target.tagName&&(e.checked=d);b.stopPropagation()}};t.Zo=function(){this.vc.start()};t.ji=function(){this.vc.stop()};
t.kQ=function(){if(this.SK){this.items||(this.items=Vb("zm-item",this.wj));var b=this.ht.value;b==k||""===b?z.forEach(this.items,function(b){R(b,j)}):z.forEach(this.data,function(c,d){this.items[d]&&(b===c[0]||-1<c[1].indexOf(b)?R(this.items[d],j):R(this.items[d],m))},this)}};t.lJ=function(){var b=Ie(this.Ny);b&&!b.r?(U("邀请发送完毕"),this.S.D(m)):U(b.msg)};a.Zx=function(){N.call(this);this.tI="/oauth/unbind/sina"};y(Zx,Yk);Zx.prototype.z=function(){var b=J("zh-invite-send-invite-sina");b&&this.h().e(b,"click",this.rS);(b=J("zh-invitation-cancel-bind-sina"))&&this.h().e(b,"click",this.pQ)};Zx.prototype.rS=function(){this.mH||(this.mH=new Wx);this.mH.show()};
Zx.prototype.pQ=function(){Ci("解除绑定","你确定要解除与新浪微博的绑定吗？",function(b){if(b){var c=new V(j);oe(this.h(),c,"success",function(){var b=Ie(c);b&&!b.r?window.location.reload():U(b.msg)});c.ajax(this.tI)}},this)};a.$x=function(b,c,d,e,g){Ou.call(this,b,c,g);this.$v=d||"people";this.zL=e||["zg-follow","zg-unfollow"]};y($x,Ou);$x.prototype.z=function(b){$x.n.z.call(this,b);this.fb(this.g)};$x.prototype.qA=ca("qA");$x.prototype.fb=function(b){if(this.qA){var c=new Dx,d=this.zL;c.cw=this.$v;c.bw=d||c.bw;this.Tm&&c.aH(this.Tm);c.o(b)}};$x.prototype.aH=ca("Tm");a.ay=function(b,c,d,e){N.call(this);this.g=b;this.$v=c||"people";this.yL=d||["zg-btn-follow","zg-btn-unfollow"];this.text=e||["关注","取消关注"]};y(ay,Yk);ay.prototype.z=function(){this.h().e(this.g,"click",this.mo)};ay.prototype.mo=function(b){b=Jk(this.g,b.target);"focus"===(b&&b.name)&&un(b,this.$v,k,this.yL,{follow_text:this.text[0],unfollow_text:this.text[1]})};a.by=function(b){N.call(this);this.url=b||"/topic"};y(by,Yk);t=by.prototype;t.o=function(b){this.element=b;var c=$("<ul>");this.HH=$("<li>");c.append(this.HH);$(b).append(c);this.IH||(this.IH=j,this.fA=new V(j),oe(this.h(),this.fA,"success",this.BP),this.fA.ajax(this.url,k,"POST"))};t.BP=function(){var b=Ie(this.fA);b&&(b&&b.r?U(b.msg):(cy(this,this.HH,b.msg),this.IH=m,this.B()))};t.B=function(){this.h().e(this.element,"click",this.mo)};
t.mo=function(b){var c=(b=b.target)?b.name:"";if(c)switch(c){case "load":case "loadmore":if(!this.Xn){var c=b.getAttribute("data-token"),d=b.getAttribute("data-parent");this.Xn=j;this.Aj=new V(j);oe(this.h(),this.Aj,"success",this.Qp);this.mz=b.parentNode;this.mz.innerHTML='<span class="zg-gray">加载中...</a>';this.Aj.ajax(this.url+"?child="+c+"&parent="+d,k,"POST")}break;case "topic":window.location.href=b.href}};
a.cy=function(b,c,d){var e=d[0],g="";"topic"!==e[0]&&e[3]&&(g='data-parent="'+e[3]+'"');c.html('<a href="'+("topic"===e[0]?"/topic/"+e[2]+"/organize/entire":"javascript:;")+'" data-token="'+e[2]+'" '+g+' name="'+e[0]+'">'+e[1]+"</a><ul class='zm-topic-organize-list'></ul>");"topic"!==d[0][0]&&c.addClass("zm-topic-organize-loadmore");c=$("ul",$(c));if(1<d.length){d=d[1];for(e=0;e<d.length;e++){var g=d[e],h=$("<li>").addClass("zm-topic-organize-item");c.append(h);cy(b,h,g)}}};
t.Qp=function(){var b=Ie(this.Aj);if(b)if(b&&b.r)U(b.msg);else if(b=b.msg,b[1]){$(this.mz).hide();for(var c=$(this.mz.parentNode),d=0;d<b[1].length;d++){var e=b[1][d],g=$("<li>").addClass("zm-topic-organize-item");"topic"!==e[0][0]&&g.addClass("zm-topic-organize-loadmore");c.append(g);cy(this,g,e)}this.Xn=m}};a.dy=function(b){var c={kp:m,VX:m};return function(d){if(d===m)return m;d={};H.extend(d,c,b||{});if(d.kp&&!S.zr)return Di("提示信息",'<a href="/question/23261456" target="_blank">如何参与知乎话题的公共编辑？</a>'),m;if(d.Ul&&!fh.jL)return Di("提示信息",'<p>创建较久或已有较多讨论的问题限制公共编辑</p><p><a href="/question/24501563" target="_blank">如何参与问题公共编辑？</a></p>'),m}};a.ey=function(b,c,d){Qr.call(this,b,c,d)};y(ey,Qr);ey.prototype.ff=function(b){ih[0][0]===b?this.ii():ey.n.ff.apply(this,arguments)};ey.prototype.cB=function(b){if(b=Ie(b.target))b.r?U(b.msg):b.msg&&(window.location.href=b.msg)};a.fy=function(){T.call(this);var b=ih;this.pf=b[0][3];this.dA=b[0];this.YX=b[1];this.qX=b[2];this.zX=b[3];this.fq=b[4];this.wx=b[5];this.Ng="topic"};y(fy,T);t=fy.prototype;t.z=function(){ys.H(this);this.o(document.body)};
t.B=function(){function b(b){b&&b.msg&&U(b.msg)}fy.n.B.call(this);var c=J("zh-topic-side-head");if(c){var d=K("zu-entry-focus-button",c);(this.xL=d)&&this.h().e(d,"click",function(){un(d,"topic","",["zg-btn-green","zg-btn-white"])});(this.Rf=J("zh-topic-operation-menu"))&&this.h().e(this.Rf,"click",this.yz)}if(c=J("zh-current-topic-bio")){var e=new Qr(j,"/topic/bio/update","bio");e.params=["tid="+this.pf];e.Gb='<a href="javascript:;" name="edit">你在 '+this.dA[0]+" 话题中的经验</a>";e.tC=j;e.o(c)}(c=J("zh-topic-top-answerer"))&&
(new ay(c,"people",["zg-follow","zg-unfollow"])).z();if(c=J("zh-topic-direct-question-list"))c=new $x(c,k,"question",k,j),c.di("question-item"),c.z();if(c=J("zh-topic-title"))this.Wc=new ey(m,"/topic/update","title"),this.Wc.params=["tid="+this.pf],this.Wc.addEventListener("beforeedit",dy({kp:j})),this.Wc.o(c),$(c).on("click",".js-pin",function(){var b=$(this),c=b.attr("data-action");$.post(c,{tid:ih[0][3]}).done(function(c){c.r?U(c.msg):(c=b.hasClass("pin")?'<a href="javascript:;" data-action="/pin-topic/remove" class="js-pin zg-gray unpin topic-hover-content"><i class="z-icon-unpin"></i>取消固定</a>':
'<a href="javascript:;" data-action="/pin-topic/add" class="js-pin zg-gray pin topic-hover-content"><i class="z-icon-pin"></i>固定话题</a>',b.replaceWith(c))})});if(c=J("zh-topic-desc"))e=$(c).find(".zm-editable-content").data("editable-maxlength"),this.Rk=new Sr(j,"/topic/update","description",e),this.Rk.Gb='<a href="javascript:;" name="edit">添加话题描述</a></div>',this.Rk.params=["tid="+this.pf],this.Rk.mq=m,this.Rk.SH=m,this.Rk.addEventListener("beforeedit",dy({kp:j})),this.Rk.o(c);if(c=J("zh-topic-faq"))this.Xq=
new Sr(j,"/topic/"+encodeURIComponent(ih[0][1])+"/faq","content",400),this.Xq.Gb='<div class="zm-topic-faq-container"><div class="zg-gray-normal">常见问题是该话题下经常会提到的问题的整理，以便后来者查阅（<a href="http://www.zhihu.com/question/20388061" class="zg-link-litblue">如何创建？</a>）</div><a href="javascript:;" name="edit" class="zg-link-litblue"><span class="zg-blue-edit"></span>为「'+ih[0][0]+"」添加常见问题</a></div>",this.Xq.nY=function(b){return!b?"":b.replace(/(<\/?(?!ul|li|a|br)[^>\/]*)\/?>/gi,"")},this.Xq.mq=m,this.Xq.o(c);
if(oh)$("div.topic-avatar").addClass("disabled");else if(c=K("zm-entry-head-avatar-edit-button")){var g=new Vl(2,ih[0][3]);g.o(c);var h=K("zm-avatar-editor-preview");O(g,"beforepost",function(){$("<div class='avatar-edit-preview-loading topic'><span></span></div>").appendTo(h.parentNode)});O(g,"success",function(){$.post("/topic/"+ih[0][1]+"/avatar",{avatar_path:g.getData().id}).then(function(){h&&(h.src=g.getData().url)}).always(function(){$(".avatar-edit-preview-loading").remove()})});this.h().e(g,
"beforeopen",pf(dy({kp:j}),sn(ha,j)))}if(c=J("zh-topic-feed-list"))e=new xu,this.H(e),e.la("locationSource",{hs:0,offset:function(b){return z.Qd(b).getAttribute("data-score")}}),e.la("childConstructor",{factory:dx}).la("expandLimit"),e.o(c),this.h().e(e,"click!",function(b){"comment"===b.namespace&&b.xc.fill("category",this.Ng).fill("label","topic_activity")});if(c=J("zh-topic-top-page-list"))e=new xu({Vg:m}),this.H(e),e.la("childConstructor",{factory:dx}).la("expandLimit"),e.o(c),this.h().e(e,"click!",
function(b){"comment"===b.namespace&&b.xc.fill("category",this.Ng).fill("label","topic_activity")});var l=this;l.Wa&&l.h().e(l.Wa,"afterload",function(b){Y.Z({type:"ga_click_topic_more",data:b.data,target:l.Wa.Xb})});if(c=J("zh-topic-followers-list-wrap"))c=new $x(c,["/topic",encodeURI(this.dA[1]),"followers"].join("/"),k,["zg-btn-follow","zg-btn-unfollow"],j),c.di("zm-person-item"),c.z();if(J("zh-topic-organize-page-wrap")){if(c=J("zh-topic-organize-parent-editor"))S.zr?(e=new rt(k,this.pf,j),e.ys=
j,e.o(c),e.addEventListener("remove_tag",function(b){(b=b.data&&b.data.id)&&$("#wedge-"+b).remove()})):gy(c);if(c=J("zh-topic-organize-child-editor"))S.zr?(e=new rt(k,this.pf,m),e.ys=j,e.o(c),$("a.entire-link").insertAfter(e.cn).show()):gy(c);$("#zm-topic-manage-relation").on("change",'[type="checkbox"]',function(){var b=$(this).closest("li").attr("id").split("-")[1];$.post("/topic/update",{action:"set_topic_edge",parent_topic_id:b,topic_id:ih[0][3],edge:this.checked^0}).done(function(b){b&&b.msg&&
U(b.msg)})});this.vu=J("zh-topic-alias-input");new Zl(this.vu,"输入话题别名");this.wu=J("zh-topic-alias-list");this.h().e(J("zh-topic-alias-container"),"click",this.nQ);if(c=J("zh-topic-merge"))this.Na=new Gt,this.Na.o(c);(c=J("zh-topic-merge-btn"))&&this.h().e(c,"click",this.QP)}(c=J("zh-topic-organize-page-children"))&&(new by("/topic/"+encodeURIComponent(ih[0][1])+"/organize/entire")).o(c);if(c=J("zh-topic-side-related-topics"))this.mR=c,this.Xy=new V(m),this.h().e(this.Xy,"complete",this.ZP),this.Xy.ajax("/topic/related?tid="+
this.pf);J("zh-topic-admin-page-wrap")&&(c=J("zh-topic-del-btn"))&&this.h().e(c,"click",this.xP);if(c=J("zh-topic-log-list"))(new $x(c,k,k,k,j)).z(),$(c).on("click",'a[name="revert"]',pf(function(b){b!==m&&Lx(this)},dy({kp:j})));(c=K("zm-topic-search-input-new"))&&new Zl(c,"在话题中搜索");var n=$(c);dh.sc||n.focus(function(){n.addClass("stretch-to")}).blur(function(){n.removeClass("stretch-to")});(c=K("zm-topic-ask-in-topic"))&&this.h().e(c,"click",this.rt);(c=K("zm-topic-feed-container"))&&(new ay(c,"question",
["zg-follow","zg-unfollow"])).z();(c=J("zh-topic-side-children-list"))&&(new ay(c,"topic",["zg-follow","zg-unfollow"])).z();(this.Nr=J("zh-topic-info-add"))&&this.h().e(this.Nr,"submit",this.LP);(this.lE=K("zm-topic-info-content-main",this.g))&&this.h().e(this.lE,"click",this.JP);$("#zh-topic-manage-info-form").on("change",'input[type="radio"]',function(){$.post("/topic/"+ih[0][1]+"/information/manage",{info:$(this).val(),action:"change"}).done(b)});$("#zh-topic-manage-relation-form").on("change",
'input[type="radio"]',function(){$.post("/topic/update",{action:"set_topic_weaknode",topic_id:ih[0][3],weak:$(this).val()}).done(b)});$("#zh-topic-manage-lock-form").on("change",'[type="checkbox"]',function(){$.post("/topic/lock",{url_token:ih[0][1],lock_type:this.name,lock_value:$(this).is(":checked")?1:0}).done(b)});(c=J("zh-topic-info-add"))&&z.forEach(oc(c),function(b){var c;b&&(b.getAttribute&&(c=b.getAttribute("data-placeholder")))&&new Zl(b,c)});$(".js-may-disable").click(sn(ha,j))};
t.QP=function(){this.Eq=this.Na.iC;if(!this.lF&&this.Eq){this.lF=j;this.Xx=new V(j);oe(this.h(),this.Xx,"success",this.mJ);this.Xx.ajax("/topic/"+encodeURIComponent(ih[0][1])+"/demand","action=merge&target_topic_id="+this.Eq[3]);var b=J("zh-topic-merged-msg");R(J("zh-topic-merge"),m);R(b,j);b=Ub("a",k,b)[0];b.href="/topic/"+this.Eq[1];b.innerHTML=this.Eq[0];this.Na&&(this.Na.eb.value="")}};t.mJ=function(){var b=Ie(this.Xx);b&&b.r?U(b.msg):this.lF=m};
t.xP=function(){this.qC||(this.qC=j,this.uv=new V(j),oe(this.h(),this.uv,"success",this.jJ),this.uv.ajax("/topic/"+encodeURIComponent(ih[0][1])+"/demand","action=remove"))};t.jJ=function(){var b=Ie(this.uv);b&&b.r?U(b.msg):(b=J("zh-topic-del-msg"),R(J("zh-topic-del-btn"),m),R(b,j),this.Na&&(this.Na.eb.value=""),this.qC=m)};
t.nQ=function(b){if((b=b.target)&&b.name)if("add"===b.name){if(b=this.vu.value)this.xu=new V(j),oe(this.h(),this.xu,"complete",this.iJ),this.xu.ajax(window.location.href,"action=add_alias&alias="+encodeURIComponent(b))}else"remove"===b.name?(this.Yy=new V(j),b=b.parentNode.getAttribute("data-token"),oe(this.h(),this.Yy,"complete",this.oJ),this.Yy.ajax(window.location.href,"action=remove_alias&alias_token="+b)):"remove-merged"===b.name&&(this.$y=new V(j),b=b.parentNode.getAttribute("data-token"),oe(this.h(),
this.$y,"complete",this.pJ),this.$y.ajax("/topic/"+encodeURIComponent(ih[0][1]+"/demand"),"action=remove&target_topic_id="+b))};t.pJ=function(){var b=Ie(this.$y);b&&b.r?U(b.msg):hy(this,b.msg)};t.oJ=function(){var b=Ie(this.Yy);b&&b.r?U(b.msg):hy(this,b.msg)};a.hy=function(b,c){var d=Ub("li",k,b.wu);z.forEach(d,function(b){b.getAttribute("data-token")===c[1]&&R(b,m)})};
t.iJ=function(){var b=Ie(this.xu);if(b&&b.r)U(b.msg);else{var b=b.msg,c=L("li");c.setAttribute("data-token",b[1]);c.innerHTML=b[0]+' <a name="remove" href="javascript:;" class="zg-link-gray">移除</a>';this.wu.appendChild(c);this.vu.value="";R(this.wu.parentNode,j)}};a.gy=function(b){hc(b,fc('<a href="/question/23261456" class="zg-link-gray-normal"><i class="icon-info" style="vertical-align: -3px; margin-right: 6px"></i>如何参与知乎话题的公共编辑？</a>'))};
t.yz=function(b){this.zy?this.ab.R()?this.ab.D(m):(this.ab.D(j),b.stopPropagation(),b.preventDefault(),this.Ck()):(b.stopPropagation(),b.preventDefault(),this.nj(),this.Ck());this.zy=j};t.Ck=function(){oe(this.h(),document,"click",function(){this.ab.D(m)})};
t.nj=function(){var b=J("zh-topic-side-head"),c=this.Rf.getAttribute("data-auth");this.ab=new Nu;this.Sw=j;"f-topic-manage"===c&&this.ab.Fa(this.tQ=new Ku("管理话题"));this.ab.Fa(this.uQ=new Ku("组织话题"));this.ab.Fa(this.sQ=new Ku("话题日志"));this.Sw&&(this.ab.W(b),this.h().e(this.ab,"action",this.fj))};t.fj=function(b){var c="";b.target===this.tQ?c="admin":b.target===this.uQ?c="organize":b.target===this.sQ&&(c="log");window.location.href=["/topic",this.dA[1],c].join("/")};
t.ZP=function(){var b=Ie(this.Xy);if(b&&!b.r){var c=[];z.forEach(b,function(b){c.push(zk(b,k,j))});this.mR.innerHTML=c.join("")+'<div class="zg-clear"></div>';b.length&&R(J("zh-topic-side-related-topics-wrap"),j)}};
t.JP=function(b){var c=b.target;c&&c.name&&"remove"===c.name&&(this.HN=c,this.mE||(this.mE=j,this.cx=new V(j),this.h().e(this.cx,"success",this.KP),b="token="+this.HN.parentNode.getAttribute("data-token")+"&action=remove&element="+encodeURIComponent($(b.target).prev("[data-element]").text()),this.cx.ajax("/topic/"+ih[0][1]+"/information/manage",b,"POST")))};t.KP=function(){this.mE=m;var b=Ie(this.cx);b&&(b.r?U(b.msg):b.msg&&(b=b.msg,K("zm-topic-info-content-main",this.g).innerHTML=$(b).html()))};
t.LP=function(b){b.preventDefault();this.nE||(this.nE=j,this.dx=new V(j),this.h().e(this.dx,"success",this.IP),b=oc(this.Nr),this.dx.ajax("/topic/"+ih[0][1]+"/information/manage","title="+b[0].value+"&content="+b[1].value+"&url="+b[2].value+"&action=add","POST"))};t.IP=function(){this.nE=m;var b=Ie(this.dx);b&&(b.r?U(b.msg):b.msg&&(b=b.msg,K("zm-topic-info-content-main",this.g).innerHTML=$(b).html(),b=oc(this.Nr),z.forEach(b,function(b,d){3>d&&(b.value="")})))};
t.rt=sn(function(){if(!ts()){var b=Vr.O();b.show();var c=K("zm-topic-search-input-new");c.value&&Yr(b,c.value);b.Na.data.length||b.Na.Xj(ih[0])}},j);a.iy=function(b){T.call(this,b)};y(iy,T);iy.prototype.v=function(){this.g=this.K().v("FORM",{method:"POST",style:"display:none"})};iy.prototype.post=function(b,c,d){var e=this.m();e||(this.W(),e=this.m());e.action=c||"";e.target=d||"";var c=e,g,h=new Ss;for(g in b)d=b[g],na(d)?z.forEach(d,v(this.kB,this,h,g)):this.kB(h,g,d);c.innerHTML=h.toString();e.submit()};iy.prototype.kB=function(b,c,d){b.append('<input type="hidden" name="',Wa(c),'" value="',Wa(d),'">')};a.jy=function(b){return $.get("/node/ExploreAnswerListV2",{params:JSON.stringify({offset:b,type:"day"})})},a.ky=function(b){return $.get("/node/ExploreHotFavlistsInnerV2",{params:JSON.stringify({offset:b})})},a.ly=function(b){return $.get("/node/ExploreAnswerListV2",{params:JSON.stringify({offset:b,type:"month"})})};a.my=function(){N.call(this)};y(my,Yk);my.prototype.z=function(){var b=bt(new wf(window.location.href),"group_id");b&&(this.Ej=new V(m),oe(this.h(),this.Ej,"success",this.Gy),b&&this.Ej.ajax("/noti7/read","group_id="+b,"POST"))};my.prototype.Gy=function(){var b=Ie(this.Ej);if(b&&!b.r&&b.msg){var c=b.msg;if(c===j||"true"===c||"True"===c)return;this.dP=b.msg;this.dispatchEvent("change")}(b=Xn)&&Yn(b)};a.ny=function(){T.call(this);var b=kh||[0,0];this.gs=b[0];this.visible=!!b[1];this.Ng="collection"};y(ny,T);t=ny.prototype;t.z=function(){ys.H(this);this.o(document.body)};
t.B=function(){ny.n.B.call(this);var b=J("zh-list-side-head");if(b){var c=K("zu-entry-focus-button",b);(this.xL=c)&&this.h().e(c,"click",function(){un(c,"favlist","",["zg-btn-green","zg-btn-white"])});(this.Rf=J("zh-list-operation-menu"))&&this.h().e(this.Rf,"click",this.yz)}(b=J("zh-single-answer-author-info"))&&(new ay(b)).z();(b=J("zh-list-create-new-list"))&&this.h().e(b,"click",this.lS);(b=J("zh-fav-list-side-bar-creator"))&&(new ay(b)).z();(b=J("zh-fav-list-side-bar-report"))&&this.h().e(b,
"click",this.Kl);(this.kk=J("zh-favlist-webshare-container"))&&this.h().e(this.kk,"click",this.Bz);if(this.Rc=J("zh-list-meta-wrap"))this.h().e(this.Rc,"click",this.Kl),this.vW=J("zh-list-comment-num"),bt(new wf(location.href),"fc")&&oy(this);(b=J("zh-favlists-wrap"))&&(new $x(b,k,"favlist",k,j)).z();if(b=J("zh-list-answer-wrap")){$(b).on("click","a[name=unfavo]",$.proxy(this.mN,this));var d=new xu({Vg:m});this.H(d);d.la("childConstructor",{Ji:Yw}).la("expandLimit");d.o(b);this.h().e(d,"click!",function(b){"comment"===
b.namespace&&b.xc.fill("category",this.Ng).fill("label","collection_answer")})}(b=J("zh-favlist-log-list-wrap"))&&(new $x(b,k,"favlist",k,j)).z();(b=J("zh-favlist-following-wrap"))&&(new $x(b,k,"favlist",k,j)).z();if(b=J("zh-favlist-followers-wrap"))b=new $x(b,k,"people",["zg-btn-follow","zg-btn-unfollow"],j),b.di("zm-profile-section-item"),b.qA(j),b.z();this.h().e(window,"hashchange",this.RX);this.jx();this.fo=new my;this.fo.z()};
t.mN=function(b){var b=b.target,c=b.id.split("-"),d=c[1],c=c[2];(new V(j)).ajax("/collection/remove","answer_id="+d+"&favlist_id="+c);if(c=Ic(b,"div","zm-item"))b=Vb("zm-item-answer",c),1===b.length?M(c):(b=z.find(b,function(b){return b.getAttribute("data-aid")===d}))&&M(b.parentNode)};t.Bz=function(b){var b=Jk(this.kk,b.target),c=location.pathname.match(/^\/collection\/(\w+)/);b&&(b.name&&c)&&new fv(["分享收藏夹","collection",c[1],{fid:kh[0]}],"tb-webshare-"+b.name)};
t.lS=sn(function(){fx.O().show(j)},j);t.yz=function(b){this.zy?this.ab.R()?this.ab.D(m):(this.ab.D(j),b.stopPropagation(),b.preventDefault(),this.Ck()):(b.stopPropagation(),b.preventDefault(),this.nj(),this.Ck());this.zy=j};t.Ck=function(){oe(this.h(),document,"click",function(){this.ab.D(m)})};
t.nj=function(){var b=J("zh-list-side-head");this.ab=new Nu;this.Sw=j;this.visible||this.ab.Fa(this.wQ=new Ku("设置为公开"));this.ab.Fa(this.rQ=new Ku("删除此收藏夹"));this.Sw&&(this.ab.W(b),this.h().e(this.ab,"action",this.fj))};t.Kl=function(b){b=b.target;switch(b&&b.name){case "report-favlist":Au("favlist",this.gs);break;case "edit":nx(fx.O());break;case "addcomment":oy(this);this.oa.sf();this.oa.fc()&&this.oa.mi("view_comments",parseInt(Fc(b),10)||0);break;case "remove":py(this)}};
t.fj=function(b){b.target===this.wQ?Ci("确定设置收藏夹为公开？","收藏夹设置为公开后，将不能再设置为私密。",function(b){b&&(this.GX=!this.visible,this.QH=new V(j),this.h().e(this.QH,"complete",function(){window.location.reload()}),this.QH.ajax("/collection/update","favlist_id="+this.gs+"&is_public=1"))},this):b.target===this.rQ&&py(this)};a.py=function(b){Ci("删除收藏夹","你确定要删除这个收藏夹吗？",function(b){b&&(b=new Kk,b.add("favlist_id",this.gs),b.add("_xsrf",(new Lf(document)).get("_xsrf")),(new iy).post($s(b),"/collection/delete"))},b)};
t.jx=function(){var b=1,c=$("ul.hot-favlists"),d=k;$("#js-hot-fav-switch").click(function(){d&&"pending"===d.state()||(b=5<=b?1:b+1,d=ky(b).done(function(b){c.html(b)}))})};a.oy=function(b){b.oa||(b.oa=new Ew(b.gs,"favlist"),b.H(b.oa),b.h().e(b.oa,"click!",function(b){"comment"===b.namespace&&(b.xc.fill("category",this.Ng).fill("label","collection"),b.xc.action=b.xc.action.replace("favlist","collection"))}),Iw(b.oa,b.Rc,$(".toggle-comment",b.Rc)[0]))};a.vy=function(b){if(qy){this.jn=b;this.ui=$(this.jn.g);var b=this.ui.find('meta[itemprop="ZReactor"]'),c=$.extend({},b.data("meta"),{create:this.ui.find(".source .time").data("timestamp"),offset:$(".feed-item").index(this.ui)+1});this.data={mid:sh.ga_vars.user_hash,object_type:ry[this.ui.data("type")],object_id:b.data("id"),object_meta:c,context:"topstory2",others:""};var d=this;vu(this.ui[0],function(){sy(d,"display")},this.jn);this.jn.h().e(this.jn,"expand",function(b){b.target instanceof Sw&&sy(d,
"expand_"+d.data.object_type)}).e(this.jn,"collapse",function(b){b.target instanceof Sw&&sy(d,"collapse_"+d.data.object_type)});this.ui.on("click",'a[name="nohelp"]',function(){var b=!!$(this).data("revert");sy(d,b?"unhelpful":"revert_unhelpful");$(this).data("revert",!b)});$.each({'a.zg-follow:not([data-follow="t:link"])':"follow_"+ty[d.data.object_type],'a.zg-unfollow[data-follow="q:link"]':"unfollow_"+ty[d.data.object_type],"a.toggle-comment":"expand_comments",'a[name="addnew"]':"comment",".content h2":"open_"+
uy[d.data.object_type],'a[name="dislike"]':"uninterest","a.revert":"revert_uninterest","a.ignore.close":"confirm_uninterest","button.up.pressed":"vote_up_"+d.data.object_type,"button.down.pressed":"vote_down_"+d.data.object_type,"button.up:not(.pressed)":"revert_vote_up_"+d.data.object_type,"button.down:not(.pressed)":"revert_vote_down_"+d.data.object_type,'a[name="favo"]':"collect_answer",'a[name="thanks"]':"thanks",'a[name="share"]':"share",'a[name="report"]':"report","a.answer-date-link":"open_answer"},
function(b,c){d.ui.on("click",b,function(){sy(d,c)})});this.MN()}},a.qy=!!$("#is-topstory2").length,a.ry={q:"question",a:"answer",p:"article",c:"column",r:"roundtable"},a.ty={question:"question",answer:"question",article:"column",column:"column",roundtable:"roundtable"},a.uy={question:"question",answer:"question",article:"article",column:"column",roundtable:"roundtable"},a.wy=function(b){$.ajax({type:"POST",url:"/zreactor/deliver",data:JSON.stringify(b),contentType:"application/json",processData:m})},
a.sy=function(b,c){var d=$.extend({},b.data,{action_type:c});d.object_id&&("display"===c?b.UQ(d):wy(d))},a.xy=[],a.yy=Wk(550,function(){xy.length&&(wy(xy),xy=[])});vy.prototype.UQ=function(b){xy.push(b);yy()};
vy.prototype.MN=xk(function(){O(Y,"click_feed_fresh",function(b){wy({mid:sh.ga_vars.user_hash,object_type:"btn",object_id:2,object_meta:{load_items:b.data.count},action_type:"click",context:"topstory2",others:""})});O(Y,"topstory_feed_more",function(){wy({mid:sh.ga_vars.user_hash,object_type:"btn",object_id:1,object_meta:{next:$("#js-home-feed-list .feed-item").length+1},action_type:"click",context:"topstory2",others:""})})});a.zy=function(b,c,d){Ou.call(this,b,c,d)};y(zy,Ou);zy.prototype.ef=function(b){b&&!b.r&&(b=b.msg,b.length?(R(this.Xb,0<b.length),this.offset+=b.length,this.Yp(b),Ru(this,m),Uu(this)):this.sk.hide())};a.Ay={ROUNDTABLE_ADD_RELATED:"roundtable",ARTICLE_VOTE_UP:"post_vote",ARTICLE_CREATE:"post_create",RECOMMENDED:"feed_recommended",QUESTION_FOLLOW:"feed_question_follow",QUESTION_CREATE:"feed_question",ANSWER_VOTE_UP:"feed_answer_vote",ANSWER_CREATE:"feed_answer_answer"};
zy.prototype.lN=function(b){var c=b.currentTarget.g.getAttribute("data-feedtype"),c=Ay[c];"comment"===b.namespace&&c&&b.xc.fill("category","feed").fill("label",c)};zy.prototype.Gj=function(b){var c=dx(b);this.H(c);this.h().e(c,"click!",this.lN);c.o(b);new vy(c);return c};zy.prototype.sG=function(b){return{params:b,method:"next"}};a.By=function(){this.interval=3E4};ia(By);a.Dy=function(b,c){if(!b.vc||c)c&&clearInterval(b.vc),b.vc=setInterval(v(function(){Cy(this)},b),b.interval)},a.Cy=function(b,c){$(".feed-item-hook .time").each(function(){$(this).text(Ut($(this).data("timestamp")))});c&&Dy(b,c)};a.Ey=function(){T.call(this);this.zx={};this.xs=[];this.hO="old"===$("#feed-ver").val();this.GE=!!$("#is-topstory").length;this.sO=!!$("#is-topstory2").length;this.QC=this.hO?"zm-item":"feed-item-hook";window._gaq=window._gaq||[];this.GE?window._gaq.push(["_setCustomVar",5,"is_topstory",j,3]):window._gaq.push(["_setCustomVar",5,"is_topstory",m,3])};y(Ey,T);t=Ey.prototype;
t.B=function(){Ey.n.B.call(this);this.J=$(this.g);if(this.me=J("zh-main-feed-fresh-button"))this.Cp=$(this.me),this.sO?(this.h().e(this.me,"click",this.kR),this.h().e(Y,"topstory2",this.RD)):this.GE?(this.h().e(this.me,"click",this.jR),this.h().e(Y,"topstory",this.RD)):(this.h().e(this.me,"click",this.pS),this.h().e(Y,"homefeed",this.RM));this.Wa=new zy(this.g,k,j);this.getParent()&&this.getParent().H(this.Wa);var b="/node/"+$(this.g).data("init").nodename;this.Wa.url=b;this.Wa.di("feed-item-hook");
this.h().e(this.Wa,"itemcreated",function(b){Fy(this,b.data.vO)}).e(this.Wa,"afterload",function(b){Y.Z({type:"ga_click_feed_more",data:b.data})}).e(this.Wa,"ignore",function(b){var c=b.key,g=b.value;H.forEach(this.zx,function(b){b.Tq[c]===g&&$(b.g).fadeOut(150)})});this.Wa.z();this.J.on("click",".js-more-similar",function(){$(this).parent().slideUp("fast").nextUntil(":not(.hidden)").slideDown("fast")});var c=this;this.J.on("click",".js-change-some",function(){Nk("feed","intrests-change");var b=$(this),
e=$(this).parent().parent();$.post("/node/HomeExtraFeedList",{method:"next",params:{}}).done(function(g){!g.r&&g.msg&&(0<g.msg.length?(e.find(".feed-item-hook").remove(),e.append(g.msg).find(".feed-item-hook").each(function(){c.Wa.Gj(this)})):b.replaceWith('<span class="zg-right zg-gray">没有更多内容了</span>'))})})};t.jR=function(){this.Cp.text("加载中…");this.ki=0;var b=this;this.Wa.offset=0;this.Wa.Wg=0;Tu(this.Wa,j,function(){Oh(b.Wa,function(b){$(b.m()).remove()})}).done(function(){b.Cp.hide();Qu(b.Wa)})};
t.kR=function(){this.Cp.text("加载中…");var b=this.ki;this.ki=0;var c=this;this.Wa.offset=b;this.Wa.Wg="live";Tu(this.Wa,j,k,function(b){b&&b.msg.length&&(c.Wa.Yp(b.msg,"prepend"),c.Cp.hide())});Y.Z({type:"click_feed_fresh",data:{count:b}})};
t.pS=function(){var b=K("zm-home-question-list-devider",this.g);b&&E.remove(b,"zm-home-question-list-devider");var b=this.xs.length,c=$("."+this.QC,this.g)[0];c&&5<=b&&($(".feed-separator-hook",this.g).next(".feed-item-hook").css("border-top","1px solid #eee").end().remove(),$(c).css("border-top","none").before('<div class="feed-item-hook feed-separator-hook feed-separator"><span>上次你看到这里</span></div>'));z.forEach(this.xs,function(b){var c=$("."+this.QC,this.g)[0];c?jc(b,c):this.g.appendChild(b)},
this);this.xs=[];R(this.me,m);c=By.O();Cy(c,j);Y.Z({type:"ga_click_feed_fresh",data:{count:b}})};
t.RM=function(b){var c=Ma(b.tc),b=this.xs,d=b.length;if(c&&!(500<d)){var e=fc(c),c=this.zx;if(!H.br(c,function(b){return b.m().id===e.id})){var g=this.Wa.Gj(e);if(g.na){if(H.br(c,function(b){return b.na===g.na}))return}else if(g.ia){if(H.br(c,function(b){return b.ia===g.ia}))return}else if(g.tb&&H.br(c,function(b){return b.tb===g.tb}))return;Fy(this,g);b.push(e);d+=1;this.me&&(this.me.innerHTML=(99<d?"99+":d)+" 条新动态",R(this.me,j))}}};
t.RD=function(b){this.ki=this.ki||0;this.ki+=+b.tc;this.me&&(this.me.innerHTML=(99<this.ki?"99+":this.ki)+" 条新动态",R(this.me,j))};a.Fy=function(b,c){var d=Ih(Hh.O());b.zx[d]=c;$(c.g).attr("data-fid",d)};a.Gy=function(){};y(Gy,T);t=Gy.prototype;t.B=function(){Gy.n.B.call(this);var b=J("zh-invite-select");b&&this.h().e(b,"change",this.sy);(b=K("zm-invite-list"))&&this.h().e(b,"click",this.ra);(this.Xw=J("zh-invite-ignore-all-btn"))&&this.h().e(this.Xw,"click",this.DN)};
t.ra=function(b){if((b=b.target)&&b.name){if("ignore"===b.name){this.jX=b;this.kX=j;E.add(b,"zg-btn-disabled");this.EN=new V(m);var c="qid="+b.getAttribute("data-qid")+"&uid="+S.wd+"&op=pass";this.EN.ajax("/question/askpeople",c,"POST");(c=b.parentNode)&&aj(c,j)}"recover"===b.name&&!this.CG&&(this.AG=b,this.CG=j,E.add(b,"zg-btn-disabled"),b.innerHTML="...",this.BG=new V(m),this.h().e(this.BG,"success",this.nJ),b="qid="+b.getAttribute("data-qid")+"&uid="+S.wd+"&op=recover",this.BG.ajax("/question/askpeople",
b,"POST"))}};t.sy=function(b){var c=bt(new wf(location.href),"filter_by");if((b=b.target)&&b.value)b=b.value,b!==c&&(window.location.href="/question/invited?filter_by="+b)};t.nJ=function(){this.CG=m;this.Yb(this.AG,"ignore");this.AG.name="ignore"};
t.Yb=function(b,c){var d=b.parentNode,e=K("zm-invite-item-info-label",d);"ignore"===c?(E.remove(b,"zg-btn-disabled"),E.remove(b,"recover"),E.add(b,"ignore"),E.add(d,"invite"),E.remove(d,"ignore"),e.innerHTML="新邀请",b.name="ignore",b.innerHTML="忽略"):(E.remove(b,"zg-btn-disabled"),E.remove(b,"ignore"),E.add(b,"recover"),E.remove(d,"invite"),E.remove(d,"draft"),E.add(d,"ignore"),e.innerHTML="已忽略",b.name="recover",b.innerHTML="恢复")};
t.DN=function(){this.Yw||(this.Yw=j,this.gE=new V(m),this.h().e(this.gE,"success",this.kJ),this.gE.ajax("/question/askpeople","uid="+S.wd+"&op=ignore_all","POST"))};t.kJ=function(){this.Yw=m;R(this.Xw);this.Yw=m;z.forEach(Vb("zm-invite-item-control"),v(function(b){this.Yb(b,"recover")},this))};a.Hy=function(){T.call(this)};y(Hy,T);Hy.prototype.B=function(){Hy.n.B.call(this);this.ml();this.h().e(this.g,"click",this.ra)};Hy.prototype.ra=function(b){b=b.target;if(b.name)switch(b.name){case "fold":$(b).parent().hide().prev().animate({height:"show"},200);break;case "fold-follow":$(b).parent().hide().prev().show();break;case "unfold-item":$(b).parent(".author-list").hide().siblings(".hidden").show()}};
Hy.prototype.ml=function(){this.Xn||(this.Xn=j,this.Aj=new V(m),this.h().e(this.Aj,"success",this.py),this.Aj.ajax("/noti7/calendar","","GET"))};Hy.prototype.py=function(){this.Xn=m;var b=He(this.Aj);if(b){var c=J("zh-noti7-list-inner");/category/.test(b)?(c.innerHTML=b,c&&(b=new Ou(c,"/noti7/calendar",j),b.Yp=function(b){var c=L("div","zm-item-more-wrap");c.innerHTML=b;jc(c,this.Xb)},b.yr=function(b){this.Wg=this.Xb.getAttribute("data-next");return!b||b.msg[0]&&b.msg[1]},b.z())):c.innerHTML='<div class="empty"><span class="zg-gray-normal">您收到的消息会显示在这里</span></div>'}};a.Iy=function(){N.call(this);this.Vw=[];this.nC=[]};y(Iy,Yk);Iy.prototype.z=function(){var b=J("home-suggest-block");b&&(this.g=b,b=J("home-suggest-close-button"),oe(this.h(),b,"click",function(){(new V(j)).ajax("/option","key=no_show_lookup&value=1");R(this.g,m)}),b=J("home-suggest-refresh-button"),this.h().e(b,"click",this.YP),this.ms=J("home-suggest-list"),Jy(this))};Iy.prototype.YP=function(){Ky(this);return j};
a.Ky=function(b){for(var c=[],d=0;3>d;d++){var e=b.nC.shift();e&&c.push(e)}3===c.length?(b.ms.innerHTML=c.join(""),c=Vb("suggest-item",b.ms),z.forEach(c,function(b){this.Vw.push(b.id.split("-")[1])},b)):Jy(b)},a.Jy=function(b){b.ms.innerHTML='<img class="bubble-loading" src="http://static.zhihu.com/static/img/noti-loading.gif">';$.post("/lookup/suggest_member",{ids:b.Vw.join(",")}).done(v(b.vP,b))};
Iy.prototype.vP=function(b){b.r||((b=b.msg)&&ma(b)&&b.length?(this.Vw=[],this.nC=b,Ky(this)):this.ms.innerHTML="")};a.Ly=function(){T.call(this)};y(Ly,T);Ly.prototype.z=function(){ys.H(this);this.o(document.body)};
Ly.prototype.B=function(){Ly.n.B.call(this);var b=J("js-home-feed-list");if(b){var c=new Ey;this.H(c);c.o(b)}(b=K("zm-invite-container"))&&(new Gy).o(b);J("home-settings-page-wrap")&&(b=J("zh-topic-block-editor"))&&(new Ft(lh)).o(b);(b=J("zh-noti7"))&&(new Hy).o(b);if(c=J("zm-home-sidebar-domain-entry-link"))b=!!c.getAttribute("data-expanded"),c=new Bp(c,J("zm-home-sidebar-domain-entry-nav"),b),b&&wd(c,"toggle",function(){Fi("/notifeature?feature=4",k,"GET");return j});$(".zm-side-pinned-topics").on("click",
".unpin",function(){var b=$(this).parent();$.post("/pin-topic/remove",{tid:$(this).attr("data-tid")}).done(function(c){c.r||b.fadeOut()})});if(b=$("#zh-virgin-answer-list > .zh-general-list").get(0))c=new xu,this.H(c),c.la("nodeSource").la("childConstructor",{Ji:Yw}),c.o(b),this.h().e(c,"click!",function(b){"comment"===b.namespace&&b.xc.fill("category","debuts").fill("label","debuts")});(new Iy).z();var b=S[1],d=J("zu-welcome-once");d&&("welcome"===location.hash.slice(1)?(R(d,j),Of.set("reg_noti_",
b,86400)):b===Of.get("reg_noti_")&&R(d,j),O(K("x-m",d),"click",function(){location.hash="";M(d);Of.remove("reg_noti_")}));var e=$("#js-global-notify");if(e.length){var g=new ur;g.o(e[0]);Ws(g);$(".zu-global-notify-close",e).click(function(){var b=$(this).data("id");$.post("/notice/read",{nid:b});g.G();e.remove()})}b=By.O();Dy(b);var h=$("#js-debuts-entry .tour");h.length&&$(".close-button",h).click(function(){var b=$(this).data("feature");$.get("/notifeature",{feature:b});h.fadeOut(100,function(){h.remove()})})};a.My=function(){Wh.call(this,k,m);this.yB="zh-lightbox-showing";this.US="zh-lightbox-thumb";this.Dg()};y(My,Wh);ia(My);t=My.prototype;t.Dg=function(){this.h().e(document,"click",this.pr)};
t.pr=function(b){b=b.target;if("IMG"===b.tagName&&E.has(b,this.US)){var c=b.getAttribute("data-original");if(c)if(sb)window.open(c);else if(!Ic(b,k,"editable")){this.Ea('<div class="zm-light-box-x1" id="zm-light-box-x1"><div class="zm-light-box-x2" id="zm-light-box-x2"><img src="'+c+'" class="zm-light-box-img-el" /><div class="zm-light-box-footer"><a class="zm-light-box-show-origin" href="'+c+'" target="_blank">查看原图</a></div></div></div>');this.D(j);E.add(this.m(),"zm-light-box-fullscreen-image");
var c=Yb(),d=J("zm-light-box-x1"),e=J("zm-light-box-x2"),g=b.getAttribute("data-rawheight"),h=b.getAttribute("data-rawwidth"),h=h?+h:0;(g?+g:0)>c.height-80?e.style.marginTop="40px":d.style.lineHeight=c.height+"px";e.style.width=h>c.width-80?c.width-80+"px":h+"px";Y.Z({type:"ga_click_enlarge_image",target:b})}}};t.ha=ha;t.focus=ha;t.DM=function(){this.D(m);E.remove(document.body,this.yB)};t.Vh=function(){My.n.Vh.call(this);E.add(document.body,this.yB);oe(this.h(),document,"click",this.DM)};
t.v=function(){My.n.v.call(this);E.add(this.m(),"zm-light-box")};t.Sx=function(){this.Lc=this.K().v("div",this.Ac+"-bg zm-light-box-background");R(this.Lc,m)};My.O();a.Ny=function(b,c,d){Ku.call(this,b,c,d);this.gi(j)};y(Ny,Ku);Ny.prototype.Rd=function(){return this.dispatchEvent("action")};gp("goog-option",function(){return new Ny(k)});a.Oy=function(){};y(Oy,Ep);ia(Oy);Oy.prototype.v=function(b){return b.K().v("div",this.L()+" goog-inline-block"," ")};Oy.prototype.o=function(b,c){c=Oy.n.o.call(this,b,c);E.add(c,"goog-inline-block");return c};Oy.prototype.L=s("goog-toolbar-separator");a.Py=function(){};y(Py,Gp);ia(Py);Py.prototype.pc=function(){return Vc.TI};Py.prototype.pn=function(b){return"HR"==b.tagName?new Fp(Oy.O()):Py.n.pn.call(this,b)};Py.prototype.L=s("goog-toolbar");Py.prototype.kw=function(){return Ip};a.Qy=function(){};y(Qy,ep);ia(Qy);t=Qy.prototype;t.v=function(b){var c={"class":"goog-inline-block "+this.Ye(b).join(" "),title:b.Jf()||""},c=b.K().v("div",c,this.Hi(b.$a(),b.K()));bp(this,b,c);return c};t.pc=function(){return Vc.Hp};t.X=function(b){return b&&b.firstChild.firstChild};t.Hi=function(b,c){return c.v("div","goog-inline-block "+(this.L()+"-outer-box"),c.v("div","goog-inline-block "+(this.L()+"-inner-box"),b))};t.nc=function(b){return"DIV"==b.tagName};
t.o=function(b,c){Ry(c,j);Ry(c,m);var d;a:{d=b.K().mD(c);var e=this.L()+"-outer-box";if(d&&E.has(d,e)&&(d=b.K().mD(d),e=this.L()+"-inner-box",d&&E.has(d,e))){d=j;break a}d=m}d||c.appendChild(this.Hi(c.childNodes,b.K()));E.add(c,"goog-inline-block",this.L());return Qy.n.o.call(this,b,c)};t.L=s("goog-custom-button");
a.Ry=function(b,c){if(b)for(var d=c?b.firstChild:b.lastChild,e;d&&d.parentNode==b;){e=c?d.nextSibling:d.previousSibling;if(3==d.nodeType){var g=d.nodeValue;if(""==Ma(g))b.removeChild(d);else{d.nodeValue=c?g.replace(/^[\s\xa0]+/,""):Oa(g);break}}else break;d=e}};a.Sy=function(){};y(Sy,Qy);ia(Sy);Sy.prototype.L=s("goog-toolbar-button");a.Ty=function(b,c,d){pp.call(this,b,c||Sy.O(),d)};y(Ty,pp);gp("goog-toolbar-button",function(){return new Ty(k)});a.Uy=function(){};y(Uy,Qy);ia(Uy);B&&(Uy.prototype.Ea=function(b,c){var d=Uy.n.X.call(this,b&&b.firstChild);d&&mc(this.createCaption(c,Sb(b)),d)});t=Uy.prototype;t.X=function(b){b=Uy.n.X.call(this,b&&b.firstChild);B&&(b&&b.__goog_wrapper_div)&&(b=b.firstChild);return b};t.o=function(b,c){var d=Ub("*","goog-menu",c)[0];if(d){R(d,m);Rb(d).body.appendChild(d);var e=new Nu;e.o(d);b.Tg(e)}return Uy.n.o.call(this,b,c)};
t.Hi=function(b,c){return Uy.n.Hi.call(this,[this.createCaption(b,c),c.v("div","goog-inline-block "+(this.L()+"-dropdown")," ")],c)};t.createCaption=function(b,c){return Vy(b,this.L(),c)};a.Vy=function(b,c,d){return d.v("div","goog-inline-block "+(c+"-caption"),b)};t.L=s("goog-menu-button");a.Wy=function(){};y(Wy,Uy);ia(Wy);Wy.prototype.createCaption=function(b,c){return Wy.n.createCaption.call(this,Xy(b,c),c)};a.Xy=function(b,c){return c.v("div","goog-color-menu-button-indicator",b)};Wy.prototype.za=function(b,c){b&&Yy(this.X(b),c)};a.Yy=function(b,c){if(b&&b.firstChild){var d;d=c&&(lt.test("#"==c.charAt(0)?c:"#"+c)||vt(c).length||xt&&xt[c.toLowerCase()])?eu(c).Ar:k;b.firstChild.style.borderBottomColor=d||(A?"":"transparent")}};
Wy.prototype.te=function(b){this.za(b.m(),b.V());E.add(b.m(),"goog-color-menu-button");Wy.n.te.call(this,b)};a.Zy=function(){};y(Zy,$o);ia(Zy);a.$y=0;t=Zy.prototype;t.v=function(b){var c=this.Ye(b);return b.K().v("div",c?c.join(" "):k,az(this,b.$a(),b.pl(),b.K()))};a.az=function(b,c,d,e){for(var g=[],h=0,l=0;h<d.height;h++){for(var n=[],q=0;q<d.width;q++){var r=c&&c[l++];n.push(bz(b,r,e))}g.push(e.v("tr",b.L()+"-row",n))}return b.iv(g,e)};t.iv=function(b,c){var d=c.v("table",this.L()+"-table",c.v("tbody",this.L()+"-body",b));d.cellSpacing=0;d.cellPadding=0;Mc(d,"grid");return d};
a.bz=function(b,c,d){b=d.v("td",{"class":b.L()+"-cell",id:b.L()+"-cell-"+$y++},c);Mc(b,"gridcell");return b};t.nc=s(m);t.o=s(k);
t.Ea=function(b,c){if(b){var d=Ub("tbody",this.L()+"-body",b)[0];if(d){var e=0;z.forEach(d.rows,function(b){z.forEach(b.cells,function(b){ic(b);if(c){var d=c[e++];d&&b.appendChild(d)}})});if(e<c.length){for(var g=[],h=Sb(b),l=d.rows[0].cells.length;e<c.length;){var n=c[e++];g.push(bz(this,n,h));g.length==l&&(n=h.v("tr",this.L()+"-row",g),d.appendChild(n),g.length=0)}if(0<g.length){for(;g.length<l;)g.push(bz(this,"",h));n=h.v("tr",this.L()+"-row",g);d.appendChild(n)}}}ug(b,j,B)}};
a.cz=function(b,c,d){for(c=c.m();d&&1==d.nodeType&&d!=c;){if("TD"==d.tagName&&E.has(d,b.L()+"-cell"))return d.firstChild;d=d.parentNode}return k},a.dz=function(b,c,d,e){d&&(d=d.parentNode,E.enable(d,b.L()+"-cell-hover",e),Nc(c.m().firstChild,"activedescendent",d.id))};t.L=s("goog-palette");a.fz=function(b){N.call(this);this.vd=[];ez(this,b)};y(fz,Gd);t=fz.prototype;t.Yf=k;t.jf=k;t.ll=function(){return this.vd.length};t.Eh=function(b){return this.vd[b]||k};a.ez=function(b,c){c&&(z.forEach(c,function(b){this.em(b,m)},b),z.extend(b.vd,c))};t.Fa=function(b){this.zi(b,this.ll())};t.zi=function(b,c){b&&(this.em(b,m),z.In(this.vd,b,c))};t.removeItem=function(b){b&&z.remove(this.vd,b)&&b==this.Yf&&(this.Yf=k,this.dispatchEvent("select"))};t.yg=p("Yf");t.Hb=function(){return z.clone(this.vd)};
t.kf=function(b){b!=this.Yf&&(this.em(this.Yf,m),this.Yf=b,this.em(b,j));this.dispatchEvent("select")};t.ol=function(){return this.Yf?z.indexOf(this.vd,this.Yf):-1};t.Ro=function(b){this.kf(this.Eh(b))};t.clear=function(){z.clear(this.vd);this.Yf=k};t.w=function(){fz.n.w.call(this);delete this.vd;this.Yf=k};t.em=function(b,c){b&&("function"==typeof this.jf?this.jf(b,c):"function"==typeof b.im&&b.im(c))};a.gz=function(b,c,d){ip.call(this,b,c||Zy.O(),d);this.Ci&=-89};y(gz,ip);t=gz.prototype;t.ic=k;t.Db=-1;t.ka=k;t.w=function(){gz.n.w.call(this);this.ka&&(this.ka.G(),this.ka=k);this.ic=k};t.gm=function(b){gz.n.gm.call(this,b);hz(this);this.ka?(this.ka.clear(),ez(this.ka,b)):(this.ka=new fz(b),b=v(this.em,this),this.ka.jf=b,this.h().e(this.ka,"select",this.gj));this.Db=-1};t.wg=s("");t.fm=ba();
t.fd=function(b){gz.n.fd.call(this,b);var c=cz(this.M,this,b.target);(!c||!b.relatedTarget||!sc(c,b.relatedTarget))&&c!=iz(this)&&jz(this,c)};t.Hh=function(b){gz.n.Hh.call(this,b);var c=cz(this.M,this,b.target);(!c||!b.relatedTarget||!sc(c,b.relatedTarget))&&c==iz(this)&&dz(this.M,this,c,m)};t.qe=function(b){gz.n.qe.call(this,b);this.Wb()&&(b=cz(this.M,this,b.target),b!=iz(this)&&jz(this,b))};t.Rd=function(b){var c=iz(this);return c?(this.kf(c),gz.n.Rd.call(this,b)):m};
t.Ub=function(b){var c=this.$a(),c=c?c.length:0,d=this.ic.width;if(0==c||!this.isEnabled())return m;if(13==b.keyCode||32==b.keyCode)return this.Rd(b);if(36==b.keyCode)return this.Lb(0),j;if(35==b.keyCode)return this.Lb(c-1),j;var e=0>this.Db?this.ol():this.Db;switch(b.keyCode){case 37:-1==e&&(e=c);if(0<e)return this.Lb(e-1),b.preventDefault(),j;break;case 39:if(e<c-1)return this.Lb(e+1),b.preventDefault(),j;break;case 38:-1==e&&(e=c+d-1);if(e>=d)return this.Lb(e-d),b.preventDefault(),j;break;case 40:if(-1==
e&&(e=-d),e<c-d)return this.Lb(e+d),b.preventDefault(),j}return m};t.gj=ba();t.pl=p("ic");a.kz=function(b,c){b.m()&&f(Error("Component already rendered"));b.ic=pa(c)?new Ob(c,i):c;hz(b)},a.iz=function(b){var c=b.$a();return c&&c[b.Db]};t.Lb=function(b){b!=this.Db&&(lz(this,this.Db,m),this.Db=b,lz(this,b,j))};a.jz=function(b,c){var d=b.$a();b.Lb(d?z.indexOf(d,c):-1)};t.ol=function(){return this.ka?this.ka.ol():-1};t.yg=function(){return this.ka?this.ka.yg():k};t.Ro=function(b){this.ka&&this.ka.Ro(b)};
t.kf=function(b){this.ka&&this.ka.kf(b)};a.lz=function(b,c,d){if(b.m()){var e=b.$a();e&&(0<=c&&c<e.length)&&dz(b.M,b,e[c],d)}};t.em=function(b,c){this.m()&&b&&E.enable(b.parentNode,this.M.L()+"-cell-selected",c)};a.hz=function(b){var c=b.$a();if(c)if(b.ic&&b.ic.width){if(c=Math.ceil(c.length/b.ic.width),!pa(b.ic.height)||b.ic.height<c)b.ic.height=c}else c=Math.ceil(Math.sqrt(c.length)),b.ic=new Ob(c,c);else b.ic=new Ob(0,0)};a.mz=function(b,c,d){this.wq=b||[];gz.call(this,k,c||Zy.O(),d);this.wq=this.wq;this.zs=k;this.Ea(z.map(this.wq,function(b){var c=this.K().v("div",{"class":this.M.L()+"-colorswatch",style:"background-color:"+b});"#"==b.charAt(0)&&(b=wt(b),b="RGB ("+[parseInt(b.substr(1,2),16),parseInt(b.substr(3,2),16),parseInt(b.substr(5,2),16)].join(", ")+")");c.title=b;return c},this))};y(mz,gz);mz.prototype.zs=k;mz.prototype.tw=function(){var b=this.yg();return b?(b=iu(b,"background-color"),nz(b)):k};
mz.prototype.Qo=function(b){b=nz(b);this.zs||(this.zs=z.map(this.wq,function(b){return nz(b)}));this.Ro(b?z.indexOf(this.zs,b):-1)};a.nz=function(b){if(b)try{return eu(b).Ar}catch(c){}return k};a.oz=function(b,c,d,e){Qt.call(this,b,c,d||e);if(d||e)this.hm(65|(e?32:132))};y(oz,Qt);a.pz=function(b,c,d,e){pp.call(this,b,d||Uy.O(),e);lp(this,64,j);this.Gl=new oz(k,5);c&&this.Tg(c);this.kF=k;this.ma=new Id(500);if((Ng||Og)&&!D("533.17.9"))this.Yr=j};y(pz,pp);t=pz.prototype;t.Yr=m;t.Xl=m;t.B=function(){pz.n.B.call(this);this.qa&&qz(this,this.qa,j);Nc(this.m(),Uc.uk,"true")};t.hb=function(){pz.n.hb.call(this);if(this.qa){this.pb(m);this.qa.hb();qz(this,this.qa,m);var b=this.qa.m();b&&M(b)}};t.w=function(){pz.n.w.call(this);this.qa&&(this.qa.G(),delete this.qa);delete this.TQ;this.ma.G()};
t.qe=function(b){pz.n.qe.call(this,b);this.Wb()&&(this.pb(!this.nb(),b),this.qa&&(b=this.nb(),this.qa.Pf=b))};t.Kf=function(b){pz.n.Kf.call(this,b);this.qa&&!this.Wb()&&(this.qa.Pf=m)};t.Rd=function(){this.setActive(m);return j};t.lM=function(b){this.qa&&(this.qa.R()&&!this.xf(b.target))&&this.pb(m)};t.xf=function(b){return b&&sc(this.m(),b)||this.qa&&this.qa.xf(b)||m};
t.$e=function(b){if(32==b.keyCode){if(b.preventDefault(),"keyup"!=b.type)return j}else if("key"!=b.type)return m;if(this.qa&&this.qa.R()){var c=this.qa.Ub(b);return 27==b.keyCode?(this.pb(m),j):c}return 40==b.keyCode||38==b.keyCode||32==b.keyCode||13==b.keyCode?(this.pb(j),j):m};t.wn=function(){this.pb(m)};t.NM=function(){this.Wb()||this.pb(m)};t.Oc=function(b){this.Yr||this.pb(m);pz.n.Oc.call(this,b)};t.Va=function(){this.qa||this.Tg(new Nu(this.K()));return this.qa||k};
t.Tg=function(b){var c=this.qa;if(b!=c&&(c&&(this.pb(m),this.ya&&qz(this,c,m),delete this.qa),b)){this.qa=b;Nh(b,this);b.D(m);var d=this.Yr;(b.Bm=d)&&b.Fe(j);this.ya&&qz(this,b,j)}return c};a.rz=function(b){b.kF=new Pf(7,0,7,0)};t.Fa=function(b){this.Va().H(b,j)};t.zi=function(b,c){this.Va().xk(b,c,j)};t.removeItem=function(b){(b=this.Va().removeChild(b,j))&&b.G()};t.Eh=function(b){return this.qa?Qh(this.qa,b):k};t.ll=function(){return this.qa?Ph(this.qa):0};
t.D=function(b,c){var d=pz.n.D.call(this,b,c);d&&!this.R()&&this.pb(m);return d};t.Xa=function(b){pz.n.Xa.call(this,b);this.isEnabled()||this.pb(m)};a.sz=function(b){b.Gl.hm&&b.Gl.hm(33)};t.jH=function(){this.pb(j)};
t.pb=function(b,c){pz.n.pb.call(this,b);if(this.qa&&!!(this.$&64)==b){if(b)this.qa.ya||(this.Xl?this.qa.W(this.m().parentNode):this.qa.W()),this.hk=gg(this.m()),this.Ei=qg(this.m()),tz(this),this.qa.Lb(-1);else if(this.setActive(m),this.qa.Pf=m,this.m()&&Nc(this.m(),Uc.wm,""),this.Gs!=k){this.Gs=i;var d=this.qa.m();d&&ng(d,"","")}this.qa.D(b,m,c);if(!this.tg){var d=this.h(),e=b?d.e:d.Da;e.call(d,this.K().Ba(),"mousedown",this.lM,j);this.Yr&&e.call(d,this.qa,"blur",this.NM);e.call(d,this.ma,Jd,this.Ll);
b?this.ma.start():this.ma.stop()}}};a.tz=function(b){if(b.qa.ya){var c=b.Gl;b.Gl.element=b.TQ||b.m();var d=b.qa.m();b.qa.R()||(d.style.visibility="hidden",R(d,j));!b.Gs&&(b.Gl.qn&&b.Gl.qn()&32)&&(b.Gs=pg(d));c.ha(d,c.yf^1,b.kF,b.Gs);b.qa.R()||(R(d,m),d.style.visibility="visible")}};
t.Ll=function(){var b=qg(this.m()),c=gg(this.m());if(!(this.Ei==b||(!this.Ei||!b?0:this.Ei.left==b.left&&this.Ei.width==b.width&&this.Ei.top==b.top&&this.Ei.height==b.height))||!(this.hk==c||(!this.hk||!c?0:this.hk.top==c.top&&this.hk.right==c.right&&this.hk.bottom==c.bottom&&this.hk.left==c.left)))this.Ei=b,this.hk=c,tz(this)};a.qz=function(b,c,d){var e=b.h(),d=d?e.e:e.Da;d.call(e,c,"action",b.wn);d.call(e,c,"highlight",b.Jw);d.call(e,c,"unhighlight",b.Rw)};t.Jw=function(b){Nc(this.m(),Uc.wm,b.target.m().id)};
t.Rw=function(){Kt(this.qa)||Nc(this.m(),Uc.wm,"")};gp("goog-menu-button",function(){return new pz(k)});a.uz=function(b,c,d,e){pz.call(this,b,c,d||Wy.O(),e)};y(uz,pz);
a.vz={yU:"#000 #444 #666 #999 #ccc #eee #f3f3f3 #fff".split(" "),HV:"#f00 #f90 #ff0 #0f0 #0ff #00f #90f #f0f".split(" "),lV:"#f4cccc #fce5cd #fff2cc #d9ead3 #d0e0e3 #cfe2f3 #d9d2e9 #ead1dc #ea9999 #f9cb9c #ffe599 #b6d7a8 #a2c4c9 #9fc5e8 #b4a7d6 #d5a6bd #e06666 #f6b26b #ffd966 #93c47d #76a5af #6fa8dc #8e7cc3 #c27ba0 #cc0000 #e69138 #f1c232 #6aa84f #45818e #3d85c6 #674ea7 #a64d79 #990000 #b45f06 #bf9000 #38761d #134f5c #0b5394 #351c75 #741b47 #660000 #783f04 #7f6000 #274e13 #0c343d #073763 #20124d #4c1130".split(" ")},a.wz=
function(b){var c=new Nu(b);H.forEach(vz,function(d){d=new mz(d,k,b);kz(d,8);c.H(d,j)});return c};t=uz.prototype;t.tw=function(){return this.V()};t.Qo=function(b){this.za(b)};t.za=function(b){for(var c=0,d;d=this.Eh(c);c++)"function"==typeof d.Qo&&d.Qo(b);uz.n.za.call(this,b)};t.wn=function(b){"function"==typeof b.target.tw?this.za(b.target.tw()):"none"==b.target.V()&&this.za(k);uz.n.wn.call(this,b);b.stopPropagation();this.dispatchEvent("action")};
t.pb=function(b,c){b&&0==this.ll()&&(this.Tg(wz(this.K())),this.za(this.V()));uz.n.pb.call(this,b,c)};gp("goog-color-menu-button",function(){return new uz(k)});a.xz=function(){};y(xz,Uy);ia(xz);xz.prototype.L=s("goog-toolbar-menu-button");a.yz=function(){};y(yz,xz);ia(yz);yz.prototype.createCaption=function(b,c){return Vy(Xy(b,c),this.L(),c)};yz.prototype.za=function(b,c){b&&Yy(this.X(b),c)};yz.prototype.te=function(b){this.za(b.m(),b.V());E.add(b.m(),"goog-toolbar-color-menu-button");yz.n.te.call(this,b)};a.zz=function(b,c,d,e){uz.call(this,b,c,d||yz.O(),e)};y(zz,uz);gp("goog-toolbar-color-menu-button",function(){return new zz(k)});a.Az=function(b,c,d,e){pz.call(this,b,c,d||xz.O(),e)};y(Az,pz);gp("goog-toolbar-menu-button",function(){return new Az(k)});a.Cz=function(b,c,d,e){pz.call(this,b,c,d,e);Bz(this,b);this.Oo(Vc.JA)};y(Cz,pz);t=Cz.prototype;t.ka=k;t.tv=k;t.B=function(){Cz.n.B.call(this);Dz(this);Ez(this);Nc(this.m(),Uc.uk,"false")};t.ca=function(b){Cz.n.ca.call(this,b);(b=this.wg())?Bz(this,b):this.Ro(0)};t.w=function(){Cz.n.w.call(this);this.ka&&(this.ka.G(),this.ka=k);this.tv=k};t.wn=function(b){this.kf(b.target);Cz.n.wn.call(this,b);b.stopPropagation();this.dispatchEvent("action")};
t.gj=function(){var b=this.yg();Cz.n.za.call(this,b&&b.V());Dz(this)};t.Tg=function(b){var c=Cz.n.Tg.call(this,b);b!=c&&(this.ka&&this.ka.clear(),b&&(this.ka?Oh(b,function(b){Fz(b);this.ka.Fa(b)},this):Gz(this,b)));return c};a.Bz=function(b,c){b.tv=c;Dz(b)};t.Fa=function(b){Fz(b);Cz.n.Fa.call(this,b);this.ka?this.ka.Fa(b):Gz(this,this.Va())};t.zi=function(b,c){Fz(b);Cz.n.zi.call(this,b,c);this.ka?this.ka.zi(b,c):Gz(this,this.Va())};t.removeItem=function(b){Cz.n.removeItem.call(this,b);this.ka&&this.ka.removeItem(b)};
t.kf=function(b){if(this.ka){var c=this.yg();this.ka.kf(b);b!=c&&this.dispatchEvent("change")}};t.Ro=function(b){this.ka&&this.kf(this.ka.Eh(b))};t.za=function(b){if(b!=k&&this.ka)for(var c=0,d;d=this.ka.Eh(c);c++)if(d&&"function"==typeof d.V&&d.V()==b){this.kf(d);return}this.kf(k)};t.yg=function(){return this.ka?this.ka.yg():k};t.ol=function(){return this.ka?this.ka.ol():-1};
a.Gz=function(b,c){b.ka=new fz;c&&Oh(c,function(b){Fz(b);this.ka.Fa(b)},b);Ez(b)},a.Ez=function(b){b.ka&&b.h().e(b.ka,"select",b.gj)},a.Dz=function(b){var c=b.yg();b.Ea(c?c.wg():b.tv)},a.Fz=function(b){b.Oo(b instanceof Ku?Vc.MA:Vc.LI)};t.pb=function(b,c){Cz.n.pb.call(this,b,c);this.nb()&&this.Va().Lb(this.ol())};gp("goog-select",function(){return new Cz(k)});a.Hz=function(b,c,d,e){Cz.call(this,b,c,d||xz.O(),e)};y(Hz,Cz);gp("goog-toolbar-select",function(){return new Hz(k)});a.Iz=function(b){var c=b.indexOf(",");a:{b=(-1!=c?b.substring(0,c):b).toLowerCase();for(c=0;2>c;c++){var d="\"'".charAt(c);if(b.charAt(0)==d&&b.charAt(b.length-1)==d){b=b.substring(1,b.length-1);break a}}}return b},a.Jz=function(b,c){z.forEach(c,function(c){var e=c.caption,c=c.value,g=Iz(c),e=new Ny(e,c,b.K());Lh(e,g);b.Fa(e);e.X().style.fontFamily=c})},a.Kz=[10,10,13,16,18,24,32,48],a.Mz=function(b,c,d,e,g,h){d=new Ty(Lz(d,e,h),g,h);Lh(d,b);d.Kc(c);return d},a.Nz=function(b,c,d,e,g,h){b=Mz(b,c,d,
e,g,h);lp(b,16,j);return b},a.Oz=function(b,c,d,e,g,h){g=new Hz(k,k,g,h);e&&z.forEach(e.split(/\s+/),g.ih,g);g.ih("goog-toolbar-select");Bz(g,d);Lh(g,b);g.Kc(c);return g},a.Pz=function(b,c,d,e,g,h){d=new zz(Lz(d,e,h),k,g,h);Lh(d,b);d.Kc(c);return d},a.Lz=function(b,c,d){if((!b||""==b)&&B&&!D("1.9a"))b=" ";return(d||Sb()).v("DIV",c?{"class":c}:k,b)};a.Qz=x("Link");x("Edit Link");x("Text to display:");a.Rz=x("Link to:");x("Web address");x("Link to a page or file somewhere else on the web");x("Test this link");
x("{$startBold}Not sure what to put in the box?{$endBold} First, find the page on the web that you want to link to. (A {$searchEngineLink}search engine{$endLink} might be useful.) Then, copy the web address from the box in your browser's address bar, and paste it into the box above.",{startBold:"<b>",endBold:"</b>",searchEngineLink:"<a href='http://www.google.com/' target='_new'>",endLink:"</a>"});x("To what URL should this link go?");x("Email address");x("Link to an email address");x("Invalid email address");
x("To what email address should this link?");x("{$preb}Be careful.{$postb} Remember that any time you include an email address on a web page, nasty spammers can find it too.",{preb:"<b>",postb:"</b>"});x("Open this link in a new window");x("Image");a.Sz={},a.Tz=x("Normal"),a.Uz=x("Normal / serif"),a.Vz=[{caption:Tz,value:"arial,sans-serif"},{caption:Uz,value:"times new roman,serif"},{caption:"Courier New",value:"courier new,monospace"},{caption:"Georgia",value:"georgia,serif"},{caption:"Trebuchet",value:"trebuchet ms,sans-serif"},{caption:"Verdana",value:"verdana,sans-serif"}],a.Wz={ja:[{caption:"ＭＳ Ｐゴシック",value:"ms pgothic,sans-serif"},{caption:"ＭＳ Ｐ明朝",value:"ms pmincho,serif"},{caption:"ＭＳ ゴシック",value:"ms gothic,monospace"}],ko:[{caption:"굴림",
value:"gulim,sans-serif"},{caption:"바탕",value:"batang,serif"},{caption:"굴림체",value:"gulimche,monospace"}],"zh-tw":[{caption:"新細明體",value:"pmingliu,serif"},{caption:"細明體",value:"mingliu,serif"}],"zh-cn":[{caption:"宋体",value:"simsun,serif"},{caption:"黑体",value:"simhei,sans-serif"},{caption:"MS Song",value:"ms song,monospace"}]},a.Xz=x("Small"),a.Yz=x("Normal"),a.Zz=x("Large"),a.$z=x("Huge"),a.aA=[{caption:Xz,value:1},{caption:Yz,value:2},{caption:Zz,value:4},{caption:$z,value:6}],a.bA=x("Heading"),
a.cA=x("Subheading"),a.dA=x("Minor heading"),a.eA=x("Normal"),a.fA=[{caption:bA,va:"H2"},{caption:cA,va:"H3"},{caption:dA,va:"H4"},{caption:eA,va:"P"}],a.gA=function(b,c,d,e,g,h){var l=Mz(b,c,d,e,g,h);l.pi=function(b){l.Xa(b)};return l},a.hA=function(b,c){var d=c;try{if(A)var e="000000"+d.toString(16),g=e.substr(e.length-6,6),d="#"+g.substring(4,6)+g.substring(2,4)+g.substring(0,2);d!=b.V()&&b.za(d)}catch(h){}},a.iA=x("Format"),a.jA=x("Format"),a.kA=x("Undo"),a.lA=x("Redo"),a.mA=x("Font"),a.nA=x("Font size"),
a.oA=x("Text color"),a.pA=x("Bold"),a.qA=x("Italic"),a.rA=x("Underline"),a.sA=x("Text background color"),a.tA=x("Add or remove link"),a.uA=x("Numbered list"),a.vA=x("Bullet list"),a.wA=x("Decrease indent"),a.xA=x("Increase indent"),a.yA=x("Align left"),a.zA=x("Align center"),a.AA=x("Align right"),a.BA=x("Justify"),a.CA=x("Remove formatting"),a.DA=x("Insert image"),a.EA=x("Strikethrough"),a.FA=x("Left-to-right"),a.GA=x("Right-to-left"),a.HA=x("Quote"),a.IA=x("Edit HTML source"),a.JA=x("Subscript"),
a.KA=x("Superscript"),a.LA=x("Edit HTML"),a.MA={};
Sz.HA=[{va:"+undo",Q:kA,La:"tr-icon tr-undo",factory:gA,bb:j},{va:"+redo",Q:lA,La:"tr-icon tr-redo",factory:gA,bb:j},{va:"+fontName",Q:mA,La:"tr-fontName",factory:function(b,c,d,e,g,h){var l=Oz(b,c,d,e,g,h),b="en-us".replace(/_/,"-").toLowerCase(),c=[];b in Wz&&(c=Wz[b]);c.length&&Jz(l,c);Jz(l,Vz);Bz(l,Tz);E.add(l.Va().X(),"goog-menu-noaccel");l.pi=function(b){var c=k;b&&0<b.length&&(c=Mh(l.Va(),Iz(b)));c!=l.yg()&&l.kf(c)};return l},bb:j},{va:"+fontSize",Q:nA,La:"tr-fontSize",factory:function(b,c,
d,e,g,h){var l=Oz(b,c,d,e,g,h);z.forEach(aA,function(b){var c=b.value,b=new Ny(b.caption,c,l.K());l.Fa(b);b=b.X();b.style.fontSize=(Kz[c]||10)+"px";b.firstChild.style.height="1.1em"});Bz(l,Yz);E.add(l.Va().X(),"goog-menu-noaccel");l.pi=function(b){var c;if(c=oa(b))c=b.match(yt),c="px"==(c&&c[0]||k);c&&(b=z.lastIndexOf(Kz,parseInt(b,10)));b=0<b?b:k;b!=l.V()&&l.za(b)};return l},bb:j},{va:"+bold",Q:pA,La:"tr-icon tr-bold",bb:j},{va:"+italic",Q:qA,La:"tr-icon tr-italic",bb:j},{va:"+underline",Q:rA,La:"tr-icon tr-underline",
bb:j},{va:"+foreColor",Q:oA,La:"tr-icon tr-foreColor",factory:function(b,c,d,e,g,h){b=Pz(b,c,d,e,g,h);b.Qo("#000");b.pi=xa(hA,b);return b},bb:j},{va:"+backColor",Q:sA,La:"tr-icon tr-backColor",factory:function(b,c,d,e,g,h){b=Pz(b,c,d,e,g,h);b.Qo("#FFF");b.pi=xa(hA,b);return b},bb:j},{va:"+link",Q:tA,caption:Qz,La:"tr-link",bb:j},{va:"+insertOrderedList",Q:uA,La:"tr-icon tr-insertOrderedList",bb:j},{va:"+insertUnorderedList",Q:vA,La:"tr-icon tr-insertUnorderedList",bb:j},{va:"+outdent",Q:wA,La:"tr-icon tr-outdent",
factory:Mz},{va:"+indent",Q:xA,La:"tr-icon tr-indent",factory:Mz},{va:"+justifyLeft",Q:yA,La:"tr-icon tr-justifyLeft",bb:j},{va:"+justifyCenter",Q:zA,La:"tr-icon tr-justifyCenter",bb:j},{va:"+justifyRight",Q:AA,La:"tr-icon tr-justifyRight",bb:j},{va:"+justifyFull",Q:BA,La:"tr-icon tr-justifyFull",bb:j},{va:"+removeFormat",Q:CA,La:"tr-icon tr-removeFormat",factory:Mz},{va:"image",Q:DA,La:"tr-icon tr-image",factory:Mz},{va:"+strikeThrough",Q:EA,La:"tr-icon tr-strikeThrough",bb:j},{va:"+subscript",Q:JA,
La:"tr-icon tr-subscript",bb:j},{va:"+superscript",Q:KA,La:"tr-icon tr-superscript",bb:j},{va:"ltr",Q:FA,La:"tr-icon tr-ltr",bb:j},{va:"rtl",Q:GA,La:"tr-icon tr-rtl",factory:function(b,c,d,e,g,h){var l=Nz(b,c,d,e,g,h);l.pi=function(b){b=!!b;E.enable(l.getParent().m(),"tr-rtl-mode",b);l.Uc(b)};return l},bb:j},{va:"+BLOCKQUOTE",Q:HA,La:"tr-icon tr-BLOCKQUOTE",bb:j},{va:"+formatBlock",Q:iA,caption:jA,La:"tr-formatBlock",factory:function(b,c,d,e,g,h){var l=Oz(b,c,d,e,g,h);z.forEach(fA,function(b){var c=
b.caption,b=b.va,d=l.K(),c=new Ny(d.v("DIV",k,c),b,d);Lh(c,b);l.Fa(c)});Bz(l,eA);E.add(l.Va().X(),"goog-menu-noaccel");l.pi=function(b){b=b&&0<b.length?b:k;b!=l.V()&&l.za(b)};return l},bb:j},{va:"editHtml",Q:IA,caption:LA,La:"tr-editHtml",factory:Mz}];for(var NA=0,OA;OA=Sz.HA[NA];NA++)MA[OA.va]=OA;delete Sz.HA;a.PA={};PA.iT=Nk;a.QA=function(b){Cv.call(this);this.da=new le(this);this.bE=L("div",{style:"display:none"});this.g=this.oc=k;this.F={};H.extend(this.F,this.defaults,b||{})};y(QA,Cv);ya(QA.prototype,PA);QA.prototype.defaults={gk:k,title:"Distraction Free Mode",NJ:"back",NR:"publish",fw:"zu-editing-distraction-free",DS:"sticky-goog-scrollfloater",dT:"zm-editable-toolbar-container"};QA.prototype.ed=lf("FullScreenPlugin");MA.toggleFullScreen={va:"toggleFullScreen",Q:"写作模式",La:"tr-icon tr-max",factory:Mz};t=QA.prototype;
t.we=xa(H.pg,{SV:"toggleFullScreen",oU:"enterFullScreen",pU:"exitFullScreen"});t.w=function(){this.da.G();M(this.g);this.F=this.hp=this.oc=this.qb=this.g=k;QA.n.w.call(this)};
t.Qu=function(){var b=this.F,c=document.createElement("div");c.id="zu-distraction-free-editor";c.innerHTML='<div class="header"><div class="wrapper"><h1 class="title">'+b.title+'</h1><a href="#" class="'+b.NJ+'" name="return">返回</a><a href="#" class="'+b.NR+'" name="save">发布</a></div></div><div class="toolbar"><div class="tools"></div></div><div class="content" class="grid"></div>';document.body.appendChild(c);this.da.e(K("back",c),"click",function(b){b.preventDefault();RA(this)},m,this);this.da.e(K("publish",
c),"click",function(b){b.preventDefault();this.dispatchEvent("save")&&RA(this)},m,this);this.g=c;this.oc=K("content",c);this.hp=L("div",{className:"toolbar-info"});this.F.gk||(this.F.gk=this.C.field)};a.SA=function(b){if(b.hp){var c=$(b.hp);c.stop().text("草稿已经保存").fadeTo(600,0.5).delay(3E3).fadeOut(600,function(){c.text("")})}};t.Ve=function(b){this.g||this.Qu();switch(b){case "enterFullScreen":TA(this);break;case "exitFullScreen":RA(this);break;case "toggleFullScreen":this.tx()?RA(this):TA(this)}};
t.tx=function(){return E.has(document.body,this.F.fw)};
a.TA=function(b){if(b.dispatchEvent("willEnterFullScreen")){b.JC||(b.yN=history.length);b.JC=j;UA(b,"writing");b.fI=Lc(Sb((fa||window).document));mc(b.bE,b.F.gk);b.oc.appendChild(b.F.gk);E.add(document.body,b.F.fw);b.qb=K(b.F.dT,b.g);b.qb.appendChild(b.hp);var c=b.g;c.scrollTop=0;var d=b.qb.getBoundingClientRect().top;c.onscroll=pf(v(b.fH,b),function(){return c.scrollTop>d});b.da.e(document,"keydown",b.po,m,b);Ma(Fc(b.C.field))||b.C.Hf();b.dispatchEvent("enterFullScreen")}},a.RA=function(b){!Og&&
b.JC&&b.yN!==history.length?history.back():UA(b,"");b.qb.removeChild(b.hp);b.fH(m);b.g.onscroll=k;b.da.Da(document,"keydown",b.po,m,b);mc(b.F.gk,b.bE);E.remove(document.body,b.F.fw);window.scrollTo(b.fI.x,b.fI.y);b.dispatchEvent("exitFullScreen")},a.UA=function(b,c){xd(window,"hashchange",b.NF,m,b);location.hash=c||"";setTimeout(v(function(){this.da.e(window,"hashchange",this.NF,m,this)},b))};t.NF=function(){this.tx()?RA(this):"writing"===location.hash.slice(1)&&TA(this)};
t.po=function(b){27===b.keyCode&&this.dispatchEvent("shouldExitFullScreenOnEscape")&&RA(this)};t.fH=function(b){E[b?"add":"remove"](this.qb,this.F.DS)};a.WA=function(b,c){N.call(this);this.Qf=b;this.vz=c||VA;b.lb||(this.show=ha)};y(WA,Yk);a.VA="加载中...";t=WA.prototype;
t.show=function(){kc(this.g=L("div","zg-mt10",[L("h3",{style:"margin:0 0 5px;"},"分享到微博"),L("div","zm-tab-content",[this.mW=L("div",{className:"zg-section zg-clear",innerHTML:'<label><input data-bindurl="/oauth/auth/sina?next=/oauth/callback" class="sina-checkbox" type="checkbox"><i class="zg-ico-sina"></i> 新浪微博</label> '}),L("div","zg-section",L("div","zg-form-text-input",this.So=L("textarea",{style:"width:100%;height: 66px;"},"加载中..."))),L("div","zm-command",[L("div",["zm-item-meta","zg-left"],this.eS=
L("span")),this.FS=L("a",{"class":"zg-btn-blue weibo-share-button",href:"javascript:;"},"分享到微博")])])]),J("zh-question-answer-form-wrap"));this.h().e(Y,"sina_callback",function(b){this.rz(b.tc.id,b.tc.name)});this.Fu();this.Ij();Dp.O().refresh();var b=this;this.vz===VA?Fi("/answer/"+b.Qf.lb+"/sharetext",function(c){if((c=Ie(c.target))&&c.sina)b.vz=c.sina,b.fb()},"GET"):this.fb()};t.rz=function(b,c){rh.name=c;this.uS=rh.id=b;this.uc.checked=j;this.Ij()};
t.Ij=function(){var b=K("weibo-share-button",this.g),c=this.uc.checked;E.enable(b,"zg-btn-blue",c);E.enable(b,"zg-btn-disabled",!c)};t.fb=function(){this.So.value=this.vz;this.Hz=new al(this.So);this.lH=new ev(this.So,this.eS,140,cv);this.h().e(this.FS,"click",this.ra)};t.Fu=function(){this.uc=K("sina-checkbox",this.g);this.h().e(this.uc,"change",this.wy)};t.wy=function(b){var b=b.target,c=b.getAttribute("data-bindurl");b===this.uc&&!this.uS?(window.open(c),b.checked=m):this.Ij()};
t.ra=function(b){if((b=b.target)&&E.has(b,"zg-btn-blue")&&this.So.value){b=new Kk(j);b.add("content",this.So.value);var c=[];this.uc.checked&&c.push("sina");b.add("via",c.join(","));this.Lj(b);Nk("share",this.mX?"answer_weibo":"question_weibo")}else U("请您选择或绑定微博后再进行分享！")};t.Lj=function(b){b.add("aid",this.Qf.na);this.xhr=new V(j);oe(this.h(),this.xhr,"complete",this.uu);this.xhr.ajax("/answer/share",b.dd())};t.uu=function(){var b=Ie(this.xhr);b&&b.r?U(b.msg):(U("分享发送完毕"),R(this.g,m))};a.XA=function(b,c,d){Ku.call(this,b,c,d);this.Jo(j)};y(XA,Ku);gp("goog-checkbox-menuitem",function(){return new XA(k)});a.YA=function(b,c){N.call(this);this.ia=b;this.Qb=c;this.data=fh};y(YA,Yk);t=YA.prototype;
t.z=function(){this.Wl=J("zh-question-redirect-info");this.Wl.innerHTML&&(this.Qn=j);this.h().e(this.Wl,"click",function(b){"cancel"===b.target.name&&ZA(this)});var b=J("zh-question-side-header-wrap");if(dh.sc&&!dh.HE&&b){var c=J("zh-question-filter-wrap");c?jc(b,c):b.style[A?"styleFloat":"cssFloat"]="none"}(this.Rf=J("zh-question-operation-menu"))&&this.nj();this.h().e(Li,"anon_change",function(b){var c=J("zh-question-side-invitation-anon");c&&R(c,b.ib);(c=J("zh-question-side-invitation-notanon"))&&
R(c,!b.ib);this.Ml&&this.Ml.Xa(Zt(this.data.Pg)||!b.ib)});(this.kk=J("zh-question-webshare-container"))&&this.h().e(this.kk,"click",this.Bz)};
t.nj=function(){this.ab=new Nu;var b=this.data.Cm,c=this.Rf.getAttribute("data-auth"),c=c?c.split(","):[];if(b==k||0===b){this.ab.Fa(this.Ds=$A("使用匿名身份",j));this.Ds.Uc(this.data.ib);if((!mh||!z.contains(mh,"question_op_redirect"))&&"close"!==fh.status)this.ab.Fa(this.Ml=$A(this.Qn?"撤消重定向":"问题重定向")),this.Ml.Xa(Zt(this.data.Pg)||!this.data.ib);z.contains(c,"auth-f-manage")&&this.ab.Fa(this.vQ=$A("更新话题页显示",m));this.h().e(this.ab,"action",this.fj);this.Ds&&this.h().e(Li,"anon_change",function(b){this.Ds.Uc(!!b.ib)});
this.Qb&&z.contains(c,"auth-pu-mark")&&(this.ab.Fa(this.yy=$A("优质回答",j)),this.yy.Uc(this.Qb.jO));b=new pz("Settings",this.ab);b.Xl=j;sz(b);b.o(this.Rf)}};a.$A=function(b,c){return!b?new Mu:c?new XA(b):new Ku(b)};
t.fj=function(b){var c=this.Ds;if(b.target===c)ct(c.ve()?1:0,function(b){b||c.Uc(!c.ve())});else if(b.target===this.Ml){if(dy({Ul:j})()===m)return m;this.wo||(this.wo=new Gx(this.ia),this.h().e(this.wo,"change",this.LO));this.ab.D(m);this.Qn?ZA(this):this.wo.show()}else b.target===this.qQ?Fi("/question/"+this.data.lb+(this.qQ.ve()?"/unlock_summary":"/lock_summary"),function(){top!==window?top.location.href="/question/"+fh.lb:window.location.reload()},"POST"):b.target===this.vQ?$.post("/refresh_topic_feeds",
{q:fh.lb}).done(function(b){b.r||U("操作成功！")}):b.target===this.yy&&$.post("/answer/"+this.Qb.lb+(this.yy.ve()?"/good_mark":"/good_unmark")).done(function(b){b.r||U("操作成功！")})};t.LO=function(){this.Wl.innerHTML='<div class="zg-wrap"><div class="zu-global-nitify-inner"><span class="zu-global-notify-icon"></span>此问题将跳转至 <a href="/question/'+this.wo.ct+'">'+this.wo.uG+'</a> （<a href="javascript:;" name="cancel">撤消重定向</a>）</div></div>';R(this.Wl,j);this.Qn=j;this.Ml.fm("撤消重定向")};
a.ZA=function(b){b.Wl.innerHTML="";R(b.Wl,m);b.Qn=m;b.Ml.fm("问题重定向");Fi("/question/unredirect",k,"POST","qid="+b.ia+"&rqid="+b.ct)};t.Bz=function(b){var c=Jk(this.kk,b.target);c&&c.name&&sn(function(){var b=$("#zh-question-webshare-container").data();new fv([b.title,b.type,b.urlToken,{answer:{aid:b.id},question:{qid:b.id}}[b.type]],"tb-webshare-"+c.name);Y.Z({type:"ga_click_share_question_box",target:c,data:{type:c.name}})},function(){return{lg:"letter"===c.name}})()};a.aB=function(b){Qr.call(this,j,"/topic/bio/update","bio");this.jp=b[0];this.params=["tid="+this.jp[3]];this.content=b[1];this.Gb='<a href="javascript:;" name="edit">描述你关于 '+this.jp[0]+" 的经验</a>";this.Qt=j};y(aB,Qr);aB.prototype.rh=function(){aB.n.rh.call(this);this.Jk.innerHTML="更新"};aB.prototype.ca=function(b){aB.n.ca.call(this,b);var b=this.K(),c=b.v("strong",k,L("a",{href:"/topic/"+this.jp[1],title:this.jp[0],"class":""},this.jp[0]));b.Jn(c,this.Ob)};a.bB=function(b,c){N.call(this);this.QN=c;this.Pk=b;this.items=[];this.mY="/url_to_fetch_question_related_topic_bio_items";this.Kx=m};y(bB,Yk);
a.cB=k,a.dB=function(){cB||(cB=new bB(hh,m));return cB},a.eB=function(b){if(!b.locked)if(!b.TO&&b.Kx){b.locked=j;var c=new V(j);b.h().e(c,"success",function(b){this.TO=j;this.locked=m;b=Ie(b.target);b.r||(this.Pk=b.msg,eB(this))});c.ajax("/question/"+b.EG+"/bios",k,"GET")}else b.S||(b.S=new yi,b.S.Ma("修改话题经验"),hi(b.S,k),bi(b.S,m),c=b.S.X(),c.innerHTML='<div class="zg-section-title">修改每个话题旁边靠近你名字的简介：</div>',b.W(c)),b.S.D(j)};
bB.prototype.W=function(b){this.g=L("div","zu-bio-editor-wrap",[this.TN=L("div","zu-bio-editor-inner-wrap"),this.Bc=L("div","zm-command",[this.Jk=L("a",{name:"save",href:"javascript:;",className:"zg-r3px zg-btn-blue"},"完成")])]);z.forEach(this.Pk,function(b){b=new aB(b);b.W(this.TN);this.items.push(b)},this);this.QN&&R(this.Bc,m);b.appendChild(this.g);this.h().e(this.Bc,"click",this.ra)};
bB.prototype.hw=function(){var b=this.items.length,c;if(!b&&this.Pk.length)for(c=0;c<this.Pk.length;c++)if(this.Pk[c][1])return this.Pk[c][1];var d=k;for(c=0;c<b;c++)if(d=this.items[c].$a())return d};bB.prototype.ra=function(b){if((b=this.Xe(b.target))&&"save"===b.name)this.S&&this.S.D(m),this.dispatchEvent("change")};a.fB=function(b,c){T.call(this);this.wb=b;this.PW=this.wb.gr();this.Zq=Vs(this.wb);this.isContentEditable=this.wb.isContentEditable();this.WS=30;this.vc=new Id(1E3*this.WS);this.ia=fh?fh.ia:0;this.yE=c||m};y(fB,T);t=fB.prototype;t.w=function(){gB(this);this.vc.G();fB.n.w.call(this)};
t.o=function(b){this.g=b;this.Mr=K("draft-saved-info",b);R(this.Mr,m);this.JN=K("draft-saved-time",b);this.pK=K("draft-clear-button",b);this.AW=this.isContentEditable?Lv:["change","input"];b=this.h().e(this.vc,Jd,this.dt).e(this.pK,"click",this.qK).e(this.Zq,"keydown",this.wO);"oninput"in this.Zq&&!A?b.e(this.Zq,"input",this.VN):b.e(this.Zq,"keydown",this.WN);var c=ch.de&&1E3*ch.de[1];c&&(hB(this,c),this.$z=setInterval(v(function(){hB(this,c)},this),22E3))};
t.wO=function(b){if((b.metaKey||b.ctrlKey)&&"s"===ik[b.keyCode])this.IO(),this.isContentEditable||b.preventDefault()};a.jB=function(b){iB(b,"保存中…");b.en();b.UN()};t.en=function(){$(window).on("beforeunload.DraftSaver",v(s("你的修改还未成功保存，确认离开该页面吗？"),this))};t.Sk=function(){$(window).off("beforeunload.DraftSaver")};t.VN=function(){this.ji();jB(this)};t.WN=function(b){th(b.keyCode)&&(this.ji(),jB(this))};t.Zo=function(){this.vc.start()};t.ji=function(){this.vc.stop()};t.Ea=function(b){this.wb.Ea(b);this.wb.Lo()};
t.$a=function(){return this.wb.If()};t.RG=function(){if(!this.tg){var b=this.$a();if(b){iB(this,"保存中…");var b=(new jj).add("qid",this.ia).add("content",b),c=new V;c.ajax("/answer/draft/save",b.toString(),"POST");this.h().e(c,"success",v(this.ff,this));this.PE=c}}};t.AT=150;t.dt=Wk(fB.prototype.AT,fB.prototype.RG);t.JO=350;t.IO=Wk(fB.prototype.JO,fB.prototype.RG);t.XN=3E3;t.UN=Wk(fB.prototype.XN,function(){this.tg||(this.$a()?this.dt():kB(this))});a.gB=function(b){b.$z&&(clearInterval(b.$z),b.$z=k)};
t.ff=function(b){var b=Ie(b.target),c="",c=0===b.r?"已保存":b.msg||"保存失败！请稍后再试。";gB(this);R(this.Mr,j);iB(this,c);this.Sk();this.dispatchEvent("saveContent");this.Zo()};a.hB=function(b,c){var d=Ut(c||za());/^\d/.test(d)&&(d=" "+d);iB(b,"已存于"+d)},a.iB=function(b,c){R(b.Mr,j);xc(b.JN,c)};
t.qK=function(b){b.preventDefault();Ci("清除草稿",this.yE?"你确定要清除保存的草稿并取消编辑吗？":"你确定要清除保存的草稿吗？",function(b){b&&(this.yE?(kB(this),this.wb.dispatchEvent("cancel_edit"),this.wb.ii()):(this.Ea(""),kB(this),this.wb.ready(function(){var b=this.Ia;this.Jd?Zs(b,b.value.length):b.field.lastChild?Xs(b.field.lastChild):b.Hf();this.Yk&&(this.Yk.scrollTop=this.Yk.scrollHeight)})))},this)};a.kB=function(b){Fi("/draft/delete",k,"POST","qid="+b.ia);b.PE&&(b.PE.abort(),b.Sk());gB(b);R(b.Mr,m);b.dispatchEvent("clearContent")};a.lB=function(b,c,d){Sr.call(this,m);this.ib=!!b;this.VH=c;this.Gb="&nbsp;";this.fq=d;this.Pt=this.Ev=this.aD=this.enabled=j;if(S.yi||!S.ua())this.Qx='<span style="font-style: normal;color: #999;">写回答…</span>'};y(lB,Sr);t=lB.prototype;t.nD=function(){var b=Ub("h2","zm-editable-content",J("zh-question-title"))[0];return{title:b&&(/answer\/\d+$/.test(location.pathname)?Fc(b):b.firstChild.nodeValue)||"",gk:this.Ti}};t.hw=p("fq");t.jt=ca("ib");
a.mB=function(b,c){b.fq=c?c:S[4];if(b.Al&&$.trim(c)){var d=c;20<d.length&&(d=d.substring(0,17)+"...");b.VJ.innerHTML="，"+Wa(d)+'<a name="edit_bio" class="zu-edit-button" href="javascript:;"><i class="zu-edit-button-icon"></i>修改话题经验</a>'}};t.Xa=function(b,c){this.enabled=b;this.Al?(this.ii(),this.Gb=c,this.Ob.innerHTML=this.Gb):c&&(this.Gb=c)};t.ca=function(b){lB.n.ca.call(this,b);this.Al=j;E.add(this.Ob,"zu-answer-form-disabled-wrap")};t.w=function(){this.Pr&&(M(this.Pr),this.WH=this.Pr=k);lB.n.w.call(this)};
t.cj=function(b){this.jt(b.ib);this.Tp&&(this.Tp.checked=b.ib)};t.B=function(){lB.n.B.call(this);this.h().e(Li,"anon_change",this.cj)};
t.rg=function(){lB.n.rg.call(this);var b=this.K(),c=S.ua();this.Pr=b.v("div","zh-answer-form clearfix",[c?Yt(this.VH):"",this.WH=b.v("div",k,[b.v("div","zu-answer-form-title",[c?Xt(this.VH):"我来回答这个问题",this.VJ=b.v("span")])])]);mB(this,this.fq);b.Jn(this.Pr,this.Ti);this.h().e(this.WH,"click",this.ra);S.ua()?S.yi||nB(this,'<div class="active-mask-tip-answer">为正常使用知乎提问、回答、评论和编辑功能，请验证您的邮箱、激活帐号。</div>','<div class="zm-command"><a class="zg-r3px zg-btn-blue" href="javascript:;">我要激活</a></div>',function(b,
c){b.attr("data-activate-dialog","");c.attr("data-activate-dialog","")}):nB(this,'<div class="signin-mask-tip-answer"></div>','<div class="zm-command"><a class="zg-r3px zg-btn-blue" href="javascript:;">我要回答</a></div>',function(b,c){function g(){new on("question_answer_add_start")}b.on("click",g);c.on("click",g)})};a.nB=function(b,c,d,e){c=$(c).css("top",0).css("z-index",9);$(b.Bc).hide();d=$(d);$(b.Ti).append(c).after(d);e&&e.call(b,c,d)};
t.nr=function(b){switch(b){case "edit_bio":b=dB();if(!this.Hu){var c=fh.lb;b.Kx=j;b.EG=c;this.h().e(b,"change",this.ly)}this.Hu=j;eB(b);break;case "cancel_delete":this.dispatchEvent("cancel_delete_answer");break;case "answer_my_question":var d=this;this.pk?this.pk.show():(d.pk=$('<div class="question-tip-box-bottom">确定想要回答你自己提出的问题吗？<br>如果需要对问题做出更多的解释和说明，请编辑问题描述。 如果需要对其他回答做出回应，请在相应回答下通过评论发布。<br><div class="zg-clear"><a href="javascript:;" class="zg-right zg-btn zg-btn-blue" name="confirm">确定</a><a href="javascript:;" class="zg-right zg-link-gray " name="cancel">取消</a></div></div>'),
d.pk.on("click",'[name="cancel"]',function(){d.pk.hide()}).on("click",'[name="confirm"]',function(){d.pk.hide();$(d.Ob).hide();d.Xa(j);d.mf()}),$(d.Ob).after(d.pk))}return j};t.he=function(){"editing"===this.status?this.Ab&&R(this.Ab,j):this.Ab&&R(this.Ab,m);R(this.$c,m);this.Ob&&R(this.Ob,!this.enabled)};t.yK='<div class="zm-command clearfix"><div class="draft-controls zg-left"><span class="draft-saved-info"><a class="draft-clear-button goog-inline-block" href="#" data-tip="s$b$删除草稿"><i class="zg-icon zg-icon-bin"></i><span class="hide-text">清除草稿</span></a><span class="draft-saved-time"></span></span></div><% if (questionStatus !== "normal") { %><span class="zg-gray-normal" style="margin-right:5px;">被<%= statusText %>的问题不允许添加新的回答</span><a class="zg-right" data-tip="s$b$为什么部分问题会被「关闭」「建议修改」？" href="//www.zhihu.com/question/21290061 "><i class="zg-icon zg-icon-question-mark"></i></a><% } %><span class="<%= (questionStatus !== "normal" ? "hidden" : "") %>"><label style="cursor:pointer"><input name="anno-checkbox" type="checkbox">匿名</label> <a class="submit-button zg-btn-blue" name="save" href="javascript:;">发布回答</a></span></div>';
t.rh=function(){var b=Qk(this.yK);this.Bc=fc(b({questionStatus:fh.status,statusText:{suggest:"建议修改",evaluate:"建议修改",close:"关闭"}[fh.status]}));this.Jk=$(".submit-button",this.Bc)[0];var b=$("input[name=anno-checkbox]",this.Bc)[0],c=$("label",this.Bc)[0];this.Tp=b;fh.ib&&(this.Tp.checked=j);ug(c,j);this.Ab.appendChild(this.Bc);this.ready(function(){if(this.Ia&&this.Ia.on)this.Ia.on("load",this.ix,m,this)})};
t.ix=function(){var b=new fB(this);Rc(this,b);this.h().e(b,"saveContent",function(){var b=!this.Jd&&this.Ia.Fh("FullScreenPlugin");b&&SA(b)},m,this);var c=Vs(this);this.h().e(c,"focus",function(){b.Zo()}).e(c,"blur",function(){b.ji();b.dt()}).e(this,"saveSuccess",function(){b.ji();kB(b)});b.o(this.Bc)};t.ly=function(){var b=dB().hw();b&&mB(this,b)};a.oB=function(b,c,d,e,g,h){Sr.call(this,e,c,d,h);this.ia=b;this.Pn=this.Ao=m;this.CQ=g};y(oB,Sr);a.pB=[{value:"精简文字描述",label:"精简文字描述"},{value:"补充必要的信息",label:"补充必要的信息"},{value:"改进标点或格式",label:"改进标点或格式"},{value:"other",label:"其他"}];t=oB.prototype;t.o=function(b){oB.n.o.call(this,b);this.h().e(Li,"anon_change",this.cj)};t.cj=function(b){this.Pn||E.enable(this.g,"zm-editable-disabled",b.ib)};
t.rh=function(){oB.n.rh.call(this);var b=L("a",{"class":"zg-right zg-link-litblue",href:"http://www.zhihu.com/question/19550238/answer/12202028",target:"_blank"},"为什么问题可以被公共编辑？"),c=L("select",{style:"1px solid #999 "}),d=L("option",{value:"none"},"请选择一个修改理由...");c.appendChild(d);z.forEach(pB,function(b,d){var e=L("option",{value:b.value},d+1+". "+b.label);c.appendChild(e)});this.Uy=L("div",{"class":"zm-editable-require-reason-wrap",style:"padding:10px 0 0 0"},[b,this.XX=c,this.mF=L("span"),this.fR=
L("div",{"class":"zg-form-text-input",style:"height:22px;margin:10px 0 0 0;display:none"},this.eR=L("textarea",{style:"width:100%;height:22px !important;min-height:22px !important;"}))]);jc(this.Uy,this.Bc);this.Ao&&this.ei(" * 必选","zg-gray-normal");var e=Ub("select",k,this.Uy)[0];this.h().e(e,"change",function(){R(this.fR,"other"===e.value);this.ei(" * 必选","zg-gray-normal")})};
t.ff=function(b){var c=Ub("select",k,this.Uy)[0],d=c.value;if(this.Ao){if("none"===d){this.ei("请选择一个修改理由");return}if("other"===c.value&&(d=Ak(this.eR.value),!d)){this.ei("请填写修改理由");return}}"title"===this.Gq&&-1===b.indexOf("?")&&-1===b.indexOf("？")?this.ei("还没有输入问号"):("none"===d&&(d=""),this.params=["id="+this.ia+"&reason="+encodeURIComponent(d)+"&question_id="+this.ia],this.dispatchEvent("change"),oB.n.ff.call(this,b),this.ei("* 必选","zg-gray-normal"),this.Ao=j)};
t.ei=function(b,c){this.mF.innerHTML=b;E.set(this.mF,c||"zg-error-text")};t.If=function(){return this.Jd&&this.CQ?Bk(Ia(this.Ia.value)):oB.n.If.call(this)};t.Te=function(){$(window).on("beforeunload.EditorWithReason",v(s("你对问题的修改还未保存，确认离开该页面吗？"),this))};t.Af=function(){$(window).off("beforeunload.EditorWithReason")};t.ii=function(){oB.n.ii.call(this);this.Af()};t.mf=function(){oB.n.mf.call(this);this.Te()};a.qB=function(b,c){Nu.call(this,b,c);this.Bm=j;this.Fe(j);this.D(m,j);this.of=new Nd};y(qB,Nu);t=qB.prototype;t.aT=m;t.LE=0;t.Oe=k;t.ca=function(b){qB.n.ca.call(this,b);(b=b.getAttribute("for")||b.htmlFor)&&this.attach(this.K().m(b),1)};t.B=function(){qB.n.B.call(this);Ld.forEach(this.of,this.oB,this);var b=this.h();b.e(this,"action",this.gP);b.e(this.K().Ba(),"mousedown",this.JF,j);C&&b.e(this.K().Ba(),"contextmenu",this.JF,j)};
t.attach=function(b,c,d,e,g){if(!b||!this.of.Cd(ua(b)))b?(c={g:b,uH:c,RO:d,MC:e?"contextmenu":"mousedown",Tx:g},this.of.set(ua(b),c),b=c):b=k,this.ya&&this.oB(b)};t.oB=function(b){this.h().e(b.g,b.MC,this.ZF)};t.detach=function(b){(!b||!this.of.Cd(ua(b)))&&f(Error("Menu not attached to provided element, unable to detach."));b=ua(b);if(this.ya){var c=this.of.get(b);this.h().Da(c.g,c.MC,this.ZF)}this.of.remove(b)};
a.rB=function(b,c,d,e,g){var h=b.R();b.xx()&&b.aT?b.hide():(b.Oe=g||k,b.dispatchEvent("beforeshow")&&(d="undefined"!=typeof d?d:4,h||(b.m().style.visibility="hidden"),R(b.m(),j),c.ha(b.m(),d,e),h||(b.m().style.visibility="visible"),b.Lb(-1),b.D(j)))};t.jH=function(b,c,d){c=la(b.uH)?new Qt(b.g,b.uH,j):new Pt(c,d);c.hm&&c.hm(5);rB(this,c,b.RO,b.Tx,b.g)};t.hide=function(){this.R()&&(this.D(m),this.R()||(this.LE=za(),this.Oe=k))};t.xx=function(){return this.R()||150>za()-this.LE};t.gP=function(){this.hide()};
t.ZF=function(b){for(var c=this.of.Cb(),d=0;d<c.length;d++){var e=this.of.get(c[d]);if(e.g==b.currentTarget){this.jH(e,b.clientX,b.clientY);b.preventDefault();b.stopPropagation();break}}};t.JF=function(b){this.R()&&!this.xf(b.target)&&this.hide()};t.Oc=function(b){qB.n.Oc.call(this,b);this.hide()};t.w=function(){qB.n.w.call(this);this.of&&(this.of.clear(),delete this.of)};a.sB=function(){T.call(this)};y(sB,T);sB.prototype.H=function(b,c){sB.n.H.call(this,b,c);this.h().e(b,"beforeexpand",this.jN)};sB.prototype.jN=function(b){var c=b.target;Oh(this,function(b){c!==b&&b.fc()&&b.Ja(m)})};sB.prototype.G=function(){this.h().G();sB.n.G.call(this)};a.tB=function(){Wh.call(this,i,i,i);this.Tk=j;this.D(j)};y(tB,yi);tB.prototype.B=function(){tB.n.B.call(this);this.Ug(490);$(this.m()).addClass("user-guiding-dialog")};tB.prototype.Yj=function(b){$('[class^="view"]',this.g).hide();$(".view-"+b,this.g).show()};a.uB=function(b,c){T.call(this);this.cR=b;this.Ps=c;this.bO=this.Y=k;this.bd=m;this.Kn=k;this.Bl=[];this.sH=[];this.Vf=m;this.GO="loading";this.vE="zg-btn-white";this.cO="invite-button"};y(uB,T);t=uB.prototype;t.v=function(){this.g=L("div",{style:"display:none",className:"question-invite-panel"})};t.W=function(){this.Vf=j;uB.n.W.call(this)};
t.B=function(){uB.n.B.call(this);var b=this.g,c=this.h();if(!this.Vf){c.e(Li,"anon_change",this.reload);var d=K("cancel-anon",b);d&&c.e(d,"click",this.bM);if(!K("error-message")){var d=K("search-input",b),e=K("invite-title",b);this.px=K("invite-status",b);c.e(this.px,"click",this.cM);var g=K("suggest-persons",b);g&&(c.e(g,"click",this.Kw),this.rH=g);$(".invite-status",b).on("mouseenter mouseleave",".invited-shortlist",function(b){$(".invited-hovercard",this).toggleClass("in","mouseenter"===b.type)});
this.ex(d,e);this.sH=$(this.rH).children().map(this.kG).get();this.Bl=$(".invited-fulllist",this.px).children().map(this.kG).get();var h=function(b){0>b||b>n-1||(w.find("li").hide().slice(4*b,4*(b+1)).show(),0===b?q.addClass("link-disabled"):q.removeClass("link-disabled"),b===n-1?r.addClass("link-disabled"):r.removeClass("link-disabled"),l=b)},b=this.g,l=0,n,q,r,w;w=$(".suggest-persons",b);n=w.find("li").length/4;q=$(".js-prev",b).on("click",function(){h(l-1)});r=$(".js-next",b).on("click",function(){h(l+
1)});h(0);R(this.g,this.bd)}}};t.hb=function(){uB.n.hb.call(this);this.h().G()};t.Ii=s('<i class="icon icon-spike"></i><div class="spinner">正在加载，请稍等 <i class="spinner-gray"></i></div>');t.reload=function(){this.fc()?this.Yh():this.Vf=j};t.Yh=function(){var b=this,c=this.GO;this.hb();E.add(this.g,c);this.g.innerHTML=this.Ii();return $.get("/node/QuestionInvitePanelV2",{params:{question_id:this.cR}}).done(function(d){b.Vf=m;E.remove(b.g,c);d=fc(Ma(d));R(d,b.fc());mc(d,b.g);b.g=d;b.B()})};
t.w=function(){uB.n.w.call(this);this.bO=k;this.Y.G()};t.fc=p("bd");t.expand=function(){this.Ja(j)};t.collapse=function(){this.Ja(m)};t.Ja=function(b){if(b!==this.bd){this.dispatchEvent(b?"beforeexpand":"beforecollapse");var c=v(function(){this.dispatchEvent(b?"expand":"collapse")},this);b&&this.Vf?this.Yh().done(c):c();this.bd=b;R(this.g,b)}};t.sf=function(){this.Ja(!this.bd)};
t.ex=function(b){var c=this,d=Qk('<img class="zm-item-img-avatar zg-left" src="<%=avatar%>"><span class="zu-autocomplete-row-name" title="<%-fullname%>"><%-fullname%></span><span class="zg-gray-normal zu-autocomplete-row-description"><%=headline%></span>');this.Y=new Lp(b,{Ae:8,source:"/people/autocomplete?type=invite",Rj:b.offsetParent,placeholder:"搜索你想邀请的人",Tc:function(b,c,h){h.innerHTML=d(b.data)},filter:function(b){return z.filter(b,function(b){var d=b.id;return!z.find(c.Bl,function(b){return b.id===
d})})},select:function(b){vB(c,"ask_to_answer_search");bu(c.Ps,b.id,"search").done(function(d){if(d.r)return U(d.msg);wB(c,b);xB(c,b.id,j)});return""}})};a.yB=function(b,c,d){b=b.vE;d?(E.add(c,b),xc(c,"收回邀请")):(E.remove(c,b),xc(c,"邀请回答"))};t.bM=function(){ct(0)};a.vB=function(b,c){var d=fh;b.dispatchEvent(new rw("click!invitation",{category:"invitation",action:"ask_to_answer",label:c,value:d.DE?k:d.fe}))};
t.Kw=function(b){var c=b.target;if("BUTTON"===c.tagName||E.has(c,this.cO)){this.Kn&&"pending"===this.Kn.state()&&this.Kn.abort();b="related"===c.getAttribute("data-type")?"recommended_relative_questions":"recommended_top_answerers";vB(this,b);var d=c.getAttribute("data-uid"),e=this.vE,g=v(function(b){b?(yB(this,c,j),b=z.find(this.sH,function(b){return b.id===d}),wB(this,b),this.jK()):(yB(this,c,m),zB(this,d))},this);E.has(c,e)?(this.Kn=au(this.Ps,d),g(m)):(this.Kn=bu(this.Ps,d,b).done(function(b){b.r&&
(U(b.msg),g(m))}),g(j))}};t.cM=function(b){b=b.target;"BUTTON"===b.tagName&&(b=b.getAttribute("data-uid"),au(this.Ps,b),xB(this,b,m),zB(this,b))};a.xB=function(b,c,d){var e=$(".invite-button",b.rH).filter(function(){return this.getAttribute("data-uid")===c}).get(0);e&&yB(b,e,d)};t.kG=function(){var b=$(this),c=$(".zm-item-link-avatar",b);return{id:String($("button",b).data("uid")),avatar:$("img",c).attr("src"),fullname:c.attr("title"),url_token:c.attr("href").split("/").slice(-1)[0]}};
a.wB=function(b,c){b.Bl.unshift(c);AB(b);$(".ignore-invite-hint").css("display","none")},a.zB=function(b,c){b.Bl&&z.qR(b.Bl,function(b){return b.id===c})&&(AB(b),$(".ignore-invite-hint").css("display","none"))};t.fS='您已邀请 <span class="invited-shortlist"><% helper.each(persons.slice(0, 2), function(person, i, sliced) { %><a href="/people/<%=person.url_token%>" class="zg-link-gray"><%=person.fullname%></a><%= i !== sliced.length - 1 ? "、" : ""%><% }); %><%=helper.fullList()%></span><% if (persons.length > 2) { %> 等 <%=persons.length%> 人 <% } %>';
t.IL='<div class="invited-hovercard"><i class="icon icon-spike"></i><ul class="invited-fulllist"><% helper.each(persons, function(person, i) { %><li><a title="<%-person.fullname%>" class="zm-item-link-avatar" href="/people/<%=person.url_token%>"><img src="<%=person.avatar%>" class="zm-item-img-avatar"></a><a href="/people/<%=person.url_token%>" class="zg-link-gray" title="<%-person.fullname%>"><%=person.fullname%></a><button class="cancel-button zg-link-btn zg-link-gray" data-uid="<%=person.id%>">收回邀请</button></li><% }) %></ul></div>';
a.AB=function(b){var c=b.Bl,d={each:z.forEach,fullList:function(){return Qk(b.IL,{persons:c,helper:d})}};b.px.innerHTML=c.length?Qk(b.fS,{persons:c,helper:d}):""};t.jK=xk(function(){S.Pg&&$.post("/question/popup",{action:"invite",question_token:fh.lb},function(b){if(b){var c=new tB;c.Ma("邀请回答小窍门");c.Ea(b);c.ha();$(".js-close",c.g).on("click",function(){c.D(m)})}})});a.BB=function(b){this.data=b;this.oa=k};y(BB,T);t=BB.prototype;t.B=function(){BB.n.B.call(this);this.h().e(this.g,"click",this.Kl);var b=K("panel-container",this.g);b&&(this.Cj=new sB,this.H(this.Cj),this.Cj.o(b),this.oa=new Ew(this.data.ia,"question"),this.Cj.H(this.oa),Iw(this.oa,this.Cj.m(),$(".toggle-comment",this.g)[0]),CB(this));this.h().e(this,"click!",function(b){"comment"===b.namespace&&b.xc.fill("label","question")})};
t.Kl=function(b){var c=(b=Jk(this.g,b.target))&&b.name;if(c)switch(c){case "report-question":Au("question",this.data.ia,'<a href="http://www.zhihu.com/question/19806261" class="zg-link-gray">知乎提问规范</a>');break;case "addcomment":"添加评论"===$.trim($(b).text())?sn(this.kr,{ua:"question_add_comment_start"}).call(this,b):this.kr(b);break;case "remove":Ci("删除问题","你确定要删除这个问题吗？相关的评论也将被删除。",function(b){if(b){var c=new V(j);O(c,"complete",function(){var b=Ie(c);b&&!b.r?window.location.href="/":U(b.msg)});c.ajax("/question/delete/"+
this.data.ia)}},this);break;case "admin":c=this.fJ;c||(c=new qB,c.o(J("zh-question-admin-menu")),Oh(c,function(b){b.za(b.m().getAttribute("data-action"))}),this.h().e(c,"action",function(b){b=this.VA=b.target;(new sw).open(b.m(),{id:this.data.ia,type:"question"},v(this.DK,this))}),this.fJ=c);c.R()?c.D(m):rB(c,new Qt(b,1,j),0,new Pf(5,0,5,0));break;case "share":Y.Z({type:"ga_click_share_question_box",target:b});this.rc();break;case "invite":this.Kw()}};
t.kr=function(b){this.oa.sf();this.oa.fc()&&this.oa.mi("view_comments",parseInt(Fc(b),10)||0)};a.CB=function(b){if("normal"===fh.status){var c=new uB(b.data.ia,b.data.lb),d=J("question-invite-panel");d?(c.o(d),b.Cj.H(c),c.Ja(!b.oa.fc()),b.dispatchEvent(new rw("show!invitation",{category:"invitation",action:"ask_to_answer_card",label:""}))):(c.W(b.Cj.m()),b.Cj.H(c));b.ox=c}};
t.Kw=function(){if(this.ox){this.ox.sf();var b=this.ox.fc();this.dispatchEvent(new rw("click!invitation",{category:"invitation",action:(b?"show":"hide")+"_ask_to_answer_card",label:"?",value:this.data.fe}))}else CB(this)};t.rc=sn(function(){new fv(["分享问题","question",this.data.lb,{qid:this.data.ia}],"tb-webshare-sina")},{ua:"question_question_share"});t.DK=function(b){this.VA.V(b.msg.action);this.VA.fm(b.msg.caption)};a.Vw=function(b,c){this.tb=b;this.entryType=c;this.Tl=k;this.bd=m};y(Vw,T);t=Vw.prototype;t.fc=p("bd");t.Ja=function(b){this.bd=!!b};t.Ra=function(){return this.Ap.data("votecount")};t.Yh=function(){this.Tl&&"pending"===this.Tl.state()||(this.Tl=("post"===this.entryType?Wu:du)(this.tb,this.bd).done(v(this.Ys,this)))};t.Ys=function(b){if(b=Ma(b))b=$(b),this.Ap.replaceWith(b),this.Ap=b,this.fb(),this.dispatchEvent("change")};t.fb=function(){var b=this;$("a.more",this.Ap).click(function(){b.Ja(j);b.Yh()})};
t.B=function(){this.Ap=$(this.g);this.fb()};a.DB=function(b){this.J=$(b);this.Dg()};DB.prototype.Dg=function(){var b=[this.J.get(0)].concat(this.J.parents().get()),c=$.map(b,function(b){return $(b).data("navigable")})[0],d=c&&$.grep(c.items(),function(c){return~$.inArray(c,b)})[0];this.EX=c;this.bP=d};DB.prototype.getItem=p("bP");a.EB=function(b,c,d,e){Sr.call(this,b,c,d,e)};y(EB,Sr);t=EB.prototype;t.B=function(){EB.n.B.call(this);this.ready(function(){if(this.Ia&&this.Ia.on)this.Ia.on("load",this.ix,m,this)})};
t.ix=function(){var b=new fB(this,j);Rc(this,b);this.h().e(b,"saveContent",function(){var b=!this.Jd&&this.Ia.Fh("FullScreenPlugin");b&&SA(b);$(this.nq).text("保存草稿并离开");$(this.g).find(".zu-edit-button span").text("修改（有未发布的编辑草稿）")}).e(b,"clearContent",function(){$(this.nq).text("取消");$(this.g).find(".zu-edit-button span").text("修改")});var c=Vs(this);this.h().e(c,"focus",function(){b.Zo()}).e(c,"blur",function(){b.ji();b.dt()}).e(this,"saveSuccess",function(){delete ch.de;b.ji();kB(b)});b.o(this.Bc);
ch.de&&ch.de[0]&&$(this.nq).text("保存草稿并离开")};
t.rh=function(){this.Bc=L("div","zm-command",[this.JW=$('<div class="draft-controls zg-left"><span class="draft-saved-info"><a class="draft-clear-button goog-inline-block" href="#" data-tip="s$b$取消编辑并删除草稿"><i class="zg-icon zg-icon-bin"></i><span class="hide-text">清除草稿</span></a><span class="draft-saved-time"></span></span></div>')[0],this.nq=L("a",{"class":"zm-command-cancel",name:"cancel",href:"#"},"取消"),this.Jk=L("a",{"class":"zg-r3px zg-btn-blue",name:"save",href:"#"},"发布")]);this.Ab.appendChild(this.Bc)};
t.Uv=function(){var b=this;$.get("/draft/get",{qid:this.Bo},function(c){c.r||b.kt(c.msg)})};t.lD=function(){var b=[];if(!this.disabled){var c="修改";ch.de&&ch.de[0]&&(c="修改（有未发布的编辑草稿）");b.push('<a href="javascript:;" class="zu-edit-button" name="edit"><i class="zu-edit-button-icon"></i><span>'+c+"</span></a>")}return b.join("")};a.FB=function(){this.Wu=[]};y(FB,Fu);ia(FB);FB.prototype.v=function(b){var c=FB.n.v.call(this,b);E.add(c,"goog-submenu");GB(this,b,c);return c};FB.prototype.o=function(b,c){c=FB.n.o.call(this,b,c);E.add(c,"goog-submenu");GB(this,b,c);var d=Ub("div","goog-menu",c);if(d.length){var e=new Nu(b.K()),d=d[0];R(d,m);b.K().Ba().body.appendChild(d);e.o(d);b.Tg(e,j)}return c};
FB.prototype.Ea=function(b,c){var d=this.X(b),e=d&&d.lastChild;FB.n.Ea.call(this,b,c);e&&(d.lastChild!=e&&E.has(e,"goog-submenu-arrow"))&&d.appendChild(e)};FB.prototype.te=function(b){FB.n.te.call(this,b);var c=b.X(),d=b.K(),d=Tb(d.Ga,"span","goog-submenu-arrow",c)[0];HB(b,d);d!=c.lastChild&&c.appendChild(d);Nc(b.m(),Uc.uk,"true")};
a.GB=function(b,c,d){var e=c.K().v("span");e.className="goog-submenu-arrow";HB(c,e);b.X(d).appendChild(e)},a.HB=function(b,c){b.ud()?(E.add(c,"goog-submenu-arrow-rtl"),xc(c,b.Rp?"◄":"►")):(E.remove(c,"goog-submenu-arrow-rtl"),xc(c,b.Rp?"►":"◄"))};a.IB=function(b,c,d,e){Ku.call(this,b,c,d,e||FB.O())};y(IB,Ku);a.JB=218;t=IB.prototype;t.Dd=k;t.Az=k;t.YD=m;t.jc=k;t.Wq=m;t.Rp=j;t.lO=m;t.B=function(){IB.n.B.call(this);this.h().e(this.getParent(),"hide",this.TF);this.jc&&KB(this,this.jc,j)};t.hb=function(){this.h().Da(this.getParent(),"hide",this.TF);this.jc&&(KB(this,this.jc,m),this.Wq||(this.jc.hb(),M(this.jc.m())));IB.n.hb.call(this)};t.w=function(){this.jc&&!this.Wq&&this.jc.G();this.jc=k;IB.n.w.call(this)};
t.ld=function(b,c){IB.n.ld.call(this,b);c&&(this.Va().Pf=j);b||(this.Dd&&Hd.clearTimeout(this.Dd),this.Dd=Kd(this.sg,JB,this))};t.ut=function(){var b=this.getParent();b&&Kt(b)==this&&(LB(this,j),MB(this),this.uX=m)};t.sg=function(){var b=this.jc;b&&b.getParent()==this&&(LB(this,m),Oh(b,function(b){"function"==typeof b.sg&&b.sg()}))};a.NB=function(b){b.Dd&&Hd.clearTimeout(b.Dd);b.Az&&Hd.clearTimeout(b.Az)};t.D=function(b,c){var d=IB.n.D.call(this,b,c);d&&!this.R()&&this.sg();return d};
a.MB=function(b){Oh(b.getParent(),function(b){b!=this&&"function"==typeof b.sg&&(b.sg(),NB(b))},b)};t.Ub=function(b){var c=b.keyCode,d=this.ud()?37:39,e=this.ud()?39:37;if(this.YD){if(!this.Va().Ub(b))if(c==e)this.sg();else return m}else if(this.isEnabled()&&(c==d||c==this.Zx))this.ut(),Lt(this.Va()),NB(this);else return m;b.preventDefault();return j};t.tP=function(){this.jc.getParent()==this&&(NB(this),this.Ol.ld(this),MB(this))};t.TF=function(b){b.target==this.Ol&&(this.sg(),NB(this))};
t.fd=function(b){this.isEnabled()&&(NB(this),this.Az=Kd(this.ut,JB,this));IB.n.fd.call(this,b)};t.Rd=function(b){NB(this);if(this.Mb&8)return IB.n.Rd.call(this,b);this.ut();return j};
a.LB=function(b,c){b.dispatchEvent(Kh(64,c));var d=b.Va();if(c!=d.R()&&(c&&(d.ya||d.W(),d.Lb(-1)),b.YD=c,E.enable(b.m(),"goog-submenu-open",c),d.D(c),c)){var d=new Qt(b.m(),b.Rp?6:4,b.lO),e=b.Va(),g=e.m();e.R()||(g.style.visibility="hidden",R(g,j));d.ha(g,b.Rp?4:6);e.R()||(R(g,m),g.style.visibility="visible")}},a.KB=function(b,c,d){var e=b.h();(d?e.e:e.Da).call(e,c,"highlight",b.tP)};t.Fa=function(b){this.Va().H(b,j)};t.zi=function(b,c){this.Va().xk(b,c,j)};
t.removeItem=function(b){(b=this.Va().removeChild(b,j))&&b.G()};t.Eh=function(b){return Qh(this.Va(),b)};t.ll=function(){return Ph(this.Va())};t.Hb=function(){return this.Va().Hb()};t.Va=function(){this.jc?this.Wq&&this.jc.getParent()!=this&&Nh(this.jc,this):this.Tg(new Nu(this.K()),j);this.jc.m()||this.jc.v();return this.jc};t.Tg=function(b,c){var d=this.jc;b!=d&&(d&&(this.sg(),this.ya&&KB(this,d,m)),this.jc=b,this.Wq=!c,b&&(Nh(b,this),b.D(m,j),b.Bm=m,b.Fe(m),this.ya&&KB(this,b,j)))};t.xf=function(b){return this.Va().xf(b)};
gp("goog-submenu",function(){return new IB(k)});a.OB=function(b,c,d,e){IB.call(this,b,c,d,e)};y(OB,IB);OB.prototype.Ub=function(b){var c=OB.n.Ub.call(this,b),b=parseInt(ik[b.keyCode],10);isNaN(b)||this.Va().Lb(b-1);return c};a.ax=function(b,c,d){T.call(this);this.ia=b;this.na=d;this.OK=c||fh;this.dv=k};y(ax,T);a.PB={all_can_comment:"允许任何人评论",followee_can_comment:"允许我关注的人评论",nobody_can_comment:"关闭评论"};t=ax.prototype;t.Ux=function(){jv("answer",this.lb,"read")};t.Bj=function(){jv("answer",this.lb,/^\/question\//.test(location.pathname)?"read":"touch")};
t.B=function(){function b(){c();var b=q.Pp.Eh(0);b.Va&&b.Va()&&(b.ut(),b.Va().Lb(0))}function c(){QB(q);q.Pp.Lb(0)}ax.n.B.call(this);var d=K("zm-item-answer",this.g)||this.g;this.na=d.getAttribute("data-aid");this.Be="1"===d.getAttribute("data-isowner");this.lb=d.getAttribute("data-atoken");this.Fg="1"===d.getAttribute("data-deleted");this.jv=+d.getAttribute("data-created");this.uN=+d.getAttribute("data-helpful");this.jO="1"===d.getAttribute("data-good");this.rj="1"===d.getAttribute("data-collapsed");
this.ib=k;this.vf=K("zm-item-answer-author-info",this.g);d=m;!S.ua()&&0<$(this.g).parents('div[data-fixed-summary="1"]').length&&(d=j);var e={};e.cr=!!d;d=this.Bt=new wu(e);this.H(d);d.o(this.g);d.cd()&&oe(this.h(),d,"expand",this.Ux);vu(this.g,this.Bj,this);this.Rc=this.Rc||K("zm-item-meta",this.g);(this.Oh=K("zm-meta-panel",this.Rc))&&this.h().e(this.Oh,"click",this.Kl);if(this.Be){d=$('[name="comment_opt"]',this.Rc);if(d.length){var e=d.data(),g=new Nu,h=new XA("禁止转载");h.Uc(!e.copyable);g.Fa(h);
g.Fa(new Mu);this.ev=[];H.forEach(PB,function(b,c){var d=new XA(b);d.za(c);d.Uc(c===this.dv);this.ev.push(d);g.Fa(d)},this);g.Fa(new Mu);g.Fa(new Ku("删除"));this.h().e(g,"action",this.gM);RB(this,g);E.add(g.m(),"zg-gray-normal");e=new pz("comment",g);e.Xl=j;sz(e);rz(e);e.nc=nf;e.o(d[0]);this.xW=g}this.vf&&(this.eG=(this.ib=Xa(this.vf.innerHTML,"匿名用户"))?k:this.vf.innerHTML.replace(/src=".+?"/g,'src="'+S[2]+'"'),this.h().e(this.vf,"click",function(b){"cancel-anon"===b.target.name&&ct(m)}))}else this.lx();
if(d=K("zm-item-vote-info",this.g)){this.ik=new Vw(this.na);this.H(this.ik);this.ik.o(d);d=$(".zm-item-vote-count",this.g);d[0]||(d=$(".zm-item-vote-count",this.Rc));var l=[d[0],$(".zm-votebar .count",this.g)[0]];if(l.length){var n=this.ik;this.ik.on("change",function(){z.forEach(l,function(b){yk(b,n.Ra())})})}}this.Hn();$(this.g).on("contentchange",$.proxy(this.Hn,this));this.gx();this.fb();d=new DB(this.g);d=wk.gI(d.getItem()||this.g);vk(vk(vk(vk(vk(vk(vk(d.register("v",function(){this.rb&&this.rb.Lt()},
this),{group:"操作",name:"赞同"}).register("d",function(){this.rb&&this.rb.Kt()},this),{group:"操作",name:"反对"}).register("f x",this.rc,this),{group:"操作",name:"分享"}).register("s c",this.rl,this),{group:"操作",name:"收藏"}).register("t",this.vr,this),{group:"操作",name:"感谢"}).register("c",this.Cw,this),{group:"操作",name:"打开评论"}).register("shift+c",this.kr,this),{group:"操作",name:"定位到评论框"});var e=kb?"⌘":"ctrl",q=this;dh.wE&&$("a[name=admin]",this.Oh)[0]&&vk(vk(d.register("meta+.",c),{group:"管理",name:"展开菜单",key:e+
"+."}).register("meta+k",b),{group:"管理",name:"展开折叠子菜单 (Kill)",key:e+"+k"});if(sb&&!Og&&(d=K("more-actions",this.Rc))){var r={share:{label:"分享",action:this.rc},fav:{label:"收藏",action:this.rl},report:{label:"举报",action:this.ur},nohelp:{label:this.uN?"没有帮助":"撤销没有帮助",action:this.ED}},w=new Nu,e=function(b){Ph(w)&&w.Fa(new Mu);var c=new Ku(r[b].label);c.za(b);w.Fa(c)};e("share");e("fav");this.Be||(e("nohelp"),S.ua()&&e("report"));e=new pz("operation",w);e.Xl=j;sz(e);rz(e);e.Ll=ba();e.nc=nf;e.o(d);E.add(w.m(),
"zh-answer-more-actions");this.h().e(w,"action",function(b){var c=r[b.target.V()];c&&c.action&&c.action.call(this,b)})}};t.tz=function(b){var c=this.Hn();c&&zr(c,b)};
t.lx=function(){var b=K("zm-votebar",this.g)||K("zm-votebar",this.Oh);if(b){var c=new Xu(this.na);c.o(b);this.rb=c;this.h().e(c,"change",this.nR).e(c,"action",function(b){b.data.state===Yu.ae?Y.Z({type:"ga_click_vote_up",target:this}):b.data.state===Yu.jg&&Y.Z({type:"ga_click_vote_down",target:this})});(b=K("votenum-mobile",this.Oh))&&(new Tw(c)).o(b)}};
t.Hn=function(){if(this.wp)return this.wp;var b=K("zm-editable-content",this.g),c=this.rb&&this.rb.m();!this.Be&&(!sb&&S.ua())&&(c&&$(c).is(":visible")&&b&&230<$(b).height())&&(b=this.wp=new Cr(k,b),this.H(b),b.Zg="votebar",b.Ey=50,b.o(c))};t.nR=function(){this.ik&&this.ik.Yh()};
a.SB=function(b){if(!b.ee&&b.Be&&fh&&b.na){b.ee=new EB(m,"/answer/content","content");Rc(b,b.ee);b.ee.Pt=j;b.ee.Ev=j;b.ee.nD=lB.prototype.nD;var c=K("zm-item-rich-text",b.g);b.ee.params=["id="+b.ia];b.ee.o(c);b.h().e(b.ee,"shouldUpdateContent",function(b){if(ma(b.data))return m});b.h().e(b.g,"click",function(b){"suggest_edit"===b.target.name&&(this.ee.mf(),$(".zh-question-censor-tip",this.g).hide());return j})}};
t.fb=function(){this.vf&&this.h().e(this.vf,"click",this.ra);this.Be&&(this.HJ=S);this.h().e(Li,"anon_change",function(b){this.Be?this.jt(b.ib):this.rb.Md()===Yu.ae&&this.ik.Yh()});SB(this);$(this.g).on("focusin focusout",function(b){$(this).toggleClass("focusin","focusin"===b.type)})};t.Xe=function(b){return Jk(this.g,b)};
t.ra=function(b){if(b=(b=this.Xe(b.target))&&b.name)if("edit"===b){b=dB();if(!this.Hu){var c=fh.lb;b.Kx=j;b.EG=c;this.h().e(b,"change",this.ly)}this.Hu=j;eB(b)}else"complex"===b&&(b=K("zm-item-answer-summary",this.g),c=K("zm-item-rich-text",this.g),R(b,m),R(c,j))};t.ly=function(){var b=dB().hw()||S[4]||"";if(b){var c=K("zu-question-my-bio",this.vf);c.title=b;c.innerHTML=b}};t.gx=function(){var b=K("zm-item-answer-author-wrap",this.g),b=K("zm-list-avatar",b);dk.add(b)};
t.jt=function(b){b?this.vf.innerHTML='<h3 class="zm-item-answer-author-wrap">匿名用户<a class="zg-link-gray cancel-anon" href="javascript:void(0);" name="cancel-anon">取消匿名</a></h3>':this.Be&&(this.eG?this.vf.innerHTML=this.eG.replace("</h3>","").replace("</H3>","")+'<a name="edit" class="zu-edit-button" href="javascript:;"><i class="zu-edit-button-icon"></i>修改话题经验</a></h3>':(b=[],b.push('<h3 class="zm-item-answer-author-wrap">'),b.push(Vt()),b.push(Wt(S,"zm-item-answer-creator")),b.push("</h3>"),this.vf.innerHTML=
b.join("")))};
a.TB=function(b,c){if(!b.oa){b.oa=new Ew(b.na,"answer",c);b.H(b.oa);Iw(b.oa,b.Rc,$(".toggle-comment",b.Rc)[0]);Rw(b.oa);var d=location.hash.slice(1).split("-"),e=location.pathname.split("/"),e="answer"===e[3]&&e[4];"comment"===d[0]&&d[1]&&e===b.lb&&(b.oa.Ja(j),b.h().e(b.oa,"expand",function(){Gw(this.oa)}))}},a.QB=function(b){if(b.Pp)b.Pp.D(j);else{var c;var d=$("a[name=admin]",b.Oh)[0];if(d){b.gJ=d;JB=0;c=new qB;b.H(c);c.attach(d,5);var e=b.rj?new Ku("取消折叠"):new OB("折叠");e.za("collapse");var g=function(b,
c){var d=new Ku(c+1+" "+b.label);d.za(b.value);e.Fa(d)};b.rj||uw("answer","collapse").then(function(b){z.forEach(b,g);E.add(e.Va().m(),"manage-menu")});d=new Ku("删除");d.za("delete");c.Fa(e);c.Fa(d);c.W(b.g);E.add(c.m(),"manage-menu")}else c=i;c&&(rB(c,new Qt(b.gJ,1,j),0,new Pf(5,0,5,0)),b.h().e(c,"action",function(b){var c=b.target,b=c.V(),c=c.m(),d=new jj;"collapse"===b?(d.add("answer_id",this.na).add("action","collapse2").add("collapse",this.rj?"cancel":"done"),c.setAttribute("data-op",this.rj?
"uncollapse-answer":"collapse-answer"),c.setAttribute("data-action","/manage?"+d.toString()),UB(this,c)):"delete"===b?(d.add("answer_id",this.na).add("action","remove_answer2"),c.setAttribute("data-op","remove-answer"),c.setAttribute("data-action","/manage?"+d.toString()),UB(this,c)):pa(b)&&(c=new jj,c.add("answer_id",this.na).add("action","collapse2").add("collapse",this.rj?"cancel":"done").add("reason",b),tw("/manage",c.toString(),v(this.WF,this)))}),RB(b,c),b.Pp=c)}};
t.WF=function(){var b=$(this.g);b.hide("fast",function(){b.remove()});this.G()};a.UB=function(b,c){(new sw).open(c,{id:b.na,type:"answer"},v(b.WF,b))};
t.Kl=function(b){var c=this.Xe(b.target),d=c&&c.name;if(d)switch(d){case "addcomment":this.Cw();this.oa.fc()&&this.oa.mi("view_comments",parseInt(Fc(c),10)||0);break;case "remove":this.or();break;case "thanks":Y.Z({type:"ga_click_thank_answer",target:c});this.vr();break;case "comment_opt":if(!this.dv&&(!this.NB||!this.NB.Wb()))b=new V(j),oe(this.h(),b,"success",function(b){if((b=Ie(b.target))&&!b.r){var c=b.msg;z.forEach(this.ev,function(b){b.V()===c&&b.Uc(j)});this.dv=c}else U(b.msg)}),b.ajax("/answer/comment_permission?answer_id="+
this.na,k,"GET"),this.NB=b;break;case "admin":QB(this);break;case "share":Y.Z({type:"ga_click_share_answer_box",target:c});this.rc();break;case "nohelp":this.ED(b);break;case "report":this.ur();break;case "favo":Y.Z({type:"ga_click_collect_answer_box",target:c}),this.rl()}};t.ur=function(){Au("answer",this.na)};
t.ED=sn(function(b){var b=b.target,c=!!b.m;Y.Z({type:"ga_click_answer_not_helpful",target:c?b.m():b});this.wv&&"pending"===this.wv.state()&&this.wv.abort();var d,e;e=c?b.wg():b.innerHTML;e=(d=-1<e.indexOf("撤销"))?"没有帮助":"撤销没有帮助";c?b.fm(e):b.innerHTML=e;d=d?"/answer/helpful":"/answer/not_helpful";c||Fk(b);this.wv=$.post(d,{aid:this.na})},{ua:"question_answer_not_helpful",lg:j});t.rc=sn(function(){new fv(["分享回答","answer",this.lb,{aid:this.na}],"tb-webshare-sina")},{ua:"question_answer_share"});
t.rl=sn(function(){var b=fx.O();kx(b,this.na);b.show()},{ua:"question_answer_collect",lg:j});t.BK=function(){this.oa||TB(this);this.oa.sf();$(this.Oh).toggleClass("focusin",this.oa.fc())};t.Cw=sn(ax.prototype.BK,function(){return{ua:"添加评论"===$.trim($(K("toggle-comment",this.g)).text())?"question_answer_add_comment_start":m}});t.kr=sn(function(b){this.oa&&this.oa.fc()?this.oa.field.focus():this.Cw();b.preventDefault()},{ua:"question_answer_add_comment_start"});
t.vr=sn(function(){var b=$("a[name=thanks]",this.Oh)[0];b&&!E.has(b,"disabled")&&(yk(b,"已感谢"),E.add(b,"disabled"),Fk(b),$.post("/answer/thanks",{aid:this.na}))},{ua:"question_answer_thank"});a.RB=function(b,c){b.h().e(c,"show",function(){E.add(this.Rc,"zm-item-meta-has-menu")}).e(c,"hide",function(b){b.currentTarget===b.target&&E.remove(this.Rc,"zm-item-meta-has-menu")})};
t.gM=function(b){var c=b.target,b=c.V();"禁止转载"===b?(b=!c.ve(),$.post("/node/AnswerMetaV2",{method:"set_copyright",params:{answer_id:this.na,is_copyable:Number(b)}}),$(".copyright",this.Rc).html(b?"":'<span class="zg-bull">&bull;</span> 禁止转载')):"删除"===b?this.or():b in PB&&$.post("/answer/comment_permission",{answer_id:this.na,permission:b}).done(v(function(b){b&&!b.r&&z.forEach(this.ev,function(b){b.Uc(b===c)})},this))};
t.or=function(){Ci("你确定要删除自己的答案吗？","答案内容不会被永久删除，你还可以撤消本次删除操作。",function(b){b&&(this.Fg=j,this.status=-1,VB(this))},this)};a.VB=function(b){var c=new V(j);oe(b.h(),c,"success",function(){R(this.g,!this.Fg);this.Fg?this.iu="set_delete":(SB(this),this.iu="cancel_delete");this.dispatchEvent("change");$(this.g).parent(".zm-item").hide()});c.ajax("/answer/"+(b.Fg?"remove":"unremove"),"aid="+b.na)};t.m=p("g");a.WB=function(b,c,d){ax.call(this,b,c,d)};y(WB,ax);WB.prototype.o=function(b){WB.n.o.call(this,b);this.Be&&this.jt(this.OK.ib)};WB.prototype.R=function(){return $(this.g).is(":visible")};a.XB=function(){T.call(this);this.data=fh||{};this.ia=this.data.ia;this.Qn=m;this.Ai={};this.Cu=[];this.Vp=[];this.Qh=0;this.Qf=gh&&gh.url_token?gh:k};y(XB,T);t=XB.prototype;t.z=function(){ys.H(this);this.o(document.body)};
t.B=function(){XB.n.B.call(this);var b=J("zh-question-meta-wrap");b&&(this.wG=new BB(this.data),this.H(this.wG),this.wG.o(b));this.kx();var c=this;$(".js-ignore-invite").click(function(){$(".question-invited-by").hide();$.post("/question/askpeople",{qid:c.data.lb,uid:S.wd,op:"pass"})});this.fo=new my;this.h().e(this.fo,"change",this.Gy);this.fo.z();this.gH();S.Pg&&$.post("/question/popup",{action:"no_answer",question_token:this.data.lb},function(b){if(b){var c=new tB;c.Ma("提问无人问津？");c.Ea(b);c.ha();
$(".js-gonext",c.g).on("click",function(){var b=$(this).parents('[class^="view"]').attr("class");"view-starting"===b?(c.Ma("第一条"),c.Yj("firsttip")):"view-firsttip"===b?(c.Ma("第二条"),c.Yj("secondtip")):"view-secondtip"===b?(c.Ma("第三条"),c.Yj("thirdtip")):"view-thirdtip"===b&&c.D(m)})}})};
t.gH=function(){this.data.lb=fh.lb;YB(this,j);if(S.ua()&&("close"!==fh.status&&(this.Na=new Rp(this.data.eA,this.data.ia),this.Na.qs=5,this.Na.ts=1,this.Na.YA=j,this.Na.ys=j,this.Na.o(K("zm-tag-editor",this.g)),this.h().e(this.Na,["remove_tag","add_tag"],function(){Y.Z("ga_edit_question_topic_changed")}),this.h().e(this.Na,"start_editing",function(){Y.Z("ga_question_topic_edit_finish_changed")}),this.Na.addEventListener("beforeedit",dy({Ul:j}))),"close"!==fh.status)){var b=J("zh-question-title");
if("false"!==b.getAttribute("data-editable")){this.Wc=new oB(this.data.ia,"/question/title","content",m,j);this.Wc.tC=j;this.Wc.Jd=j;this.Wc.Ao=j;var c=Zt(this.data.Pg);this.Wc.Pn=c;this.Wc.o(b);this.h().e(this.Wc,"change",function(){Li.dispatchEvent("question_title_change");document.title=this.Wc.$a()+" - 知乎"});this.h().e(this.Wc,"click_edit",function(){Y.Z("ga_question_title_edit_start")});this.h().e(this.Wc,"cancel_edit",function(){Y.Z("ga_question_title_edit_cancel")});this.h().e(this.Wc,"save_changed",
function(){Y.Z("ga_question_title_edit_save_changed")});this.h().e(this.Wc,"save_unchanged",function(){Y.Z("ga_question_title_edit_save_unchanged")});this.Wc.addEventListener("beforeedit",dy({Ul:j}))}}this.Wp=J("zh-question-answer-num");this.Xp=J("zh-question-answer-wrap");this.oh=J("zh-question-collapsed-link");this.Um=J("zh-question-collapsed-wrap");this.vK=J("zh-question-collapsed-num");this.zJ=J("zh-question-answer-form-wrap");this.dk=J("zh-question-notification-summary");this.om=J("zh-answers-filter");
this.Rs=J("zh-add-question-sug");this.Wp&&(this.data.fe=+this.Wp.getAttribute("data-num"));this.Xp&&(this.data.IQ=+this.Xp.getAttribute("data-pagesize"));this.oh&&this.h().e(this.oh,"click",this.LS);this.Rs&&this.h().e(this.Rs,"click",this.yD);this.om&&Tg&&this.h().e(this.om,"click",function(b){b.stopPropagation();E.add(this.om,"activated");oe(this.h(),document,"click",function(){E.remove(this.om,"activated")})});(this.bv=J("zg-question-suggested-topics"))&&this.h().e(this.bv,"click",this.jP);this.Fn();
this.h().e(window,"hashchange",function(b){b=b.Tb;b.oldURL&&"writing"===b.oldURL.split("#")[1]||ZB(this)});if(b=J("zh-question-answer-wrap")){var d=new xu({la:["expandLimit","nodeSource"],Vg:this.data.fe>this.data.IQ&&!K("question-page-pager")});this.H(d);this.h().e(d,"itemcreated",function(b){d.H($B(this,b.item));$("img.lazy",b.item).lazyload({data_attribute:"actualsrc",threshold:400})});d.o(b)}b=S[4];hh&&hh.length&&(b=hh[0][1]);this.wb=new lB(this.data.ib,S,b);this.H(this.wb);this.wb.o(this.zJ);
ch.de&&ch.de.length?this.wb.Ea(ch.de[0]):!dh.sc&&B&&this.wb.Ea("<p></p>");if(!this.data.wx&&!this.Qh&&(!this.Qf||!this.Qf.url_token))if(this.data.Cm&&this.data.Cm.length&&this.data.Cm[3]!==S.wd)this.wb.Xa(m,"只有 "+Wt(this.data.Cm)+" 能回答此问题");else if("normal"===fh.status||ch.de)S.Pg||this.wb.mf();this.h().e(this.wb,"change",this.kP);this.h().e(this.wb,"cancel_delete_answer",this.sP);this.wb.ready(function(){var b=this.gr();b&&"writing"===location.hash.slice(1)&&b.execCommand("toggleFullScreen")});aC(this);
ZB(this,k);bC(this);this.h().e(Li,"anon_change",function(b){this.data.ib=b.ib});eh&&setTimeout(function(){location.href=eh},5E3)};t.kx=function(){jv("question",this.data.lb,"read");this.h().e(this,["click!","show!"],function(b){"comment"===b.namespace&&b.xc.fill("category","question_answer").fill("label","question_answer");"invitation"===b.namespace&&b.xc.fill("label","question_page")})};
t.Gy=function(){this.rN=j;this.dk=$(this.fo.dP)[0];kc(this.dk,J("zh-question-redirect-info"));R(this.dk,j);dh.sc||(this.Xi=new ur,this.Xi.o(this.dk),Ws(this.Xi));this.h().e(this.dk,"click",this.yD);ZB(this)};a.YB=function(b,c){!S.ua()||!c?(cC(b,"zh-question-detail",ha),cC(b,"zh-question-answer-summary",ha)):(cC(b,"zh-question-detail",b.LN),cC(b,"zh-question-answer-summary",b.NN))},a.cC=function(b,c,d){if(c=J(c)){var e=new wu;b.h().e(e,"expand",d).e(e,"invalid",d);e.o(c)}};
t.LN=function(b){if("close"!==fh.status){b=b.target.m();this.xb=new oB(this.data.ia,"/question/detail","content",j,k,600);var c=Zt(this.data.Pg);this.xb.Pn=c;this.xb.tW=Lk;K("zm-editable-content",b).innerHTML&&(this.xb.Ao=j);this.xb.o(b);this.h().e(this.xb,"click_edit",function(){Y.Z("ga_question_supplement_edit_start")});this.h().e(this.xb,"cancel_edit",function(){Y.Z("ga_question_supplement_edit_cancel")});this.h().e(this.xb,"save_changed",function(){Y.Z("ga_question_supplement_edit_save_changed")});
this.h().e(this.xb,"save_unchanged",function(){Y.Z("ga_question_supplement_edit_save_unchanged")});this.xb.addEventListener("beforeedit",dy({Ul:j}))}};
t.NN=function(b){var b=b.target.m(),c=J("zh-question-answer-summary-link"),d;if(b&&(dh.wE||!this.data.IS))d=new Sr(j,"/question/summary","content"),d.params=["id="+this.data.ia],d.mq=m,d.o(b);if(c){var e=J("zh-question-answer-summary-wrap");this.h().e(c,"click",function(){d&&(R(e,j),d.mf())}).e(e,"click",function(b){"cancel"===b.target.name&&(b=!d.If(),R(e,!b))})}this.HS=d;this.HS.addEventListener("beforeedit",dy({Ul:j}))};
t.yD=function(b){if("close"===b.target.name){if(this.Xi&&(Ar(this.Xi),zr(this.Xi,m),history.replaceState)){var b=new wf(location.href),c=b.dd();c.remove("q");c.remove("psq");history.replaceState({},"",b.Uf+"?"+c.toString())}R(this.dk,m);R(this.Rs,m)}else if("A"===b.target.tagName&&"zh-question-suggest-reask"===b.target.id&&(R(this.Rs,m),Y.fireEvent("query_string_change")),c="a"===$(b.target).prop("tagName").toLowerCase()?b.target:this.Xe(b.target,"A"))b.preventDefault(),b.stopPropagation(),b=c.getAttribute("data-source")||
c.href,c=b.indexOf("#"),b=0>c?k:b.substr(c+1),ZB(this,b&&decodeURIComponent(b))};
a.bC=function(b){b.data.uq=+b.vK.innerHTML;S.ua()||(b.data.uq=0);R(b.oh,0<b.data.uq);b.Wp&&xc(b.Wp,b.data.fe?b.data.fe+" 个回答":"还没有回答");b.om&&R(b.om,1<b.data.fe);R(b.oh,0<b.data.uq)},a.$B=function(b,c,d,e){e=new WB(b.ia,k,e);e.o(c);b.Ai[e.na]=e;b.Vp.push(e.na);b.h().e(e,"change",b.ky);e.Be&&(b.Qh=e.na,e.HJ=S,b.h().e(e.ee,"change",b.QM),b.mg=e);e.rj?e.Be&&b.Um.appendChild(e.m()):b.Cu.push({added_time:e.jv,vote:d,aid:e.na});e.Fg&&R(e.m(),m);return e};
t.QM=function(){var b=this.mg,c=b.m(),d=b.ee.$a()[0];R(c,m);d=fc(Ma(d));jc(d,c);this.Ai[b.na]=k;this.Vp=z.filter(this.Vp,function(c){return c!==b.na},this);var e=999;this.Cu=z.filter(this.Cu,function(c){c.aid===b.na&&(e=c.vote);return c.aid!==b.na},this);M(c);b.G();$B(this,d,e,m)};
t.ky=function(b){b=b.target;if(b instanceof WB){var c=b.m();switch(b.iu){case "collap":this.Um.appendChild(c);E.add(c,"zm-item-collapsed");this.data.fe--;bC(this);break;case "cancel_collap":this.Xp.appendChild(c);E.remove(c,"zm-item-collapsed");dC(this,c);this.data.fe++;bC(this);break;case "set_delete":aC(this);this.data.fe--;bC(this);break;case "cancel_delete":dC(this,this.Ai[this.Qh].m()),aC(this),this.data.fe++,bC(this)}}};
a.aC=function(b){var c=k,d=k,e,g={suggest:"建议修改",evaluate:"建议修改",close:"关闭"};!ch.de&&"normal"!==fh.status&&(d="被"+g[fh.status]+'的问题不允许添加新的回答。<a data-tip="s$b$为什么部分问题会被「关闭」「建议修改」？" href="//www.zhihu.com/question/21290061 "><i class="zg-icon zg-icon-question-mark"></i></a>');b.Qh?(e=b.Ai[b.Qh],c="#answer-"+e.na,e=e.Fg):b.Qf&&(c="/question/"+fh.lb+"/answer/"+b.Qf.url_token,e=b.Qf.is_delete);c&&(d=e?'你已经删除了对该问题的回答，如果需要修改，请先 <a href="javascript:;" name="cancel_delete">撤消删除</a>':'一个问题你只能回答一次，但你可以对 <a href="'+
c+'">现有的回答</a> 进行修改');S.Pg&&(!b.Qh&&!b.Qf)&&(d='添加回答：<a href="javascript:;" name="answer_my_question">回答自己的提问</a>');b.data.wx&&(d='该问题目前已经被锁定，无法添加新答案。<a href="http://www.zhihu.com/question/19604313" target="_blank">问题为什么会被锁定？</a>');d&&b.wb.Xa(m,d)};t.fD=function(b){return this.Ai[b]};a.eC=function(b,c){var d=J("zh-question-collapsed-switcher");c?(d.name="collap",b.OB=j,R(b.Um,j),E.add(b.oh,"zu-question-collap-title-active")):(b.OB=m,d.name="expand",R(b.Um,m),E.remove(b.oh,"zu-question-collap-title-active"))};
t.LS=function(b){if((b=Jk(this.oh,b.target))&&b.name)if("expand"===b.name){if(!this.xK){this.xK=j;var c=this,d=this.Um,b=$.get("/node/QuestionCollapsedAnswerListV2",{params:{question_id:this.data.ia}});b.done(function(b){b=fc(b);eC(c,j);E.remove(d,"zm-question-collapsed-list-loading");d.appendChild(b);z.forEach(oc(d),function(b){b!==e&&$B(c,b,99999)});$("img.lazy",d).lazyload({data_attribute:"actualsrc",threshold:400})});var e=oc(d)[0];e&&(R(e,m),b.done(function(){R(e,j)}));R(d,j);E.add(d,"zm-question-collapsed-list-loading")}eC(this,
j)}else eC(this,m)};t.sP=function(){var b=this.Ai[this.Qh],c;b?(b.Fg=m,b.status=0,VB(b),dC(this,b.m())):(c=this.Qf,b=new V(j),oe(this.h(),b,"success",function(){window.location.href="/question/"+fh.lb+"/answer/"+c.url_token}),b.ajax("/answer/unremove","aid="+c.id))};
t.kP=function(){var b=this.wb.Tp.checked,c={rF:j,title:"确认放弃匿名身份？",content:"你在该问题下的赞同和关注行为将以实名显示。"},d=v(function(){if(!this.xhr||!this.xhr.Wb()){var c=this.wb.If();if(c){var d=new V(j),h=new jj,l=b?1:0;h.add("id",this.ia).add("content",c).add("anon",l);d.on("success",function(){fh.ib!==l&&Li.dispatchEvent(new Ts(l));var b=Ie(this.xhr);b&&!b.r?(b=fc(Ma(b.msg[0])),this.Xp.appendChild(b),$B(this,b,this.Vp.length,j),aC(this),fh.ib||(this.$O=new WA(this.Ai[this.Qh]),this.$O.show()),S.vL&&$("#answer-my-question-tip").insertAfter($("#zh-question-answer-form-wrap")).show(),
this.data.fe++,bC(this)):U(b.msg)},m,this);d.ajax("/answer/add",h.toString());this.xhr=d}}},this);fh.ib&&!b?Ci(c,function(b){b&&d()}):d()};t.Xe=ba();t.jP=function(b){if((b=this.Xe(b.target))&&b.name){var c=b.name;"close"===c?R(this.bv,m):"addtag"===c&&(this.Na.Je(b.id.split("-")[1],b.innerHTML),R(b,m))}};t.Fn=function(){this.Dz=new YA(this.ia);this.Dz.z()};
a.ZB=function(b,c){if(c=c||location.hash.slice(1)){var d=c.split("-"),e=d[1];"answer"===d[0]&&(d=b.fD(e))&&(d.rj&&!b.OB?dC(b,b.oh):dC(b,d.m()))}},a.dC=function(b,c){if(c){var d=yg(document.body).top,e=b.rN?pg(b.dk).height:0,d={paddingTop:d+e};"number"===$.type(d)&&(d={offsetTop:d});d.aI=ut;tt(c,d);Fk(c);b.Xi&&b.Xi.pp()}};a.fC=function(){XB.call(this);this.data=fh;this.ia=this.data.ia};y(fC,XB);t=fC.prototype;
t.gH=function(){(this.Lq=J("zh-single-answer-disable-wrap"))&&this.h().e(this.Lq,"click",this.IR);this.zl();this.Fn();var b=$("#zh-question-answer-collestions");b.length&&$("a[name=focus]",b).click(function(){un(this,"favlist")});YB(this,m);if(b=$("#zh-question-answer-collections > .zh-general-list").get(0)){var c=new xu({la:["autoload","nodeSource"]});this.H(c);c.o(b)}if(b=$(".awesome-answer-list").get(0)){var d=new xu({la:["expandLimit"],Vg:m});this.H(d);this.h().e(d,"itemcreated",function(b){var c=
new Yw;c.o(b.item);d.H(c)});d.o(b)}};t.kx=function(){this.h().e(this,["click!","show!"],function(b){"invitation"===b.namespace&&b.xc.fill("label","answer_page")});fC.n.kx.call(this)};t.IR=function(b){b.target&&b.target.name&&(b=this.Qb,b.Fg=m,b.status=0,VB(b))};
t.zl=function(){var b=K("zm-item-answer",J("zh-question-answer-wrap"));if(b){this.Qb=new WB(this.ia);this.H(this.Qb);this.Qb.o(b);b=this.h();b.e(this.Qb,"change",this.ky);if(this.Qb.Be){b.e(Li,"anon_change",function(b){var c=b.ib,b=$("#js-sidebar-author-info");if(!$("a[name=focus]",b).length){var g={"0":"fullname",1:"url_token",2:"avatar_path",3:"hash",4:"headline"},h=z.reduce(S,function(b,c,d){b[g[d]]=c;return b},{}),c=Qk(this.IJ,{author:!c&&h});b.html(c)}});var c=this.Qb.ee;c&&b.e(c,"change",function(){var b=
Ma(c.$a()[0]),b=fc(b);mc(b,this.Qb.g);this.zl(b)})}gC(this);TB(this.Qb,{autofocus:m,WE:j})}};t.fD=function(b){if(this.Qb.na===b)return this.Qb};t.IJ='<h3>关于作者</h3><% if (author) { %>    <a class="zm-list-avatar-link" href="/people/<%= author.url_token %>" tabindex="-1">        <img class="zm-list-avatar-medium" src="<%= author.avatar_path.replace("_s.","_m.") %>"/>    </a>    <div class="zm-list-content-medium">        <h2 class="zm-list-content-title">            <a href="/people/<%= author.url_token %>"><%= author.fullname %></a>        </h2>        <div class="zg-gray-normal"><%= author.headline || "" %></div>    </div><% } else { %>    <a class="zm-list-avatar-link" href="javascript:;">        <img class="zm-list-avatar-medium" src="http://img.zhihu.dev:4080/66/6b/666b0abfc_m.jpg"/>    </a>    <div class="zm-list-content-medium">        <h2 class="zm-list-content-title">匿名用户</h2>    </div><% } %>';
t.Fn=function(){this.Dz=new YA(this.ia,this.Qb);this.Dz.z();var b=J("js-sidebar-author-info");b&&(new ay(b)).z()};t.ky=function(b){b=b.target;if(b instanceof WB)switch(b.iu){case "collap":E.add(b.m(),"zm-item-collapsed");break;case "cancel_collap":E.remove(b.m(),"zm-item-collapsed");break;case "set_delete":case "cancel_delete":gC(this),location.reload()}};
a.gC=function(b){b.Qb?b.Qb.Fg?(b.Lq.innerHTML=b.Qb.Be?'你已经删除了对该问题的回答，如果需要修改，请先 <a href="javascript:;" name="cancel_delete">撤消删除</a>':"此答案已经被作者删除",R(b.Qb.m(),m)):R(b.Qb.m(),j):b.Lq.innerHTML="此答案已经被作者删除"};a.hC=function(){T.call(this);this.page=1};y(hC,T);hC.prototype.z=function(){var b=K("js-topic-feed-page");this.o(b)};
hC.prototype.B=function(){hC.n.B.call(this);var b=this;this.xA=$(".js-topic-feed-container",this.g);this.xA.find(".js-topic-item").each(function(){var c=new iC;b.H(c);c.o(this)});this.Js=new jC;this.Js.o($(".js-pinned-topics",this.element)[0]);(this.Xb=J("js-load-more"))&&this.h().e(this.Xb,"click",this.ty);$(".instruction .close-normal").click(function(){var b=new V(m);b.ajax("/notifeature?feature=6",k,"GET");wd(b,"success",function(){$(".instruction").fadeOut()})});this.h().e(this.Js,"change",function(b){$("#tf-"+
b.CH).find(".js-pin").replaceWith('<a href="javascript:;" data-action="pin-topic" class="zg-gray pin topic-hover-content" style=""><i class="z-icon-pin"></i>固定话题</a>')})};a.kC=function(b,c){xc(b,c?"加载中...":"更多")};hC.prototype.ty=function(){kC(this.Xb,j);this.xhr=new V(j);oe(this.h(),this.xhr,"complete",v(this.ef,this));var b=new Kk;b.add("page",++this.page);this.xhr.ajax(location.pathname,b.dd())};
hC.prototype.ef=function(){var b=this,c=Ie(this.xhr);c&&!c.r&&(0<c.msg.length?($(c.msg).each(function(c,e){var g=new iC;b.H(g);g.o($(e)[0]);b.xA.append(g.m())}),kC(this.Xb,m)):$(this.Xb).hide())};a.iC=function(){T.call(this)};y(iC,T);iC.prototype.B=function(){iC.n.B.call(this);this.h().e(this.g,"click",v(this.iy,this))};
iC.prototype.iy=function(b){var c=b.target,b=$(c).attr("data-action"),d=$(this.g).find(".topic-avatar img"),e=d.clone(),g,h=$(this.g).data("id");if("pin-topic"===b)g=this.getParent().Js,$.post("/pin-topic/add",{tid:h},$.proxy(function(b){!b.r&&b.msg?($(this.g).append($(this.yR({topic:b.msg})).hide().fadeIn()),lC(this)):U(b.msg,2E3)},g)).done(function(b){if(!b.r&&b.msg){Fk(c);$(c).replaceWith('<a href="javascript:;" data-action="unpin-topic" class="zg-gray unpin topic-hover-content" style=""><i class="z-icon-unpin"></i>取消固定</a>');
var b=d.offset(),h=$(g.g).offset();1E3<b.top-h.top?(h=$(".top-nav-topic-selector.current a").offset(),h={top:h.top+20,left:h.left+15,width:"25px",height:"25px",opacity:0.1},e.css({position:"absolute","z-index":"999"}).css("top",b.top).css("left",b.left).appendTo("body").animate(h,300,function(){e.remove()})):e.css({position:"absolute","z-index":"999"}).appendTo("body").css("top",b.top).css("left",b.left).animate({top:h.top-63+$(g.g).height(),left:h.left,width:"-=50px",height:"-=50px",opacity:0.5},
300,function(){e.remove()})}});else if("unpin-topic"===b){var l=this.getParent().Js,n=function(){var b=$(c).replaceWith('<a href="javascript:;" data-action="pin-topic" class="zg-gray pin topic-hover-content" style=""><i class="z-icon-pin"></i>固定话题</a>')[0];Fk(b)},q=$(l.g).find("[data-topicid="+h+"]");q.fadeOut(function(){q.remove();l.Ct().done(function(){n&&n()});l.dispatchEvent({type:"change",CH:q.attr("data-topicid")})})}else if("follow"===b||"unfollow"===b)un(c,"topic",k,["follow","unfollow"]),
$(this.g).fadeOut()};a.jC=function(){T.call(this)};y(jC,T);jC.prototype.yR=Qk('<div class="side-topic-item js-pin-item  cursor-move" data-topicid="<%=topic.id%>" >    <a href="/topic/<%=topic.url_token%>" class="pin-topic-avatar-link">        <img src="<%=topic.avatar_path%>" alt="" title="拖动以排序" class="side-topic-avatar js-topic-avatar">    </a>    <div class="side-topic-content ellipsis">        <a href="/topic/<%=topic.url_token%>" class="topic-link side-topic-title"><%=topic.name%></a>        <div class="side-topic-meta">        <% if (topic.children_num > 0) { %>            <span class="zg-gray"><%=topic.children_num%> 个子话题</span>            <span class="bull">&bull;</span>        <% } %>            <span class="zg-gray"><%=topic.followers_num%> 人关注</span>        </div>        <% if (topic.feed_num > 0) { %>            <a class="side-topic-more" href="/topic/<%=topic.url_token%>"><%=topic.feed_num %> 条动态&nbsp;&raquo;</a>        <% }else{ %>            <a class="side-topic-more" href="/topic/<%=topic.url_token%>">进入话题 &raquo;</a>        <% } %>    </div>    <a href="javascript:;" data-action="up" class="up" data-tip="s$b$置顶"></a>    <a href="javascript:;" data-action="remove" class="delete"></a></div>');
jC.prototype.B=function(){jC.n.B.call(this);this.h().e(this.g,"click",v(this.iy,this));lC(this)};a.lC=function(b){b.Bf&&b.Bf.G();var c=new dm;c.Pq="pin-topic-moving";em(c,b.g,0);c.z();b.h().e(c,"dragend",v(b.Ct,b));b.Bf=c;$("a",b.g).each(function(){b.h().e(this,"mousedown",function(b){b.stopPropagation()})})};
jC.prototype.iy=function(b){var c=this,d=b.target,e=$(d).attr("data-action");if(e){var g=$(d).parents(".js-pin-item");if("up"===e){var b=g.position(),h=g.clone();g.before(h).css({position:"absolute","z-index":"999"}).css("top",b.top).animate({top:$(c.g).position().top},200,function(){h.remove();g.css({position:"relative",top:0}).prependTo(c.g);c.Ct()});h.css("opacity",0)}else"remove"===e&&g.fadeOut(function(){g.remove();c.Ct();c.dispatchEvent({type:"change",CH:g.attr("data-topicid")})})}else b.stopPropagation()};
jC.prototype.Ct=function(){var b=[];$(this.g).find("div.js-pin-item").each(function(){b.push($(this).attr("data-topicid"))});return $.post("/pin-topic",{topic_ids:b.join(",")},ba())};a.mC=function(){T.call(this);this.LC="even";this.Ym="current"};y(mC,T);t=mC.prototype;t.z=function(){ys.H(this);this.o(document.body)};
t.B=function(){mC.n.B.call(this);this.Yt=$("ul.zm-topic-cat-main").children();var b=this.nd=$("div.zh-general-list"),c=new xu({la:["autoload","nodeSource"]});this.H(c);c.o(b.get(0));this.h().e(c,"next",this.Qp);this.RE=c;b.on("click","a.follow",function(){un(this,"topic",xa(Fk,this),k,{follow_text:"关注"})});O(window,"hashchange",this.OF,m,this);this.OF()||(b.show(),this.Qp())};
t.Qp=function(){var b=this.nd.show().children();if(!b.length)return this.nd.html('<p class="zg-gray-normal" style="text-align:center;line-height:4;">没有子话题。</p>');b.removeClass("no-border "+this.LC);b.filter(":odd").addClass(this.LC);b=b.last();b.index()%2?b.add(b.prev()).addClass("no-border"):b.addClass("no-border");var b=this.jr(),c=b.params&&b.params.topic_id,b=this.Yt.filter(function(){return $(this).attr("data-id")===String(c)});b.length&&b.addClass(this.Ym).siblings().removeClass(this.Ym)};
t.jr=function(){return this.nd.data("init")};t.OF=function(){var b;a:{var c=decodeURIComponent(location.hash.slice(1));if(c&&(b=this.Yt.filter(function(){return $(this).text()===c}),b.length&&this.Yt.filter("."+this.Ym).text()!==c)){b.addClass(this.Ym).siblings().removeClass(this.Ym);b={params:{topic_id:b.data("id")}};var d=this.jr();$.extend(j,d,b);this.nd.attr("data-init",JSON.stringify(d));this.nd.empty();this.RE.Hi();this.RE.Ox();b=j;break a}b=i}return b};a.nC=function(){T.call(this)};y(nC,T);nC.prototype.z=function(){ys.H(this);this.o(document.body)};nC.prototype.B=function(){nC.n.B.call(this);oC(this,"zh-global-logs-wrap");oC(this,"zh-global-logs-questions-wrap");oC(this,"zh-question-log-list-wrap")};a.oC=function(b,c){var d=J(c);if(d){var e=new xu;b.H(e);e.la("locationSource",{Hs:j});e.o(d);$(d).on("click",'a[name="revert"]',function(){if(dy({Ul:j})()===m)return m;Lx(this);return m})}};a.pC=function(){T.call(this)};y(pC,T);pC.prototype.z=function(){ys.H(this);this.o(document.body)};pC.prototype.B=function(){pC.n.B.call(this);this.En("zh-question-followers-list-wrap")};pC.prototype.En=function(b){if(b=J(b)){var c=new xu;this.H(c);c.la("locationSource");c.o(b)}};a.qC=function(b,c){var d;if(b&&c){d=d||"text-highlight";var e=RegExp(c,"i");$(b).find("*").andSelf().contents().each(function(){if(3===this.nodeType){var b=this,h=b.parentNode;if(!E.has(h,d))for(var l,n;-1!==(l=b.data.search(e));)l=0<l?b.splitText(l):b,b=l.splitText(c.length),n=document.createElement("em"),n.className=d,n.appendChild(l.cloneNode()),h.replaceChild(n,l)}})}};a.rC=function(){ou.call(this,{la:["autoload","dataPagingSource"]})};y(rC,xu);rC.prototype.jq=function(){return fc('<button class="feeds-loading"><span>更多</span></button>')};rC.prototype.zz=function(b){this.Bd&&(xc(this.Bd.firstChild,b?"努力加载中...":"更多"),E.enable(this.Bd,"loading",b))};a.sC=function(){T.call(this);this.Ng="roundtable";this.Do=sh.roundtable};y(sC,T);sC.prototype.vi=function(){Sw.call(this,"answer");this.Qv="entry-expaneded";this.ss="item-footer";this.vp="votebar"};y(sC.prototype.vi,Sw);t=sC.prototype.vi.prototype;
t.Jm=function(){sC.prototype.vi.n.Jm.call(this,{".js-expand":this.Ja,".js-thank":this.vr});this.lx();var b=$(".phone-actions",this.m());if(b.length){var c=new Nu;c.o($(".menu",b)[0]);c=new pz("operation",c);c.Xl=j;sz(c);rz(c);c.nc=nf;c.o($(".menubutton",b)[0])}var d=new wu({fv:"content",vH:"script.content"});this.H(d);d.o(this.m());this.h().e(this,["expand","collapse"],function(b){b.target===this&&d.Ja("expand"===b.type,j)}).e(d,["expand","collapse"],function(b){this.Ja("expand"===b.type)})};
t.lx=function(){var b,c,d=$("."+this.vp,this.m())[0];d&&(b=this.rb=new Xu(this.tb,this.entryType),this.H(b),Rc(this,b),b.o(d),(d=$(".js-mobi-vote",this.m())[0])&&(new Tw(b)).o(d));if(d=$(".zm-item-vote-info",this.m())[0])c=new Vw(this.tb,this.entryType),this.H(c),Rc(this,c),c.o(d);b&&c&&this.h().e(b,"change",function(){c.Yh()}).e(c,"change",function(){$("[data-bind-votecount]",this.m()).text(c.Ra())})};
t.vr=sn(function(b){if((b=b.target)&&!E.has(b,"thanked"))yk(b,"已感谢"),E.add(b,"thanked"),$.post("/answer/thanks",{aid:this.tb})},{ua:"question_answer_thank"});t.rc=function(){sC.prototype.vi.n.rc.call(this,"分享回答","answer",this.yh,{aid:this.tb})};t.rl=sn(function(){var b=fx.O();kx(b,this.tb);b.show()},{ua:"question_answer_collect",lg:j});
t.ce=function(){sC.prototype.vi.n.ce.call(this);vk(this.Zf.register("v",function(){this.rb&&this.rb.Lt()},this),{group:"操作",name:"赞同"});vk(this.Zf.register("d",function(){this.rb&&this.rb.Kt()},this),{group:"操作",name:"反对"});vk(vk(vk(vk(vk(this.Zf.register("o",this.sf,this),{group:"操作",name:"显示全部/收起"}).register("c",this.gp,this),{group:"操作",name:"打开评论"}).register("f x",this.rc,this),{group:"操作",name:"分享"}).register("s c",this.rl,this),{group:"操作",name:"收藏"}).register("shift+c",this.Hw,this),{group:"操作",
name:"定位到评论框"})};sC.prototype.OA=function(){Sw.call(this,"question");this.ss="item-footer"};y(sC.prototype.OA,Sw);sC.prototype.z=function(){ys.H(this);this.o(document.body);this.Gn();this.Qr();tC();var b=$(".rt-comment-box")[0];if(b){var c=new Ew(this.Do.id,"roundtable");this.H(c);c.o(b)}};sC.prototype.Gn=function(){this.h().e(this,"click!",function(b){"comment"===b.namespace&&b.xc.fill("label","roundtable").fill("category",this.Ng)})};
sC.prototype.Qr=function(){function b(b){b=b.getAttribute("data-type");return(b={answer:sC.prototype.vi,question:sC.prototype.OA}[b])?new b:new T}var c=this;$("[data-paging]").each(function(){var d=new rC;d.la("childConstructor",{factory:b});this.getAttribute("data-navigable")!==k&&d.la("shortcut",{items:">.item"});c.H(d);d.o(this)})};
a.tC=function(){var b=$(".roundtable-profile");$(".share",b).click(sn(function(){var b=$(this).data();new fv(["分享活动","roundtable",b.token,{roundtable_id:b.id}],"tb-webshare-sina");Y.Z({type:"ga_click_share_roundtable_box",target:this,data:{type:"sina"}})}));$(".follow",b).click(sn(function(){var c=this;un(c,"roundtable",function(d){$(".label",c).text(d?"取消关注":"关注");var e=$(".followers .count",b),d=Number(e.data("count"))+(d?1:-1);e.length&&(d=Math.max(d,0),e.text(d).data("count",d))},["button-success",
"button-cancel"])}))};a.uC=function(){T.call(this);this.jz=sh.searchKeyword};y(uC,T);
uC.prototype.z=function(){function b(b,d){var g=$(b);$.each(d(),function(b,d){g.on("click",b,function(b){e.apply(k,c(d,b))})})}function c(b,c){return g(b,function(b){return qa(b)?b(c):b})}ys.H(this);this.o(document.body);this.Qr();var d=encodeURIComponent(this.jz);$("ul.list[data-paging]").on("click",".item a[href!=#]",function(b){b=b.currentTarget;b.host&&(b=$(b).closest(".item").index()+1,Of.set("s-q",d),Of.set("s-i",b),Of.set("sid",Xk()))});var e=xa(X,"search"),g=z.map;b(".related-topics",function(){return{"a.avatar-link":["visit_topic",
"search_result_card_topic_avatar"],"a.name-link":["visit_topic","search_result_card_topic"],"a[href$=questions]":["visit_topic_questions","search_result_card_topic"],"a[href$=top-answers]":["visit_topic_topanswers","search_result_card_topic"],"a[href$=followers]":["visit_topic_followers","search_result_card_topic"],"button.zg-btn-follow":["click_follow_topic","search_result_card_topic"],"button.zg-btn-unfollow":["click_unfollow_topic","search_result_card_topic"],'a[href^="/search?"]':["click_search_result_more",
"search_result_card_topic"]}});b(".related-users",function(){return{"a.avatar-link":["visit_people_profile","search_result_card_people_avatar"],"a.name-link":["visit_people_profile","search_result_card_people"],"a[href$=answers]":["visit_people_answers","search_result_card_people"],"a[href$=followers]":["visit_people_followers","search_result_card_people"],"a[href$=posts]":["visit_people_posts","search_result_card_people"],"button.zg-btn-follow":["click_follow_people","search_result_card_people"],
"button.zg-btn-unfollow":["click_unfollow_people","search_result_card_people"],'a[href^="/search?"]':["click_search_result_more","search_result_card_people"]}});b(document.body,function(){var b=xa(Ga,"search_result_%s_more_button");return{"ul.list.questions + .zu-button-more":["click_search_result_more",b("all")],"ul.list.users + .zu-button-more":["click_search_result_more",b("user")],"ul.list.topics + .zu-button-more":["click_search_result_more",b("topic")]}});b(".search-tabs",function(){var b=xa(Ga,
"search_result_tab_%s");return{'a[href^="/search?type=question"]':["click_search_result_tab",b("all")],'a[href^="/search?type=people"]':["click_search_result_tab",b("user")],'a[href^="/search?type=topic"]':["click_search_result_tab",b("topic")]}});b(".range-selector",function(){var b=xa(Ga,"search_result_range_%s");return{'a[href*="range=1d"]':["click_search_result_range",b("1d")],'a[href*="range=1w"]':["click_search_result_range",b("1w")],'a[href*="range=3m"]':["click_search_result_range",b("3m")]}});
b("ul.list.questions",function(){function b(){return function(b){return"search_result_all_list_"+($(b.target).closest(".item").index()+1)+""}}return{"a.question-link":["visit_question",b()],".js-expand, .summary":["click_expand",b()],'a[name="collapse"]':["click_collapse_answer",b()],"a.zg-follow":["click_follow_question",b()],"a.zg-unfollow":["click_unfollow_question",b()]}});b("ul.list.users",function(){function b(c){return function(b){return"search_result_user_list_"+($(b.target).closest(".item").index()+
1)+(c||"")}}return{"a.avatar-link":["visit_people_profile",b("_avatar")],"a.name-link":["visit_people_profile",b()],"a[href$=answers]":["visit_people_answers",b()],"a[href$=followers]":["visit_people_followers",b()],"a[href$=posts]":["visit_people_posts",b()],"button.zg-btn-follow":["click_follow_people",b()],"button.zg-btn-unfollow":["click_unfollow_people",b()]}});b("ul.list.topics",function(){function b(c){return function(b){return"search_result_topic_list_"+($(b.target).closest(".item").index()+
1)+(c||"")}}return{"a.avatar-link":["visit_topic",b("_avatar")],"a.name-link":["visit_topic",b()],"a[href$=questions]":["visit_topic_questions",b()],"a[href$=followers]":["visit_topic_followers",b()],"button.zg-btn-follow":["click_follow_topic",b()],"button.zg-btn-unfollow":["click_unfollow_topic",b()]}});this.h().e(this,"click!",function(b){"comment"===b.namespace&&b.xc.fill("category","search").fill("label","search_result_answer")});var h=$("#js-search-question-form");h.length&&h.submit(function(b){b.preventDefault();
b=Vr.O();b.show();Yr(b,$(".title-input",h).val())});qC("[data-highlight]",this.jz)};
uC.prototype.Qr=function(){function b(b){var c=new T;$("li.answer-item",b).each(function(){var b=new sC.prototype.vi;b.ss="actions";b.vp="zm-votebar";c.H(b);b.o(this)});return c}var c=this;$("[data-paging]").each(function(){var d=new xu({la:["autoload","dataPagingSource"]});d.la("childConstructor",{factory:b});var e=$(this).data("navigable");e&&d.la("shortcut",e);c.H(d);d.o(this);pu(d,function(b){qC($("[data-highlight]",b),c.jz)})})};a.vC=function(){};vC.prototype.z=function(){var b=J("zh-invited-member-list");b&&(new $x(b,"/invitation/more","people",["zg-btn-follow","zg-btn-unfollow"],j)).z();(b=J("zh-invited-sina-member-list"))&&(new $x(b,k,"people",["zg-btn-follow","zg-btn-unfollow"],j)).z();J("zh-sina-invite")&&(new Zx).z();new Zl(J("invite_friend"))};a.wC=function(b,c){var d=this.F={};H.extend(d,this.defaults,c||{});this.input=b;this.Sb=d.Sb;this.$g=this.NQ();this.Ru=[];this.Ru.push({action:"remove",method:this.removeTag,lv:d.oR,Q:"删除"});setTimeout(v(this.kg,this))};y(wC,Gd);
ya(wC.prototype,{defaults:{source:"/topic/autocomplete",Sb:k,VK:"",Vu:m,sT:"/topic/%s",template:'<li data-id="<%=id%>"><a class="tag-link" href="<%=url%>"><%=name%></a></li>',parse:function(b){var c=$(b);return{Zs:j,id:c.data("id"),url:b.href,name:c.text()}},kS:nf,kL:"canedit",Dv:"empty",Om:"button",oR:"remove-button"},OS:function(b){return su(this.F.sT,b.url_token)},has:function(b){return!!z.find(this.$g,function(c){return c.name===b.name||c.id===b.id})},TC:function(b){return z.find(this.$g,function(c){return c.name===
b})},QW:function(b){return z.find(this.$g,function(c){return c.id===b})},Sh:function(){var b=!!oc(this.Sb).length;E.enable(this.Sb,this.F.Dv,!b);this.dispatchEvent("change")},add:function(b,c){if(b&&(this.has(b)||this.$g.push(b),b.Zs=m,c||this.F.kS.call(this,b)))this.wR(b),b.Zs=j,this.dispatchEvent("add"),this.Sh()},remove:function(b){this.$g=z.filter(this.$g,function(c){return b!==c.id},this);this.dispatchEvent("remove");this.Sh()},SL:function(){return z.filter(this.$g,function(b){return b.Zs!==
m})},RL:function(){return z.map(this.SL(),function(b){return b.id})},wR:function(b){b=fc(this.IG(b));this.Sb.appendChild(b);this.ze(b)},IG:function(b){return Qk(this.F.template,b)},W:function(){this.Sb.innerHTML=z.map(this.$g,this.IG,this).join("")},NQ:function(){return z.map(this.rD(),this.F.parse)},rD:function(){return oc(this.Sb)},kg:function(){var b=this,c=b.F,d=this.input,e={source:c.source,Rj:Hc(b.input,function(b){return"static"!==$.css(b,"position")}),placeholder:this.input.getAttribute("placeholder"),
select:function(d){b.add({id:d.id,name:d.id?d.label:b.input.value,url:b.OS(d),avatar:d.avatar,url_token:d.url_token});return c.VK},filter:function(d){return z.filter(d,function(d){return c.Vu&&!d.id?m:!z.find(b.$g,function(b){return b.Zs&&b.id===d.id})})}},g={Tc:function(b,c,d){d.innerHTML=l(b.data)}};H.extend(g,e||{});var h=new Lp(d,g);O(h,"show",function(){1<h.cb.length&&!h.cb[0].id&&wm(h)});var l=Qk('<% if (data.avatar) { %><img class="zm-item-img-avatar zg-left" src="<%=avatar%>"><% } %><% if(data.type === "search_link" || !data.id){ %><span class="zu-autocomplete-row-name zu-autocomplete-row-name-info"><%=data.type === "search_link"?("添加 "+label+" 话题"):label%></span><% } else { %><span class="zu-autocomplete-row-name"><%=label%></span><% } %><span class="zg-gray-normal zu-autocomplete-row-description"><% if (data.alias && data.followers) { %><% if ( data.alias ) { %>又称 <%=alias%><% } %><% if ( data.alias && data.followers ){ %>，<% } %><% if ( data.followers ){ %><%=followers%> 人关注<% } %><% }else{ %>&nbsp;<% } %></span>');
this.Y=h;z.forEach(this.rD(),this.ze,this);O(this.input,"keypress",function(d){var e;if(13===d.keyCode&&!c.Vu&&(e=Ma(this.value))&&!b.Y.nb())b.add(b.TC(e)||{id:k,name:e,url:"/topic/"+e})});this.Sh()},removeTag:function(b){this.remove($(b).remove().data("id"))},QQ:function(b,c){var d=z.find(this.Ru,function(c){return c.action===b});d&&d.method&&d.method.call(this,c);this.input.focus()},ze:function(b){var c=this.F;E.add(b,c.kL);z.forEach(this.Ru,function(d){var e=new pp(" ",yp.O());e.ih([c.Om,d.lv].join(" "));
e.W(b);e.Xa(j);e.Kc(d.Q);e.addEventListener("action",function(){this.QQ(d.action,b)},m,this)},this)}});a.xC=function(){this.zA=this.AA=k};
xC.prototype.z=function(){function b(b,c){var g=L("li"),h=L("span","item-label",b);g.appendChild(h);var l=new pp("",yp.O());l.ih("zm-profile-tag-btn zm-profile-tag-btn-del");l.Xa(j);l.Kc("移除动作");l.za(c);l.addEventListener("action",function(){var b=l.V();e(b,m);M(g);W.Ws(j);d()});l.W(g);Ja.appendChild(g)}function c(){ja.D(W.ll()!==z.filter(W.Hb(),function(b){return!!(b.$&8)}).length)}function d(){z.forEach(Q,function(b){b.selected||(b=new Ny(b.text,b.value),W.Fa(b))});c()}function e(b,c){var d=z.find(Q,
function(c){return c.value===b});d&&(d.selected=c)}function g(){var b=$.grep(n.get(0).options,function(b){return b.selected});$.map(b,function(b){return b.value})}function h(){q=I.RL();G.val(q.join(","))}var l=$("#rq-settings-ui"),n=$("select.select",l);$(".topics-num",l);$(".actions-num",l);var q=[];this.zA=$("#rq-info-block");l.on("click",".beginedit-button",function(b){b.preventDefault();l.addClass("expanded-view")}).on("click",".exitedit-button",function(b){b.preventDefault();l.removeClass("expanded-view")}).on("click",
".endedit-button",function(b){b.preventDefault();l.get(0).submit()});var r=$(".topic-editor",l),w=$("input.topic-input",r).get(0),F=$("ul.tag-list",r).get(0),I=new wC(w,{Vu:j,Sb:F}),G=$('input[name="topics"]',r);I.on("change",h);n.on("change",g);h();g();r=n.get(0);R(r,m);var Q=r.options,W=new Nu;W.on("action",function(d){d=d.target;b(d.wg(),d.V());e(d.V(),j);W.removeItem(d);c()});var ja=new pz("添加动作",W);ja.ih("menu-button");ja.W(r.parentNode);ja.Xl=j;sz(ja);var Ja=L("ul","display-list");d();z.forEach(Q,
function(c){c.selected&&b(c.text,c.value)});r.parentNode.insertBefore(Ja,ja.m());var Na=this,r=$("#rq3-item-list"),Ra={SS:function(b){return $.post("/watch/thank",{id:b,rq_type:"thank"})},dR:function(b){return $.post("/watch/seen",{id:b,rq_type:"seen"})}};r.on("click",".read-button",function(){var b=$(this).closest(".rq-item"),c=b.data("id");Ra.dR(c);c=me.text()||0;0<c&&me.text(c-1);var d=Na.zA,e=Number(Na.AA.text());setTimeout(function(){d.toggleClass("hidden",!!e)},210);b.slideUp(function(){b.remove()})}).on("click",
".thank-button",function(b){b.preventDefault();var b=$(this),c=b.closest(".rq-item").data("id");b.hasClass("thanked")||(Ra.SS(c),b.addClass("thanked").text("已感谢"))});Mx(r);r=new Ou(r.get(0),location.href,j);r.lG=function(b){return b.getAttribute("data-id")};r.di("rq-item");r.z();var r=$("#rq3-sidenav-link"),me=$(".zg-num",r);this.AA=me};a.yC=function(){};yC.prototype.z=function(){$("a.js-obfuscate-email").each(function(){var b=$(this),c=b.data("email").split("").reverse().join("");b.attr("href","mailto:"+c).text(c)})};a.zC=function(){};y(zC,T);zC.prototype.z=function(){ys.H(this);this.o(document.body)};zC.prototype.B=function(){zC.n.B.call(this);var b=$("#zh-following-question-item-list").children(".zh-general-list");if(b.length){var c=new xu;this.H(c);c.la("nodeSource");c.o(b.get(0))}};a.AC=function(){T.call(this)};y(AC,T);AC.prototype.B=function(){this.h().e(this.g,"click",this.mo)};AC.prototype.mo=function(b){var c=b.target;c&&"rmdraft"===c.name&&Ci("删除草稿","你确定要删除这个草稿吗？",function(b){b&&(Fi("/draft/delete",k,"POST","qid="+c.id.split("-")[1]),M(this.g))},this)};a.BC=function(){};y(BC,T);BC.prototype.z=function(){var b=J("zh-draft-page-wrap");b&&this.o(b)};
BC.prototype.B=function(){O(J("zh-clear-all-draft"),"click",function(){Ci("删除所有草稿","你确定要删除所有草稿吗？删除后将无法恢复",function(b){b&&Fi("/draft/clear",function(){window.location.href="/draft"},"POST")});return m});this.En()};BC.prototype.En=function(){var b=J("zh-draft-item-list");if(b){var c=new xu;c.la("locationSource",{Hs:j}).la("childConstructor",{Ji:AC});c.o(b)}};a.CC=function(){this.Ng="explore";this.tL="explore_feed"};y(CC,T);CC.prototype.z=function(){ys.H(this);this.o(document.body)};
CC.prototype.B=function(){CC.n.B.call(this);var b=this,c=$("#js-explore-tab");if(c.length){var d=$(".tab-panel",c),e=$(".tab-nav",c),g=k;e.children().click(function(){g=$b(document)});c=function(){var c={"daily-hot":0,"monthly-hot":1}[window.location.hash.slice(1)]||0;e.removeClass("active").eq(c).addClass("active");c=d.hide().eq(c).show().children("[data-type]");if(!c.data("inited")){c.data("inited",j);var h={daily:jy,monthly:ly}[c.data("type")],h=new DC(h);h.la("expandLimit");b.H(h);h.o(c[0])}g&&
window.scrollTo(g.x,g.y)};this.h().e(window,"hashchange",c);c()}this.jx();if(c=$("#zh-recommend-list-full>.zh-general-list")[0]){var h=new xu;h.la("nodeSource");pu(h,function(b){var c=dx(b);c&&(h.H(c),c.o(b))});this.H(h);h.o(c)}this.h().e(this,"click!",function(b){"comment"===b.namespace&&b.xc.fill("category",this.Ng).fill("label",this.tL)})};CC.prototype.jx=function(){var b=1,c=$("ul.hot-favlists"),d=k;$("#js-hot-fav-switch").click(function(){d&&"pending"===d.state()||(b=5<=b?1:b+1,d=ky(b).done(function(b){c.html(b)}))})};
a.DC=function(b){ou.call(this,{source:function(){return b($(this.Hb()).last().data("offset")).then(function(b){return{results:b}})},la:["autoload"]})};y(DC,xu);DC.prototype.B=function(){DC.n.B.call(this);this.la("childConstructor",{Ji:Yw})};a.EC=function(){T.call(this)};y(EC,T);EC.prototype.z=function(){ys.H(this);this.o(document.body)};EC.prototype.B=function(){EC.n.B.call(this);this.En()};EC.prototype.En=function(){var b=J("js-suggest-people");if(b){var c=0,d=new xu({source:function(){return $.get("",{start:c+20,limit:20}).then(function(b){if(!b.r)return b=b.msg,b.hasmore&&(c+=20),{results:b.htmls,next:Boolean(b.hasmore)}})}});this.H(d);d.o(b)}};a.FC=function(b){function c(b,c){var d;d=d||"slug";return{source:b,filter:function(b){return b.filter(function(b){return c.every(function(c){return c[d]!==b[d]})})},select:function(b){c.push(b);return""}}}this.ft=b;b.activityUrl="";var b=this.ft,d=b.roundtable;b.topicsSuggestOpitons=c("/r/ac/topics",d.topics);b.organizationsSuggestOpitons=c("/r/ac/topics",d.organizations);b.presentersSuggestOpitons=c("/r/ac/users",d.presenters);b.guestsSuggestOpitons=c("/r/ac/users",d.guests)};FC.$inject=["$scope"];
FC.prototype.removeTag=function(b,c){b.splice((0,z.indexOf)(b,c),1)};FC.prototype.moveupTag=function(b,c){var d=(0,z.indexOf)(b,c);0<d&&(b.splice(d,1),b.splice(d-1,0,c))};FC.prototype.onActvityUrlChange=function(){var b=this.ft,c=b.activityUrl,d=b.roundtable.activityUrls;c&&-1===(0,z.indexOf)(d,c)&&(d.push(c),b.activityUrl="")};
FC.prototype.submit=function(b,c){var d="create"===c,e={roundtable:JSON.stringify(b)};if(d&&3>b.activityUrls.length)return U("请至少添加三条动态");$.post(location.pathname+location.search,e).then(function(d){d.success?"create"===c?(U(d.message||"活动创建成功，请等待审核"),setTimeout(function(){location.href="/roundtable"},3E3)):(U(d.message||"活动修改成功"),setTimeout(function(){location.href="/roundtable/"+b.slug},3E3)):U(d.message||"提交失败")})};a.GC=function(b,c){var d={Ae:5,className:"ui-suggest",$h:"row",PC:200};H.extend(d,c||{});var e=d.W;e&&(d.Tc=ha,d.W=function(b,c){e.apply(this,arguments)!==m&&(b.Xf=Vb(b.$h,c))});Lp.call(this,b,d);var g=this.M;g.className=d.className;g.$h=d.$h;g.$n=d.PC};y(GC,Lp);a.HC=function(b,c){return function(d,e,g){$(e).datetimepicker({autoclose:j,forceParse:m,format:"yyyy 年 m 月 d 日 hh:ii",startDate:new Date,language:"zh-CN"});c(function(){$(e).datetimepicker("update",new Date(b(g.ngModel)(d)))})}};HC.$inject=["$parse","$timeout"];
a.IC=function(){return{scope:{id:"@id",avatar:"=avatar"},link:function(b,c){var d=new Vl(4,b.id,"xl");d.o(c);d.addEventListener("success",function(){b.$apply(function(){b.avatar.id=d.getData().id})})}}},a.JC=function(b){return{scope:{options:"=suggestOptions"},link:function(c,d,e){var g,h,e={LR:'<div class="row"><img class="avatar" src="[[avatar | avatarUrl]]"><span class="name">[[name]]</span></div>',PC:100,source:e.source,Rj:d.parent()[0],W:function(b,c,d){c.innerHTML=d.map(function(b){return h(b.data)}).join("")}};
h=b(e.LR);angular.extend(e,c.options);if(e.select){var l=e.select;e.select=function(b){return c.$apply(function(){return l(b)})}}g=new GC(d[0],e);return c.$on("destroy",function(){return g.G()})}}};JC.$inject=["$interpolate"];a.KC=function(){return function(b,c){return"string"===typeof b?b:b.template.replace("{id}",b.id).replace("{size}",c||"xs")}},a.LC=function(b){b.startSymbol("[[").endSymbol("]]")};LC.$inject=["$interpolateProvider"];a.MC=function(){sC.call(this);this.Do=sh.roundtable};y(MC,sC);
MC.prototype.z=function(){ys.H(this);this.o(document.body);var b=$(".add-pending-activities-form");if(b.length){var c=$(".url",b),d=$(".time",b);d.datetimepicker({autoclose:j,forceParse:m,format:"yyyy 年 m 月 d 日 hh:ii",startDate:new Date,language:"zh-CN"}).datetimepicker("update",new Date);var e=this.Do;b.submit(function(b){function g(b){b.success?(U("添加成功"),setTimeout(function(){location.reload()},3E3)):U(b.message||"提交失败")}b.preventDefault();if(!c.val())return U("回答或问题地址必须填写");if(!d.val())return U("发布时间必须填写");
var b=(b=c.val().match(/\/question\/\d+\/answer\/(\d+)/))&&b[1],h=c.val().match(/\/question\/(\d+)/),h=h&&h[1];b?$.post("/roundtable/"+e.slug,{action:"add_pending_activity",publish_time:d.val(),type:"answer",url_token:b},g):h?$.post("/roundtable/"+e.slug,{action:"add_pending_activity",publish_time:d.val(),type:"question",url_token:h},g):U("回答或问题地址不正确")})}var g=this.Do;$(".feeds.pending-questions").on("click",".add",function(){var b=$(this).data("token"),c=$(this).closest(".item");$.post("/roundtable/"+
g.slug,{action:"approve_question",url_token:b}).then(function(b){b.success?c.fadeOut(function(){c.remove()}):U(b.message||"提交失败")})}).on("click",".remove",function(){var b=$(this).data("token"),c=$(this).closest(".item");$.post("/roundtable/"+g.slug,{action:"ignore_question",url_token:b}).then(function(b){b.success?c.fadeOut(function(){c.remove()}):U(b.message||"提交失败")})});var h=this.Do;$(".feeds.pending-activities").on("click",".remove",function(){var b=$(this).data(),c=$(this).closest(".item");
$.post("/roundtable/"+h.slug,{action:"remove_pending_activity",type:b.type,url_token:b.token}).then(function(b){b.success?c.fadeOut(function(){c.remove()}):U(b.message||"提交失败")})});tC();this.Qr()};Ca("ZH.entryQuestionLog",function(){(new nC).z()});Ca("ZH.entryQuestionFollowersPage",function(){(new pC).z()});Ca("ZH.entrySQ",function(){(new XB).z()});Ca("ZH.entrySA",function(){(new fC).z()});Ca("ZH.entryL",function(){(new ny).z()});Ca("ZH.entryT",function(){(new fy).z()});Ca("ZH.entryTS",function(){(new mC).z()});Ca("ZH.entryP",function(){(new Nx).z()});Ca("ZH.entrySearch",function(){(new uC).z()});Ca("ZH.entryPM",function(){(new Bu).z()});Ca("ZH.entryPMDetail",function(){(new Cu).z()});
Ca("ZH.entryHelp",function(){(new ku).z()});Ca("ZH.entryInvite",function(){(new vC).z()});Ca("ZH.entryTest",ba());Ca("ZH.entrySettings",function(){(new Vx).z()});Ca("ZH.entryTopicFeed",function(){(new hC).z()});Ca("ZH.entryTest",function(){(new St.XV).z()});Ca("ZH.entryRQ3",function(){(new xC).z()});Ca("ZH.entryTerms",function(){(new yC).z()});Ca("ZH.entryHome",function(){(new Ly).z()});Ca("ZH.entryQuestionFollowing",function(){(new zC).z()});Ca("ZH.entryDraft",function(){(new BC).z()});
Ca("ZH.entryExplore",function(){(new CC).z()});Ca("ZH.entryLookup",function(){(new EC).z()});Ca("ZH.entryCC",function(){$(function(){$("#js-apply-button").click(sn(function(){$.post("/classical-chinese");var b=$(this),c=b.data("num");b.text("您已申請使用").addClass("disabled");$(".apply-num").text("已有 "+(c+1)+" 人申請")}))})});Ca("ZH.entryRb",function(){(new sC).z()});
Ca("ZH.entryRbEdit",function(){var b=angular.module("roundtableApp",[]);b.controller("RoundtableFormCtrl",FC);b.directive("uiAvatarEditor",IC);b.directive("uiSuggest",JC);b.directive("uiTimepicker",HC);b.filter("avatarUrl",KC);b.config(LC);angular.bootstrap(document.body,["roundtableApp"])});Ca("ZH.entryRbPending",function(){(new MC).z()});Jf("app");}})(zhihu);
//@ sourceURL=http://static.zhihu.com/static/compiled/app.js